CREATE TABLE CCHRISTINE.CIRCULAR_DATE_RANGE
(
	DATE_RANGE CHARACTER VARYING(30) NOT NULL,
	START_DT DATE NOT NULL,
	END_DT DATE NOT NULL
)
DISTRIBUTE ON RANDOM;


CREATE TABLE CCHRISTINE.CIRCULAR_SKU
(
	EVENT_NM CHARACTER VARYING(60) NOT NULL,
	SKU_NBR INTEGER NOT NULL,
	START_DT DATE NOT NULL,
	END_DT DATE NOT NULL
)
DISTRIBUTE ON (SKU_NBR);


CREATE TABLE CCHRISTINE.CIRCULAR_SKU_2013_LABOR_DAY
(
	SKU_NBR INTEGER NOT NULL
)
DISTRIBUTE ON RANDOM;


CREATE TABLE CCHRISTINE.CIRCULAR_SKU_DAY
(
	DAY_DT TIMESTAMP,
	SKU_NBR INTEGER,
	PRODUCT_ID INTEGER,
	EVENT_NM CHARACTER VARYING(60)
)
DISTRIBUTE ON (PRODUCT_ID)
ORGANIZE ON (DAY_DT);


CREATE TABLE CCHRISTINE.CIRCULAR_SKU_DISCOUNT_20150129
(
	SKU_NBR INTEGER,
	EVENT_NM CHARACTER VARYING(60),
	CUST_TYPE CHARACTER VARYING(11),
	CUST_CNT BIGINT,
	TXN_CNT BIGINT,
	DISC_AMT NUMERIC(31,2)
)
DISTRIBUTE ON (SKU_NBR, EVENT_NM, CUST_TYPE);


CREATE TABLE CCHRISTINE.DRY_DOG_SUB_BRAND
(
	BRAND_NAME CHARACTER VARYING(30),
	SUB_BRAND_NAME CHARACTER VARYING(22),
	PRODUCT_ID INTEGER NOT NULL,
	SKU_NBR INTEGER
)
DISTRIBUTE ON (PRODUCT_ID);


CREATE TABLE CCHRISTINE.MSTR_TEST
(
	STORE_NBR INTEGER
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_ANALYSIS
(
	CA_ANALYSIS_ID INTEGER NOT NULL,
	CA_ANALYSIS_DESC CHARACTER VARYING(50),
	CA_ANALYSIS_LONG_DESC CHARACTER VARYING(250),
	CA_ANALYSIS_STATUS_ID BYTEINT,
	REFRESH_IND BYTEINT,
	REFRESH_CD CHARACTER VARYING(10),
	DEACTIVATE_CD CHARACTER VARYING(10),
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP,
	UPDATE_USER_ID CHARACTER VARYING(50),
	UPDATE_TSTMP TIMESTAMP,
	RETIRE_IND BYTEINT,
	RETIRE_USER_ID CHARACTER VARYING(50),
	RETIRE_TSTMP TIMESTAMP,
	INCLUDE_LY_IND BYTEINT,
	CA_ANALYSIS_TYPE_ID BYTEINT
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS
ADD CONSTRAINT CA_ANALYSIS_NEW_PK1
PRIMARY KEY (CA_ANALYSIS_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA
(
	CA_ANALYSIS_INSTANCE_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CUST_TYPE_COMPANY BYTEINT NOT NULL,
	CUST_TYPE_VP BYTEINT NOT NULL,
	CUST_TYPE_DIVISION BYTEINT NOT NULL,
	CUST_TYPE_DEPT BYTEINT NOT NULL,
	CUST_TYPE_CLASS BYTEINT NOT NULL,
	CUST_TYPE_CATEGORY BYTEINT NOT NULL,
	CUST_TYPE_LEVEL BYTEINT NOT NULL,
	ONE_TRIP_IND_LEVEL BYTEINT NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	CUSTOMER_SUB_SEGMENT_CD CHARACTER VARYING(5) NOT NULL,
	LOYALTY_MEMBER_ID BYTEINT NOT NULL,
	TXNS NUMERIC(12,2),
	NET_SALES_AMT NUMERIC(15,3),
	NET_SALES_QTY NUMERIC(12,2),
	NET_MARGIN_AMT NUMERIC(15,3),
	CUST_CNT NUMERIC(12,2),
	COMP_TXNS NUMERIC(12,2),
	COMP_NET_SALES_AMT NUMERIC(15,3),
	COMP_NET_SALES_QTY NUMERIC(12,2),
	COMP_NET_MARGIN_AMT NUMERIC(15,3),
	COMP_CUST_CNT NUMERIC(12,2),
	SEG_TOTAL_SALES_AMT NUMERIC(15,3),
	SEG_TOTAL_MARGIN_AMT NUMERIC(15,3),
	SEG_TOTAL_TXN_CNT INTEGER,
	CAV_MARGIN_AMT_NEXT_PERIOD NUMERIC(15,3),
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM
ORGANIZE ON (CA_ANALYSIS_INSTANCE_ID);

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA
ADD CONSTRAINT CA_ANALYSIS_DATA_PK
PRIMARY KEY (CA_ANALYSIS_INSTANCE_ID, CA_PRODUCT_GROUP_ID, CA_STORE_GROUP_ID, CA_DATE_GROUP_ID, TY_LY_FLAG, CA_CUST_GROUP_COHORT_ID, CA_TXN_GROUP_COHORT_ID, CUST_TYPE_COMPANY, CUST_TYPE_VP, CUST_TYPE_DIVISION, CUST_TYPE_DEPT, CUST_TYPE_CLASS, CUST_TYPE_CATEGORY, CUST_TYPE_LEVEL, ONE_TRIP_IND_LEVEL, CURRENCY_TYPE_ID, CUSTOMER_SUB_SEGMENT_CD, LOYALTY_MEMBER_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_CS
(
	CA_ANALYSIS_INSTANCE_ID INTEGER NOT NULL,
	CA_ANALYSIS_TECHNIQUE_ID BYTEINT,
	BASE_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CS_CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	CS_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	BASE_IND BYTEINT NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	CA_CUST_TYPE_GROUP_ID BYTEINT NOT NULL,
	BASE_CUST_CNT INTEGER,
	BASE_TXNS INTEGER,
	CS_RANK INTEGER,
	CS_CUST_CNT INTEGER,
	CS_TXNS INTEGER,
	CS_NET_SALES_AMT NUMERIC(15,3),
	CS_NET_SALES_QTY INTEGER,
	CS_NET_MARGIN_AMT NUMERIC(15,3),
	VP_CS_NET_SALES_AMT NUMERIC(15,3),
	VP_CS_NET_SALES_QTY INTEGER,
	AFFINITY_CUST_CNT INTEGER,
	AFFINITY_BASE_CUST_CNT INTEGER,
	CHERRY_PICK_CUST_CNT INTEGER,
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM
ORGANIZE ON (CA_ANALYSIS_INSTANCE_ID);

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_CS
ADD CONSTRAINT CA_ANALYSIS_DATA_CS_PK
PRIMARY KEY (CA_ANALYSIS_INSTANCE_ID, BASE_CA_PRODUCT_GROUP_ID, CS_CA_PRODUCT_GROUP_TYPE_ID, CS_CA_PRODUCT_GROUP_ID, BASE_IND, CA_STORE_GROUP_ID, CA_DATE_GROUP_ID, TY_LY_FLAG, CA_CUST_GROUP_COHORT_ID, CA_TXN_GROUP_COHORT_ID, CURRENCY_TYPE_ID, CA_CUST_TYPE_GROUP_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_MB
(
	CA_ANALYSIS_INSTANCE_ID INTEGER NOT NULL,
	BASE_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	ATTACH_CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	ATTACH_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	BASE_IND BYTEINT NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	CA_TXN_CUST_TYPE_ID BYTEINT NOT NULL,
	BASE_TXNS INTEGER,
	ATTACH_RANK INTEGER,
	ATTACH_TXNS INTEGER,
	ATTACH_NET_SALES_AMT NUMERIC(15,3),
	ATTACH_NET_SALES_QTY INTEGER,
	ATTACH_NET_MARGIN_AMT NUMERIC(15,3),
	VP_ATTACH_NET_SALES_AMT NUMERIC(15,3),
	VP_ATTACH_NET_SALES_QTY INTEGER,
	AFFINITY_TXNS INTEGER,
	AFFINITY_BASE_TXNS INTEGER,
	CHERRY_PICK_TXNS INTEGER,
	NEW_PETM_TXNS INTEGER,
	NEW_LEVEL_TXNS INTEGER,
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM
ORGANIZE ON (CA_ANALYSIS_INSTANCE_ID);

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_MB
ADD CONSTRAINT CA_ANALYSIS_DATA_MB_PK
PRIMARY KEY (CA_ANALYSIS_INSTANCE_ID, BASE_CA_PRODUCT_GROUP_ID, ATTACH_CA_PRODUCT_GROUP_TYPE_ID, ATTACH_CA_PRODUCT_GROUP_ID, BASE_IND, CA_STORE_GROUP_ID, CA_DATE_GROUP_ID, TY_LY_FLAG, CA_CUST_GROUP_COHORT_ID, CA_TXN_GROUP_COHORT_ID, CURRENCY_TYPE_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_MB_SB_PB
(
	CA_ANALYSIS_INSTANCE_ID INTEGER NOT NULL,
	BASE_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	ATTACH_CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	ATTACH_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	BASE_IND BYTEINT NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	CA_TXN_CUST_TYPE_ID BYTEINT NOT NULL,
	CA_SUBSQNT_PREV_BASKET_ID INTEGER NOT NULL,
	CA_SUBSQNT_PREV_BASKET_TYPE_ID INTEGER NOT NULL,
	ATTACH_RANK INTEGER,
	BASE_CUST_CNT INTEGER,
	ATTACH_CUST_CNT INTEGER,
	ATTACH_TXNS INTEGER,
	ATTACH_NET_SALES_AMT NUMERIC(15,3),
	ATTACH_NET_SALES_QTY INTEGER,
	ATTACH_NET_MARGIN_AMT NUMERIC(15,3),
	VP_ATTACH_NET_SALES_AMT NUMERIC(15,3),
	VP_ATTACH_NET_SALES_QTY INTEGER,
	NBR_DAYS SMALLINT,
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM
ORGANIZE ON (CA_ANALYSIS_INSTANCE_ID);


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_NLR
(
	CA_ANALYSIS_INSTANCE_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	LY_CUST_CNT INTEGER NOT NULL,
	TY_CUST_CNT INTEGER NOT NULL,
	PETM_LOST INTEGER NOT NULL,
	PRODUCT_LOST INTEGER NOT NULL,
	CHANNEL_LOST INTEGER NOT NULL,
	CHANNEL_NEW INTEGER NOT NULL,
	PRODUCT_NEW INTEGER NOT NULL,
	PETM_NEW INTEGER NOT NULL,
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_NLR
ADD CONSTRAINT CA_ANALYSIS_DATA_NLR_PK
PRIMARY KEY (CA_ANALYSIS_INSTANCE_ID, CA_PRODUCT_GROUP_ID, CA_STORE_GROUP_ID, CURRENCY_TYPE_ID, CA_DATE_GROUP_ID, CA_CUST_GROUP_COHORT_ID, CA_TXN_GROUP_COHORT_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_CGC
(
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CUSTOMER_GID NUMERIC(19,0),
	JOIN_TYPE CHARACTER VARYING(100)
)
DISTRIBUTE ON (CUSTOMER_GID);


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_CGC_DG_SEG
(
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	EXEC_SEQ INTEGER NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CUSTOMER_GID NUMERIC(19,0) NOT NULL,
	CUSTOMER_SUB_SEGMENT_CD CHARACTER VARYING(5) NOT NULL,
	LOYALTY_MEMBER_ID BYTEINT NOT NULL,
	SEG_TOTAL_SALES_AMT NUMERIC(15,3),
	SEG_TOTAL_MARGIN_AMT NUMERIC(15,3),
	SEG_TOTAL_TXN_CNT INTEGER,
	CAV_MARGIN_AMT_NEXT_PERIOD NUMERIC(15,3)
)
DISTRIBUTE ON (CUSTOMER_GID);

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_CGC_DG_SEG
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_CGC_DG_SEG_PK
PRIMARY KEY (CA_DATE_GROUP_ID, TY_LY_FLAG, CA_CUST_GROUP_COHORT_ID, CUSTOMER_GID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_CS_AFFINITY
(
	CS_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CUST_CNT INTEGER NOT NULL
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_CS_CHERRY_PICK
(
	CUSTOMER_GID NUMERIC(19,0) NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	TXNS INTEGER NOT NULL
)
DISTRIBUTE ON (CUSTOMER_GID);


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_CS_DG_CG_TG_SG
(
	BASE_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CS_CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	BASE_IND BYTEINT NOT NULL,
	CS_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER,
	TY_LY_FLAG CHARACTER VARYING(2),
	CA_CUST_GROUP_COHORT_ID INTEGER,
	CA_TXN_GROUP_COHORT_ID INTEGER,
	CA_STORE_GROUP_ID INTEGER,
	CURRENCY_TYPE_ID BYTEINT,
	CA_CUST_TYPE_GROUP_COMPANY_ID BYTEINT,
	CA_CUST_TYPE_GROUP_LEVEL_ID BYTEINT,
	CHERRY_PICK_CUST_CNT INTEGER,
	SAME_VP_IND BYTEINT,
	CUST_CNT INTEGER,
	TXNS INTEGER,
	NET_SALES_AMT NUMERIC(15,3),
	NET_SALES_QTY INTEGER,
	NET_MARGIN_AMT NUMERIC(15,3),
	NBR_ELEMENTS INTEGER
)
DISTRIBUTE ON (BASE_CA_PRODUCT_GROUP_ID, CS_CA_PRODUCT_GROUP_TYPE_ID, CS_CA_PRODUCT_GROUP_ID);


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_CS_DG_CG_TG_SG_PRE
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CUSTOMER_GID NUMERIC(19,0) NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	CUST_TYPE_COMPANY BYTEINT,
	CUST_TYPE BYTEINT,
	TXNS INTEGER,
	NET_SALES_AMT NUMERIC(15,3),
	NET_SALES_QTY INTEGER,
	NET_MARGIN_AMT NUMERIC(15,3),
	CHERRY_PICK_TXNS INTEGER,
	CHERRY_PICK_CUST_CNT INTEGER,
	BASE_IND BYTEINT,
	TG_SG_IND BYTEINT
)
DISTRIBUTE ON (CUSTOMER_GID);


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_CS_RANK
(
	CA_ANALYSIS_TECHNIQUE_ID BYTEINT NOT NULL,
	BASE_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CS_CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	BASE_IND BYTEINT NOT NULL,
	CS_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	CA_CUST_TYPE_GROUP_ID BYTEINT NOT NULL,
	CS_RANK BIGINT NOT NULL,
	CHERRY_PICK_CUST_CNT INTEGER,
	CUST_CNT INTEGER,
	TXNS INTEGER,
	NET_SALES_AMT NUMERIC(15,3),
	NET_SALES_QTY INTEGER,
	NET_MARGIN_AMT NUMERIC(15,3),
	VP_NET_SALES_AMT NUMERIC(15,3),
	VP_NET_SALES_QTY INTEGER
)
DISTRIBUTE ON (BASE_CA_PRODUCT_GROUP_ID, CS_CA_PRODUCT_GROUP_TYPE_ID, CS_CA_PRODUCT_GROUP_ID);


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_CS_RANK_PRE
(
	CA_ANALYSIS_TECHNIQUE_ID BYTEINT NOT NULL,
	BASE_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CS_CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	BASE_IND BYTEINT NOT NULL,
	CS_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	CA_CUST_TYPE_GROUP_ID BYTEINT NOT NULL,
	CHERRY_PICK_CUST_CNT INTEGER NOT NULL,
	SAME_VP_IND BYTEINT NOT NULL,
	CUST_CNT INTEGER,
	TXNS INTEGER,
	NET_SALES_AMT NUMERIC(15,3),
	NET_SALES_QTY INTEGER,
	NET_MARGIN_AMT NUMERIC(15,3),
	NBR_ELEMENTS INTEGER
)
DISTRIBUTE ON (BASE_CA_PRODUCT_GROUP_ID, CS_CA_PRODUCT_GROUP_TYPE_ID, CS_CA_PRODUCT_GROUP_ID);


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_CUST_DAY_PG
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	DAY_DT DATE NOT NULL,
	CUSTOMER_GID NUMERIC(19,0) NOT NULL
)
DISTRIBUTE ON (CUSTOMER_GID)
ORGANIZE ON (DAY_DT);

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_CUST_DAY_PG
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_CUST_DAY_PG_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID, DAY_DT, CUSTOMER_GID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_DG
(
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	EXEC_SEQ INTEGER,
	FMAW_DG_ID INTEGER,
	FMAW_WK_CNT NUMERIC(8,4),
	PLNRAW_DG_ID INTEGER,
	PLNRAW_WK_CNT NUMERIC(8,4),
	AGGREGATE_IND BYTEINT,
	TO_STATIC_IND BYTEINT
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_DG
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_DG_PK
PRIMARY KEY (CA_DATE_GROUP_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_DG_AW
(
	CA_ANALYSIS_INSTANCE_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	FMAW_DG_ID INTEGER,
	FMAW_WK_CNT NUMERIC(8,4),
	PLNRAW_DG_ID INTEGER,
	PLNRAW_WK_CNT NUMERIC(8,4)
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_DG_AW
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_DG_AW_PK
PRIMARY KEY (CA_ANALYSIS_INSTANCE_ID, CA_DATE_GROUP_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_DG_DAY
(
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	DAY_DT TIMESTAMP NOT NULL,
	WEEK_DT TIMESTAMP,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	TRANS_DAY_DT TIMESTAMP NOT NULL,
	COMP_IND BYTEINT,
	EXEC_SEQ INTEGER
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_DG_DAY
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_DG_DAY_PK
PRIMARY KEY (CA_DATE_GROUP_ID, DAY_DT, TY_LY_FLAG);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_DG_XREF
(
	FINAL_CA_DATE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	EXEC_SEQ INTEGER NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_DG_XREF
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_DG_XREF_PK
PRIMARY KEY (FINAL_CA_DATE_GROUP_ID, CA_DATE_GROUP_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_MB_AFFINITY
(
	ATTACH_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	TXNS INTEGER NOT NULL
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_MB_AFFINITY_STATIC
(
	CA_ANALYSIS_ID INTEGER NOT NULL,
	ATTACH_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	TXNS INTEGER NOT NULL,
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_MB_RANK
(
	BASE_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	ATTACH_CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	BASE_IND BYTEINT NOT NULL,
	ATTACH_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID INTEGER NOT NULL,
	CA_TXN_CUST_TYPE_ID BYTEINT NOT NULL,
	ATTACH_RANK INTEGER NOT NULL,
	CHERRY_PICK_TXNS INTEGER NOT NULL,
	TXNS INTEGER NOT NULL,
	NET_SALES_AMT NUMERIC(15,3) NOT NULL,
	NET_SALES_QTY INTEGER NOT NULL,
	NET_MARGIN_AMT NUMERIC(15,3) NOT NULL,
	VP_NET_SALES_AMT NUMERIC(15,3) NOT NULL,
	VP_NET_SALES_QTY INTEGER NOT NULL,
	NEW_PETM_TXNS INTEGER NOT NULL,
	NEW_LEVEL_TXNS INTEGER NOT NULL
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_MB_RANK_PRE
(
	BASE_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	ATTACH_CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	BASE_IND BYTEINT NOT NULL,
	ATTACH_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	CA_TXN_CUST_TYPE_ID INTEGER,
	CHERRY_PICK_TXNS INTEGER,
	SAME_VP_IND BYTEINT,
	TXNS INTEGER,
	NET_SALES_AMT NUMERIC(15,3),
	NET_SALES_QTY INTEGER,
	NET_MARGIN_AMT NUMERIC(15,3),
	NBR_ELEMENTS INTEGER
)
DISTRIBUTE ON (BASE_CA_PRODUCT_GROUP_ID, ATTACH_CA_PRODUCT_GROUP_TYPE_ID);


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_MB_RANK_PRE_STATIC
(
	CA_ANALYSIS_ID INTEGER NOT NULL,
	BASE_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	ATTACH_CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	BASE_IND BYTEINT NOT NULL,
	ATTACH_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	CA_TXN_CUST_TYPE_ID INTEGER,
	CHERRY_PICK_TXNS INTEGER,
	SAME_VP_IND BYTEINT,
	TXNS INTEGER,
	NET_SALES_AMT NUMERIC(15,3),
	NET_SALES_QTY INTEGER,
	NET_MARGIN_AMT NUMERIC(15,3),
	NBR_ELEMENTS INTEGER,
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON (BASE_CA_PRODUCT_GROUP_ID, ATTACH_CA_PRODUCT_GROUP_TYPE_ID);


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_MB_TXN
(
	DAY_DT DATE NOT NULL,
	SALES_INSTANCE_ID BIGINT NOT NULL,
	BASE_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	ATTACH_CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	BASE_IND BYTEINT NOT NULL,
	ATTACH_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	LOCATION_ID INTEGER NOT NULL,
	CUSTOMER_GID NUMERIC(19,0) NOT NULL,
	CUST_TYPE_COMPANY BYTEINT NOT NULL,
	CUST_TYPE BYTEINT NOT NULL,
	CA_TXN_CUST_TYPE_ID_COMPANY BYTEINT,
	CA_TXN_CUST_TYPE_ID_LEVEL BYTEINT,
	CHERRY_PICK_IND BYTEINT NOT NULL,
	SAME_VP_IND BYTEINT NOT NULL,
	NET_SALES_AMT NUMERIC(10,2) NOT NULL,
	NET_SALES_QTY INTEGER NOT NULL,
	NET_MARGIN_AMT NUMERIC(12,3) NOT NULL,
	EXCH_RATE_PCT NUMERIC(9,6) NOT NULL,
	NBR_ELEMENTS INTEGER NOT NULL,
	BASE_XREF_ID BIGINT
)
DISTRIBUTE ON (CUSTOMER_GID);

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_MB_TXN
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_MB_TXN_PK
PRIMARY KEY (DAY_DT, SALES_INSTANCE_ID, BASE_CA_PRODUCT_GROUP_ID, ATTACH_CA_PRODUCT_GROUP_TYPE_ID, ATTACH_CA_PRODUCT_GROUP_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_MB_TXN_DG_CG
(
	CUSTOMER_GID NUMERIC(19,0) NOT NULL,
	SALES_INSTANCE_ID BIGINT NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	EXCH_RATE_PCT NUMERIC(9,6),
	TXN_SEQ INTEGER
)
DISTRIBUTE ON (CUSTOMER_GID);


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_MB_TXN_DG_CG_TG_SG
(
	CUSTOMER_GID NUMERIC(19,0) NOT NULL,
	SALES_INSTANCE_ID BIGINT NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	EXCH_RATE_PCT NUMERIC(9,6),
	TXN_SEQ INTEGER,
	ADDL_TXN_IND BYTEINT NOT NULL
)
DISTRIBUTE ON (CUSTOMER_GID);


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_PG
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_TYPE_ID BYTEINT,
	CA_PRODUCT_GROUP_CATEGORY_ID INTEGER,
	CA_PRODUCT_GROUP_CLASS_ID INTEGER,
	CA_PRODUCT_GROUP_DEPT_ID INTEGER,
	CA_PRODUCT_GROUP_DIVISION_ID INTEGER,
	CA_PRODUCT_GROUP_VP_ID INTEGER,
	LOWEST_PG_LEVEL_ID INTEGER,
	PG_IN_USE_IND BYTEINT,
	MISSING_BASE_DATA_IND BYTEINT
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_PG
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_PG_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_PG_CHILD
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	PARENT_KEY_ID BIGINT,
	PARENT_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CHILD_CA_PRODUCT_GROUP_ID INTEGER NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_PG_CHILD
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_PG_SRC_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID, PARENT_CA_PRODUCT_GROUP_ID, CHILD_CA_PRODUCT_GROUP_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_PG_CS_XREF
(
	BASE_CS_XREF_ID BIGINT NOT NULL,
	CS_CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	BASE_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	BASE_IND BYTEINT NOT NULL,
	FINAL_CS_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CS_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	EXCL_BASE_IND BYTEINT NOT NULL,
	NBR_ELEMENTS INTEGER,
	SAME_VP_IND BYTEINT NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_PG_CS_XREF
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_PG_CS_XREF_PK
PRIMARY KEY (BASE_CS_XREF_ID, CS_CA_PRODUCT_GROUP_TYPE_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_PG_DG_TG_SG
(
	CUSTOMER_GID NUMERIC(19,0) NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	START_DAY_DT DATE NOT NULL,
	END_DAY_DT DATE NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	ONE_TRIP_IND BYTEINT NOT NULL,
	TXNS INTEGER NOT NULL,
	NET_SALES_AMT NUMERIC(10,2) NOT NULL,
	NET_SALES_QTY INTEGER NOT NULL,
	NET_MARGIN_AMT NUMERIC(12,3) NOT NULL,
	COMP_TXNS INTEGER NOT NULL,
	COMP_NET_SALES_AMT NUMERIC(10,2) NOT NULL,
	COMP_NET_SALES_QTY INTEGER NOT NULL,
	COMP_NET_MARGIN_AMT NUMERIC(12,3) NOT NULL,
	CUST_TYPE_DAY_COMPANY BYTEINT NOT NULL,
	CUST_TYPE_DAY_VP BYTEINT NOT NULL,
	CUST_TYPE_DAY_DIVISION BYTEINT NOT NULL,
	CUST_TYPE_DAY_DEPT BYTEINT NOT NULL,
	CUST_TYPE_DAY_CLASS BYTEINT NOT NULL,
	CUST_TYPE_DAY_CATEGORY BYTEINT NOT NULL,
	CUST_TYPE_DAY_LEVEL BYTEINT NOT NULL,
	DAYS_TO_NEXT_DAY_COMPANY SMALLINT NOT NULL,
	DAYS_TO_NEXT_DAY_VP SMALLINT NOT NULL,
	DAYS_TO_NEXT_DAY_DIVISION SMALLINT NOT NULL,
	DAYS_TO_NEXT_DAY_DEPT SMALLINT NOT NULL,
	DAYS_TO_NEXT_DAY_CLASS SMALLINT NOT NULL,
	DAYS_TO_NEXT_DAY_CATEGORY SMALLINT NOT NULL,
	DAYS_TO_NEXT_DAY_LEVEL SMALLINT NOT NULL
)
DISTRIBUTE ON (CUSTOMER_GID)
ORGANIZE ON (CA_PRODUCT_GROUP_ID);

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_PG_DG_TG_SG
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_PG_DG_TG_SG_PK
PRIMARY KEY (CUSTOMER_GID, CA_PRODUCT_GROUP_ID, CA_DATE_GROUP_ID, TY_LY_FLAG, CA_TXN_GROUP_COHORT_ID, CA_STORE_GROUP_ID, CURRENCY_TYPE_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_PG_DG_TG_SG_STATIC
(
	CA_ANALYSIS_ID INTEGER NOT NULL,
	CUSTOMER_GID NUMERIC(19,0) NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	START_DAY_DT DATE NOT NULL,
	END_DAY_DT DATE NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	ONE_TRIP_IND BYTEINT NOT NULL,
	TXNS INTEGER NOT NULL,
	NET_SALES_AMT NUMERIC(10,2) NOT NULL,
	NET_SALES_QTY INTEGER NOT NULL,
	NET_MARGIN_AMT NUMERIC(12,3) NOT NULL,
	COMP_TXNS INTEGER NOT NULL,
	COMP_NET_SALES_AMT NUMERIC(10,2) NOT NULL,
	COMP_NET_SALES_QTY INTEGER NOT NULL,
	COMP_NET_MARGIN_AMT NUMERIC(12,3) NOT NULL,
	CUST_TYPE_DAY_COMPANY BYTEINT NOT NULL,
	CUST_TYPE_DAY_VP BYTEINT NOT NULL,
	CUST_TYPE_DAY_DIVISION BYTEINT NOT NULL,
	CUST_TYPE_DAY_DEPT BYTEINT NOT NULL,
	CUST_TYPE_DAY_CLASS BYTEINT NOT NULL,
	CUST_TYPE_DAY_CATEGORY BYTEINT NOT NULL,
	CUST_TYPE_DAY_LEVEL BYTEINT NOT NULL,
	DAYS_TO_NEXT_DAY_COMPANY SMALLINT NOT NULL,
	DAYS_TO_NEXT_DAY_VP SMALLINT NOT NULL,
	DAYS_TO_NEXT_DAY_DIVISION SMALLINT NOT NULL,
	DAYS_TO_NEXT_DAY_DEPT SMALLINT NOT NULL,
	DAYS_TO_NEXT_DAY_CLASS SMALLINT NOT NULL,
	DAYS_TO_NEXT_DAY_CATEGORY SMALLINT NOT NULL,
	DAYS_TO_NEXT_DAY_LEVEL SMALLINT NOT NULL,
	LOAD_TSTMP TIMESTAMP NOT NULL
)
DISTRIBUTE ON (CUSTOMER_GID)
ORGANIZE ON (CA_PRODUCT_GROUP_ID);

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_PG_DG_TG_SG_STATIC
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_PG_DG_TG_SG_STATIC_PK
PRIMARY KEY (CUSTOMER_GID, CA_PRODUCT_GROUP_ID, CA_DATE_GROUP_ID, TY_LY_FLAG, CA_TXN_GROUP_COHORT_ID, CA_STORE_GROUP_ID, CURRENCY_TYPE_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_PG_DG_TXN
(
	CUSTOMER_GID NUMERIC(19,0) NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	DAY_DT DATE NOT NULL,
	SALES_INSTANCE_ID_DIST_KEY BIGINT NOT NULL,
	SALES_INSTANCE_ID BIGINT,
	LOCATION_ID INTEGER NOT NULL,
	COMP_IND BYTEINT NOT NULL,
	ONE_TRIP_IND BYTEINT NOT NULL,
	CUST_TYPE_DAY_COMPANY BYTEINT NOT NULL,
	CUST_TYPE_DAY_VP BYTEINT NOT NULL,
	CUST_TYPE_DAY_DIVISION BYTEINT NOT NULL,
	CUST_TYPE_DAY_DEPT BYTEINT NOT NULL,
	CUST_TYPE_DAY_CLASS BYTEINT NOT NULL,
	CUST_TYPE_DAY_CATEGORY BYTEINT NOT NULL,
	CUST_TYPE_DAY_LEVEL BYTEINT NOT NULL,
	DAYS_TO_NEXT_DAY_COMPANY INTEGER NOT NULL,
	DAYS_TO_NEXT_DAY_VP INTEGER NOT NULL,
	DAYS_TO_NEXT_DAY_DIVISION INTEGER NOT NULL,
	DAYS_TO_NEXT_DAY_DEPT INTEGER NOT NULL,
	DAYS_TO_NEXT_DAY_CLASS INTEGER NOT NULL,
	DAYS_TO_NEXT_DAY_CATEGORY INTEGER NOT NULL,
	DAYS_TO_NEXT_DAY_LEVEL INTEGER NOT NULL,
	TXNS INTEGER NOT NULL,
	NET_SALES_AMT NUMERIC(10,2) NOT NULL,
	NET_SALES_QTY INTEGER NOT NULL,
	NET_MARGIN_AMT NUMERIC(12,3) NOT NULL,
	EXCH_RATE_PCT NUMERIC(9,6) NOT NULL
)
DISTRIBUTE ON (CUSTOMER_GID)
ORGANIZE ON (SALES_INSTANCE_ID_DIST_KEY, LOCATION_ID);

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_PG_DG_TXN
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_PG_DG_TXN_PK
PRIMARY KEY (CUSTOMER_GID, CA_PRODUCT_GROUP_ID, CA_DATE_GROUP_ID, TY_LY_FLAG, DAY_DT, SALES_INSTANCE_ID_DIST_KEY);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_PG_MB_ATTACH
(
	ATTACH_CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_TYPE_ID BYTEINT,
	CA_PRODUCT_GROUP_CATEGORY_ID INTEGER,
	CA_PRODUCT_GROUP_CLASS_ID INTEGER,
	CA_PRODUCT_GROUP_DEPT_ID INTEGER,
	CA_PRODUCT_GROUP_DIVISION_ID INTEGER,
	CA_PRODUCT_GROUP_VP_ID INTEGER,
	MISSING_BASE_DATA_IND BYTEINT,
	LOWEST_PARENT_PG_TYPE_ID BYTEINT,
	LOWEST_PARENT_PG_TYPE_PG_ID INTEGER,
	NBR_ELEMENTS INTEGER
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_PG_MB_ATTACH
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_PG_MB_ATTACH_PK
PRIMARY KEY (ATTACH_CA_PRODUCT_GROUP_TYPE_ID, CA_PRODUCT_GROUP_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_PG_MB_BASE
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_TYPE_ID BYTEINT,
	CA_PRODUCT_GROUP_CATEGORY_ID INTEGER,
	CA_PRODUCT_GROUP_CLASS_ID INTEGER,
	CA_PRODUCT_GROUP_DEPT_ID INTEGER,
	CA_PRODUCT_GROUP_DIVISION_ID INTEGER,
	CA_PRODUCT_GROUP_VP_ID INTEGER,
	MISSING_BASE_DATA_IND BYTEINT,
	LOWEST_PARENT_PG_TYPE_ID BYTEINT,
	LOWEST_PARENT_PG_TYPE_PG_ID INTEGER
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_PG_MB_BASE
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_PG_MB_BASE_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_PG_MB_XREF
(
	BASE_ATTACH_XREF_ID BIGINT NOT NULL,
	ATTACH_CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	BASE_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	FINAL_ATTACH_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	ATTACH_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	BASE_IND INTEGER NOT NULL,
	NBR_ELEMENTS INTEGER NOT NULL,
	SAME_VP_IND BYTEINT NOT NULL
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_PG_PARENT
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	PARENT_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	LEVEL_IND BYTEINT,
	CATEGORY_IND BYTEINT,
	CLASS_IND BYTEINT,
	DEPT_IND BYTEINT,
	DIVISION_IND BYTEINT,
	VP_IND BYTEINT,
	COMPANY_IND BYTEINT
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_PG_PARENT
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_PG_PARENT_PK1
PRIMARY KEY (CA_PRODUCT_GROUP_ID, PARENT_CA_PRODUCT_GROUP_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_RM
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CUSTOMER_GID NUMERIC(19,0) NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	LAST_DAY_DT DATE NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CUST_TYPE_COMPANY BYTEINT NOT NULL,
	CUST_TYPE_LEVEL BYTEINT NOT NULL,
	RETENTION_BUCKET_ID INTEGER NOT NULL,
	RETENTION_BUCKET_COMPLETE_IND BYTEINT NOT NULL,
	RM_PARENT_KEY_ID BIGINT NOT NULL,
	MIGRATION_CA_PRODUCT_GROUP_ID INTEGER NOT NULL
)
DISTRIBUTE ON (CUSTOMER_GID);

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_RM
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_RM_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID, CUSTOMER_GID, CA_DATE_GROUP_ID, TY_LY_FLAG, CA_TXN_GROUP_COHORT_ID, CA_STORE_GROUP_ID, RETENTION_BUCKET_ID, RM_PARENT_KEY_ID, MIGRATION_CA_PRODUCT_GROUP_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_SB_PB
(
	CA_SUBSQNT_PREV_BASKET_ID INTEGER NOT NULL,
	NBR_DAYS SMALLINT,
	TXN_BASIS CHARACTER VARYING(1) NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_SB_PB
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_SB_PB_PK
PRIMARY KEY (CA_SUBSQNT_PREV_BASKET_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_SB_PB_BASE_TXN
(
	CA_SUBSQNT_PREV_BASKET_ID INTEGER NOT NULL,
	CUSTOMER_GID NUMERIC(19,0) NOT NULL,
	SALES_INSTANCE_ID BIGINT NOT NULL,
	DAY_DT DATE NOT NULL,
	START_DAY_DT DATE,
	END_DAY_DT DATE,
	BASE_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	EXCH_RATE_PCT NUMERIC(9,6),
	CA_TXN_CUST_TYPE_ID_COMPANY BYTEINT,
	CA_TXN_CUST_TYPE_ID_LEVEL BYTEINT,
	NBR_DAYS SMALLINT
)
DISTRIBUTE ON (CUSTOMER_GID);


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_SB_PB_CUST
(
	CA_SUBSQNT_PREV_BASKET_ID INTEGER NOT NULL,
	CA_SUBSQNT_PREV_BASKET_TYPE_ID INTEGER,
	CUSTOMER_GID NUMERIC(19,0) NOT NULL,
	DAY_DT DATE NOT NULL,
	START_DAY_DT DATE,
	END_DAY_DT DATE,
	BASE_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	ATTACH_CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	BASE_IND BYTEINT NOT NULL,
	ATTACH_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	CA_TXN_CUST_TYPE_ID_COMPANY BYTEINT,
	CA_TXN_CUST_TYPE_ID_LEVEL BYTEINT,
	TXNS INTEGER,
	NET_SALES_AMT NUMERIC(15,3),
	NET_SALES_QTY INTEGER NOT NULL,
	NET_MARGIN_AMT NUMERIC(15,3),
	CT_EXCH_RATE_PCT NUMERIC(9,6),
	NBR_DAYS SMALLINT,
	EXEC_SEQ SMALLINT
)
DISTRIBUTE ON (CUSTOMER_GID);


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_SB_PB_XREF
(
	ATTACH_CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	BASE_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	FINAL_ATTACH_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	ATTACH_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	BASE_IND BYTEINT NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	CA_TXN_CUST_TYPE_ID BYTEINT NOT NULL,
	SAME_VP_IND BYTEINT,
	ATTACH_RANK INTEGER,
	REST_OF_BASKET_IND BYTEINT
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_SG_STORE
(
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	LOCATION_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID BYTEINT,
	EXCH_RATE_PCT NUMERIC(9,6),
	COMP_EFF_DT TIMESTAMP,
	COMP_END_DT TIMESTAMP
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_SG_XREF
(
	FINAL_CA_STORE_GROUP_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_SG_XREF
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_SG_XREF_PK
PRIMARY KEY (FINAL_CA_STORE_GROUP_ID, CA_STORE_GROUP_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_SOV
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CUSTOMER_GID NUMERIC(19,0) NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	FIRST_DAY_DT DATE NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	SOV_PARENT_KEY_ID BIGINT NOT NULL,
	SOURCE_CA_PRODUCT_GROUP_ID INTEGER NOT NULL
)
DISTRIBUTE ON (CUSTOMER_GID);

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_SOV
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_SOV_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID, CUSTOMER_GID, CA_DATE_GROUP_ID, TY_LY_FLAG, CA_TXN_GROUP_COHORT_ID, CA_STORE_GROUP_ID, SOV_PARENT_KEY_ID, SOURCE_CA_PRODUCT_GROUP_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_TGC
(
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	SALES_INSTANCE_ID BIGINT,
	ORDER_CHANNEL CHARACTER VARYING(4),
	JOIN_TYPE CHARACTER VARYING(100)
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_TG_XREF
(
	FINAL_CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_TG_XREF
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_TG_XREF_PK
PRIMARY KEY (FINAL_CA_TXN_GROUP_COHORT_ID, CA_TXN_GROUP_COHORT_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_TXN_PRE
(
	CUSTOMER_GID NUMERIC(19,0) NOT NULL,
	SALES_INSTANCE_ID_DIST_KEY BIGINT NOT NULL,
	ORDER_CHANNEL CHARACTER VARYING(4),
	LOCATION_ID INTEGER,
	EXCH_RATE_PCT NUMERIC(9,6)
)
DISTRIBUTE ON (CUSTOMER_GID);


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_TXN_TG
(
	CUSTOMER_GID NUMERIC(19,0) NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	SALES_INSTANCE_ID_DIST_KEY BIGINT NOT NULL
)
DISTRIBUTE ON (CUSTOMER_GID);


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_UPT_PG
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	SIZE_ID SMALLINT,
	PRODUCT_ID INTEGER NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_UPT_PG
ADD CONSTRAINT CA_ANALYSIS_DATA_PREP_UPT_PG_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID, PRODUCT_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_UPT_TXN_PG_DG
(
	SALES_INSTANCE_ID BIGINT NOT NULL,
	CUSTOMER_GID NUMERIC(19,0),
	LOCATION_ID INTEGER,
	ORDER_CHANNEL CHARACTER VARYING(4),
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	SIZE_ID SMALLINT NOT NULL,
	NET_SALES_QTY NUMERIC(15,3),
	NET_SALES_AMT NUMERIC(12,2),
	NET_MARGIN_AMT NUMERIC(15,3)
)
DISTRIBUTE ON (SALES_INSTANCE_ID);


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_PREP_UPT_TXN_PG_DG_CG_TG_SG
(
	SALES_INSTANCE_ID BIGINT NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	SIZE_ID SMALLINT NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	NET_SALES_QTY NUMERIC(15,3),
	NET_SALES_AMT NUMERIC(12,2),
	NET_MARGIN_AMT NUMERIC(15,3)
)
DISTRIBUTE ON (SALES_INSTANCE_ID);


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_RM_DETAIL
(
	CA_ANALYSIS_INSTANCE_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CUST_TYPE_COMPANY BYTEINT NOT NULL,
	CUST_TYPE_LEVEL BYTEINT NOT NULL,
	RETENTION_BUCKET_ID INTEGER NOT NULL,
	RETENTION_BUCKET_COMPLETE_IND BYTEINT NOT NULL,
	PARENT_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	MIGRATION_CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CUST_CNT INTEGER
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_RM_SUMMARY
(
	CA_ANALYSIS_INSTANCE_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CUST_TYPE_COMPANY BYTEINT NOT NULL,
	CUST_TYPE_LEVEL BYTEINT NOT NULL,
	ONE_TRIP_IND_LEVEL BYTEINT NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	RETENTION_BUCKET_ID INTEGER NOT NULL,
	RETENTION_BUCKET_COMPLETE_IND BYTEINT NOT NULL,
	RETAINED_IND_COMPANY BYTEINT NOT NULL,
	RETAINED_IND_VP BYTEINT NOT NULL,
	RETAINED_IND_DIVISION BYTEINT NOT NULL,
	RETAINED_IND_DEPT BYTEINT NOT NULL,
	RETAINED_IND_CLASS BYTEINT NOT NULL,
	RETAINED_IND_CATEGORY BYTEINT NOT NULL,
	RETAINED_IND_LEVEL BYTEINT NOT NULL,
	TXNS NUMERIC(12,2),
	NET_SALES_AMT NUMERIC(15,3),
	NET_SALES_QTY NUMERIC(12,2),
	NET_MARGIN_AMT NUMERIC(15,3),
	CUST_CNT NUMERIC(12,2),
	COMP_TXNS NUMERIC(12,2),
	COMP_NET_SALES_AMT NUMERIC(15,3),
	COMP_NET_SALES_QTY NUMERIC(12,2),
	COMP_NET_MARGIN_AMT NUMERIC(15,3),
	COMP_CUST_CNT NUMERIC(12,2)
)
DISTRIBUTE ON RANDOM
ORGANIZE ON (CA_ANALYSIS_INSTANCE_ID);

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_RM_SUMMARY
ADD CONSTRAINT CA_ANALYSIS_DATA_RM_SUMMARY_PK
PRIMARY KEY (CA_ANALYSIS_INSTANCE_ID, CA_PRODUCT_GROUP_ID, CA_STORE_GROUP_ID, CA_DATE_GROUP_ID, TY_LY_FLAG, CA_CUST_GROUP_COHORT_ID, CA_TXN_GROUP_COHORT_ID, CUST_TYPE_COMPANY, CUST_TYPE_LEVEL, ONE_TRIP_IND_LEVEL, CURRENCY_TYPE_ID, RETENTION_BUCKET_ID, RETENTION_BUCKET_COMPLETE_IND, RETAINED_IND_COMPANY, RETAINED_IND_VP, RETAINED_IND_DIVISION, RETAINED_IND_DEPT, RETAINED_IND_CLASS, RETAINED_IND_CATEGORY, RETAINED_IND_LEVEL);



CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_SOV_DETAIL
(
	CA_ANALYSIS_INSTANCE_ID INTEGER,
	CA_PRODUCT_GROUP_ID INTEGER,
	CA_STORE_GROUP_ID INTEGER,
	CA_DATE_GROUP_ID INTEGER,
	TY_LY_FLAG CHARACTER VARYING(2),
	CA_CUST_GROUP_COHORT_ID INTEGER,
	CA_TXN_GROUP_COHORT_ID INTEGER,
	PARENT_CA_PRODUCT_GROUP_ID INTEGER,
	SOURCE_CA_PRODUCT_GROUP_ID INTEGER,
	CUST_CNT INTEGER
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_SOV_SUMMARY
(
	CA_ANALYSIS_INSTANCE_ID INTEGER,
	CA_PRODUCT_GROUP_ID INTEGER,
	CA_STORE_GROUP_ID INTEGER,
	CA_DATE_GROUP_ID INTEGER,
	TY_LY_FLAG CHARACTER VARYING(2),
	CA_CUST_GROUP_COHORT_ID INTEGER,
	CA_TXN_GROUP_COHORT_ID INTEGER,
	PARENT_LEVEL_ID INTEGER,
	PARENT_CA_PRODUCT_GROUP_ID INTEGER,
	METRIC_LEVEL_ID INTEGER,
	TOTAL_CUST_CNT INTEGER,
	LEVEL_CUST_CNT INTEGER,
	WFALL_CUST_CNT INTEGER
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_ANALYSIS_DATA_UPT
(
	CA_ANALYSIS_INSTANCE_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	SIZE_ID SMALLINT NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_WEEK_CNT INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	UPT_BUCKET_ID INTEGER NOT NULL,
	UPT_BUCKET_ELEMENT_DESC CHARACTER VARYING(20) NOT NULL,
	UPT_BUCKET_ELEMENT_SORT_ID INTEGER NOT NULL,
	TXNS NUMERIC(12,2),
	NET_SALES_AMT NUMERIC(15,3),
	NET_SALES_QTY NUMERIC(12,2),
	NET_MARGIN_AMT NUMERIC(15,3)
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_DATA_UPT
ADD CONSTRAINT CA_ANALYSIS_DATA_UPT_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID, CA_STORE_GROUP_ID, CA_DATE_GROUP_ID, TY_LY_FLAG, CA_CUST_GROUP_COHORT_ID, CA_TXN_GROUP_COHORT_ID, CURRENCY_TYPE_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_GROUP
(
	CA_ANALYSIS_GROUP_ID INTEGER NOT NULL,
	CA_ANALYSIS_ID INTEGER,
	CA_ANALYSIS_GROUP_TYPE_ID BYTEINT,
	CA_GROUP_ID INTEGER,
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP,
	UPDATE_USER_ID CHARACTER VARYING(50),
	UPDATE_TSTMP TIMESTAMP,
	RETIRE_IND BYTEINT,
	RETIRE_USER_ID CHARACTER VARYING(50),
	RETIRE_TSTMP TIMESTAMP,
	NBR_ELEMENTS INTEGER
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_GROUP
ADD CONSTRAINT CA_ANALYSIS_GROUP_PK1
PRIMARY KEY (CA_ANALYSIS_GROUP_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_GROUP_CUSTOM_PRE
(
	CA_ANALYSIS_ID INTEGER NOT NULL,
	CA_ANALYSIS_DESC CHARACTER VARYING(50),
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP,
	CA_ANALYSIS_TYPE_ID BYTEINT,
	CA_ANALYSIS_GROUP_ID INTEGER NOT NULL,
	CA_ANALYSIS_GROUP_TYPE_ID BYTEINT,
	CA_GROUP_ID INTEGER,
	NBR_ELEMENTS INTEGER
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_GROUP_CUSTOM_PRE
ADD CONSTRAINT CA_ANALYSIS_GROUP_CUSTOM_PRE_PK
PRIMARY KEY (CA_ANALYSIS_GROUP_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_GROUP_DG_CTRL
(
	SUN_CA_ANALYSIS_ID INTEGER NOT NULL,
	MON_CA_ANALYSIS_ID INTEGER NOT NULL,
	CA_DATE_GROUP_TYPE_ID BYTEINT NOT NULL,
	CA_DATE_GROUP_ID INTEGER,
	NBR_ELEMENTS SMALLINT NOT NULL,
	REFRESH_CD CHARACTER VARYING(10),
	PRIMARY_IND BYTEINT NOT NULL
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_ANALYSIS_GROUP_DG_XREF
(
	CA_ANALYSIS_ID INTEGER NOT NULL,
	CA_DATE_GROUP_TYPE_ID BYTEINT NOT NULL,
	FINAL_CA_DATE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_ANALYSIS_GROUP_SYSTEM_PRE
(
	CA_ANALYSIS_ID INTEGER NOT NULL,
	CA_ANALYSIS_GROUP_TYPE_ID BYTEINT NOT NULL,
	CA_GROUP_ID INTEGER NOT NULL
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_ANALYSIS_GROUP_TYPE
(
	CA_ANALYSIS_GROUP_TYPE_ID BYTEINT NOT NULL,
	CA_ANALYSIS_GROUP_TYPE_DESC CHARACTER VARYING(50),
	UPDATE_TSTMP TIMESTAMP,
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_GROUP_TYPE
ADD CONSTRAINT CA_ANALYSIS_GROUP_TYPE_PK
PRIMARY KEY (CA_ANALYSIS_GROUP_TYPE_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_INSTANCE
(
	CA_ANALYSIS_INSTANCE_ID INTEGER NOT NULL,
	CA_ANALYSIS_ID INTEGER,
	ACTIVE_IND BYTEINT,
	ACTIVE_START_TSTMP TIMESTAMP,
	ACTIVE_END_TSTMP TIMESTAMP,
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_INSTANCE
ADD CONSTRAINT CA_ANALYSIS_INSTANCE_NEW_PK1
PRIMARY KEY (CA_ANALYSIS_INSTANCE_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_INSTANCE_GROUP_LOG
(
	CA_ANALYSIS_INSTANCE_ID INTEGER,
	CA_ANALYSIS_GROUP_TYPE_ID BYTEINT,
	CA_GROUP_ID INTEGER,
	NBR_ELEMENTS INTEGER
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_ANALYSIS_STATUS
(
	CA_ANALYSIS_STATUS_ID BYTEINT NOT NULL,
	CA_ANALYSIS_STATUS_DESC CHARACTER VARYING(50),
	CA_ANALYSIS_STATUS_LONG_DESC CHARACTER VARYING(250),
	CA_ANALYSIS_STATUS_ICON CHARACTER VARYING(50),
	UPDATE_TSTMP TIMESTAMP,
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_STATUS
ADD CONSTRAINT CA_ANALYSIS_STATUS_PK
PRIMARY KEY (CA_ANALYSIS_STATUS_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_TECHNIQUE
(
	CA_ANALYSIS_TECHNIQUE_ID BYTEINT NOT NULL,
	CA_ANALYSIS_TECHNIQUE_DESC CHARACTER VARYING(50)
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_TECHNIQUE
ADD CONSTRAINT CA_ANALYSIS_TECHNIQUE_PK
PRIMARY KEY (CA_ANALYSIS_TECHNIQUE_ID);



CREATE TABLE KEDWARDS.CA_ANALYSIS_TYPE
(
	CA_ANALYSIS_TYPE_ID BYTEINT NOT NULL,
	CA_ANALYSIS_TYPE_DESC CHARACTER VARYING(50) NOT NULL,
	CA_ANALYSIS_TYPE_SP CHARACTER VARYING(50) NOT NULL,
	UPDATE_TSTMP TIMESTAMP NOT NULL,
	LOAD_TSTMP TIMESTAMP NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_ANALYSIS_TYPE
ADD CONSTRAINT CA_ANALYSIS_TYPE_PK
PRIMARY KEY (CA_ANALYSIS_TYPE_ID);



CREATE TABLE KEDWARDS.CA_CUSTOMER_HOME_MESSAGE
(
	REC_EFF_TSTMP TIMESTAMP NOT NULL,
	CA_CUSTOMER_HOME_MESSAGE_TXT CHARACTER VARYING(500) NOT NULL,
	REC_END_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_CUSTOMER_HOME_MESSAGE
ADD CONSTRAINT CA_CUSTOMER_HOME_MESSAGE_PK
PRIMARY KEY (REC_EFF_TSTMP);



CREATE TABLE KEDWARDS.CA_CUSTOMER_ID_TYPE
(
	CA_CUSTOMER_ID_TYPE_ID BYTEINT NOT NULL,
	CA_CUSTOMER_ID_TYPE_DESC CHARACTER VARYING(50) NOT NULL,
	UPDATE_TSTMP TIMESTAMP NOT NULL,
	LOAD_TSTMP TIMESTAMP NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_CUSTOMER_ID_TYPE
ADD CONSTRAINT CA_CUSTOMER_ID_TYPE_PK
PRIMARY KEY (CA_CUSTOMER_ID_TYPE_ID);



CREATE TABLE KEDWARDS.CA_CUSTOMER_LKUP
(
	CUSTOMER_GID NUMERIC(19,0) NOT NULL,
	CUSTOMER_GID_TXT CHARACTER VARYING(25)
)
DISTRIBUTE ON (CUSTOMER_GID);

ALTER TABLE KEDWARDS.CA_CUSTOMER_LKUP
ADD CONSTRAINT CA_CUSTOMER_LKUP_PK
PRIMARY KEY (CUSTOMER_GID);



CREATE TABLE KEDWARDS.CA_CUSTOMER_SUB_SEGMENT
(
	CUSTOMER_SUB_SEGMENT_CD CHARACTER VARYING(5) NOT NULL,
	CUSTOMER_SUB_SEGMENT_NAME CHARACTER VARYING(50) NOT NULL,
	CUSTOMER_SEGMENT_CD CHARACTER VARYING(5) NOT NULL,
	CUSTOMER_SEGMENT_NAME CHARACTER VARYING(50) NOT NULL,
	CUSTOMER_SEGMENT_SPECIES_GRP_CD CHARACTER VARYING(5) NOT NULL,
	CUSTOMER_SEGMENT_SPECIES_GRP_NAME CHARACTER VARYING(50) NOT NULL
)
DISTRIBUTE ON (CUSTOMER_SUB_SEGMENT_CD);

ALTER TABLE KEDWARDS.CA_CUSTOMER_SUB_SEGMENT
ADD CONSTRAINT CA_CUSTOMER_SUB_SEGMENT_PK
PRIMARY KEY (CUSTOMER_SUB_SEGMENT_CD);



CREATE TABLE KEDWARDS.CA_CUST_GROUP
(
	CA_CUST_GROUP_ID INTEGER NOT NULL,
	CA_CUST_GROUP_DESC CHARACTER VARYING(50),
	CA_CUST_GROUP_LONG_DESC CHARACTER VARYING(250),
	CA_CUST_GROUP_TYPE_ID BYTEINT,
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP,
	UPDATE_USER_ID CHARACTER VARYING(50),
	UPDATE_TSTMP TIMESTAMP,
	RETIRE_IND BYTEINT,
	RETIRE_USER_ID CHARACTER VARYING(50),
	RETIRE_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_CUST_GROUP
ADD CONSTRAINT CA_CUST_GROUP_NEW_PK
PRIMARY KEY (CA_CUST_GROUP_ID);



CREATE TABLE KEDWARDS.CA_CUST_GROUP_COHORT
(
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_CUST_GROUP_COHORT_DESC CHARACTER VARYING(50),
	CA_CUST_GROUP_COHORT_LONG_DESC CHARACTER VARYING(250),
	CA_CUST_GROUP_ID INTEGER,
	CUST_CNT INTEGER,
	CA_CUST_LIST CHARACTER VARYING(100),
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP,
	UPDATE_USER_ID CHARACTER VARYING(50),
	UPDATE_TSTMP TIMESTAMP,
	RETIRE_IND BYTEINT,
	RETIRE_USER_ID CHARACTER VARYING(50),
	RETIRE_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_CUST_GROUP_COHORT
ADD CONSTRAINT CA_CUST_GROUP_COHORT_NEW_PK
PRIMARY KEY (CA_CUST_GROUP_COHORT_ID);



CREATE TABLE KEDWARDS.CA_CUST_GROUP_COHORT_COMPONENT
(
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CUSTOMER_GID NUMERIC(19,0)
)
DISTRIBUTE ON (CUSTOMER_GID);


CREATE TABLE KEDWARDS.CA_CUST_GROUP_CUSTOM_PRE
(
	CA_CUST_GROUP_ID INTEGER NOT NULL,
	CA_CUST_GROUP_DESC CHARACTER VARYING(50),
	CA_CUST_LIST CHARACTER VARYING(100),
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_CUST_GROUP_CUSTOM_PRE
ADD CONSTRAINT CA_CUST_GROUP_CUSTOM_PRE_PK
PRIMARY KEY (CA_CUST_GROUP_ID);



CREATE TABLE KEDWARDS.CA_CUST_GROUP_TYPE
(
	CA_CUST_GROUP_TYPE_ID BYTEINT NOT NULL,
	CA_CUST_GROUP_TYPE_DESC CHARACTER VARYING(50)
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_CUST_GROUP_TYPE
ADD CONSTRAINT CA_CUST_GROUP_TYPE_PK
PRIMARY KEY (CA_CUST_GROUP_TYPE_ID);



CREATE TABLE KEDWARDS.CA_CUST_SALES_DAY_PG
(
	CUSTOMER_EID NUMERIC(19,0) NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	DAY_DT DATE NOT NULL,
	VISIT_SEQ_LEVEL BIGINT,
	VISITS_3YR BIGINT,
	DAYS_BETWEEN_3YR INTEGER,
	CYCLE_TIME_AVG NUMERIC(10,2),
	CYCLE_TIME_MEDIAN NUMERIC(10,2),
	NET_SALES_AMT_USD NUMERIC(15,3),
	NET_MARGIN_AMT_USD NUMERIC(15,3)
)
DISTRIBUTE ON (CUSTOMER_EID)
ORGANIZE ON (CA_PRODUCT_GROUP_ID, DAY_DT);

ALTER TABLE KEDWARDS.CA_CUST_SALES_DAY_PG
ADD CONSTRAINT CA_CUST_SALES_DAY_PG_PK
PRIMARY KEY (DAY_DT, CUSTOMER_EID, CA_PRODUCT_GROUP_ID);



CREATE TABLE KEDWARDS.CA_CUST_SALES_DAY_PG_CT_PRE
(
	DAY_DT DATE NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_CUSTOMER_ID NUMERIC(19,0) NOT NULL,
	CA_CUSTOMER_ID_TYPE_ID BYTEINT,
	DAYS_TO_NEXT_DAY_COMPANY SMALLINT,
	DAYS_TO_NEXT_DAY_VP SMALLINT,
	DAYS_TO_NEXT_DAY_DIVISION SMALLINT,
	DAYS_TO_NEXT_DAY_DEPT SMALLINT,
	DAYS_TO_NEXT_DAY_CLASS SMALLINT,
	DAYS_TO_NEXT_DAY_CATEGORY SMALLINT,
	DAYS_TO_NEXT_DAY_LEVEL SMALLINT,
	CUST_TYPE_DAY_COMPANY BYTEINT NOT NULL,
	CUST_TYPE_DAY_VP BYTEINT NOT NULL,
	CUST_TYPE_DAY_DIVISION BYTEINT NOT NULL,
	CUST_TYPE_DAY_DEPT BYTEINT NOT NULL,
	CUST_TYPE_DAY_CLASS BYTEINT NOT NULL,
	CUST_TYPE_DAY_CATEGORY BYTEINT NOT NULL,
	CUST_TYPE_DAY_LEVEL BYTEINT NOT NULL
)
DISTRIBUTE ON (CA_CUSTOMER_ID);

ALTER TABLE KEDWARDS.CA_CUST_SALES_DAY_PG_CT_PRE
ADD CONSTRAINT CA_CUST_SALES_DAY_PG_CT_PRE_PK
PRIMARY KEY (DAY_DT, CA_PRODUCT_GROUP_ID, CA_CUSTOMER_ID);



CREATE TABLE KEDWARDS.CA_CUST_SALES_DAY_PG_PRE
(
	DAY_DT DATE NOT NULL,
	CUSTOMER_EID NUMERIC(19,0) NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	DAYS_FROM_LAST_VISIT_LEVEL BIGINT,
	VISIT_SEQ_LEVEL BIGINT,
	NET_SALES_AMT_USD NUMERIC(15,3),
	NET_MARGIN_AMT_USD NUMERIC(15,3)
)
DISTRIBUTE ON (CUSTOMER_EID)
ORGANIZE ON (DAY_DT, CA_PRODUCT_GROUP_ID);

ALTER TABLE KEDWARDS.CA_CUST_SALES_DAY_PG_PRE
ADD CONSTRAINT CA_CUST_SALES_DAY_PG_PRE_PK
PRIMARY KEY (DAY_DT, CUSTOMER_EID, CA_PRODUCT_GROUP_ID);



CREATE TABLE KEDWARDS.CA_CUST_SALES_TRANS_AUDIT
(
	DAY_DT DATE NOT NULL,
	TXNS INTEGER,
	TRACKABLE_TXNS INTEGER,
	TRACKABLE_PCT NUMERIC(8,6),
	CHANGE_IND BYTEINT,
	VALID_IND BYTEINT,
	VALID_OVERRIDE_CD CHARACTER(1),
	UPDATE_TSTMP TIMESTAMP,
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_CUST_SALES_TRANS_AUDIT
ADD CONSTRAINT CA_CUST_SALES_TRANS_AUDIT_PK
PRIMARY KEY (DAY_DT);



CREATE TABLE KEDWARDS.CA_CUST_SALES_TRANS_AUDIT_HIST
(
	EXECUTION_TSTMP TIMESTAMP NOT NULL,
	FIRST_CHANGE_DT DATE,
	LAST_CHANGE_DT DATE,
	FIRST_INVALID_DT DATE,
	LAST_VALID_DT DATE,
	REFRESH_START_DT DATE,
	REFRESH_END_DT DATE,
	ALERT_IND BYTEINT,
	ALERT_DESC CHARACTER VARYING(250)
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_CUST_SALES_TRANS_AUDIT_HIST
ADD CONSTRAINT CA_CUST_SALES_TRANS_AUDIT_HIST_PK
PRIMARY KEY (EXECUTION_TSTMP);



CREATE TABLE KEDWARDS.CA_CUST_SALES_TRANS_PG
(
	DAY_DT DATE NOT NULL,
	SALES_INSTANCE_ID_DIST_KEY BIGINT NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	SALES_INSTANCE_ID BIGINT,
	CA_PRODUCT_GROUP_TYPE_ID BYTEINT,
	LOCATION_ID INTEGER,
	ORDER_NBR BIGINT,
	ORDER_CHANNEL CHARACTER VARYING(4),
	ORDER_ASSIST_LOCATION_ID INTEGER,
	CA_CUSTOMER_ID NUMERIC(19,0) NOT NULL,
	CA_CUSTOMER_ID_TYPE_ID BYTEINT,
	DAYS_FROM_LAST_TXN SMALLINT,
	DAYS_TO_NEXT_DAY_COMPANY SMALLINT,
	DAYS_TO_NEXT_DAY_VP SMALLINT,
	DAYS_TO_NEXT_DAY_DIVISION SMALLINT,
	DAYS_TO_NEXT_DAY_DEPT SMALLINT,
	DAYS_TO_NEXT_DAY_CLASS SMALLINT,
	DAYS_TO_NEXT_DAY_CATEGORY SMALLINT,
	DAYS_TO_NEXT_DAY_LEVEL SMALLINT,
	DAYS_TO_NEXT_TXN SMALLINT,
	CUST_TYPE_DAY_COMPANY BYTEINT,
	CUST_TYPE_DAY_VP BYTEINT,
	CUST_TYPE_DAY_DIVISION BYTEINT,
	CUST_TYPE_DAY_DEPT BYTEINT,
	CUST_TYPE_DAY_CLASS BYTEINT,
	CUST_TYPE_DAY_CATEGORY BYTEINT,
	CUST_TYPE_DAY_LEVEL BYTEINT,
	CUST_TYPE BYTEINT,
	CUST_TYPE_POST BYTEINT,
	TXN_SEQ INTEGER,
	TXN_SEQ_REV INTEGER,
	ONE_TRIP_IND BYTEINT,
	SALES_AMT NUMERIC(10,2),
	RETURN_AMT NUMERIC(10,2),
	NET_DISCOUNT_AMT NUMERIC(10,4),
	POS_COUPON_AMT NUMERIC(8,2),
	NET_SALES_AMT NUMERIC(10,2),
	NET_SALES_COST NUMERIC(10,2),
	NET_SALES_QTY INTEGER,
	NET_MARGIN_AMT NUMERIC(12,3),
	EXCH_RATE_PCT NUMERIC(9,6),
	CHERRY_PICK_IND BYTEINT
)
DISTRIBUTE ON (CA_CUSTOMER_ID)
ORGANIZE ON (DAY_DT, CA_PRODUCT_GROUP_ID);

ALTER TABLE KEDWARDS.CA_CUST_SALES_TRANS_PG
ADD CONSTRAINT CA_CUST_SALES_TRANS_PG_PK
PRIMARY KEY (DAY_DT, SALES_INSTANCE_ID_DIST_KEY, CA_PRODUCT_GROUP_ID, CA_CUSTOMER_ID);



CREATE TABLE KEDWARDS.CA_CUST_SALES_TRANS_PG_EXCL_DAYS
(
	DAY_DT DATE NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_CUST_SALES_TRANS_PG_EXCL_DAYS
ADD CONSTRAINT CA_CUST_SALES_TRANS_PG_EXCL_DAYS_PK
PRIMARY KEY (DAY_DT);



CREATE TABLE KEDWARDS.CA_CUST_SALES_TRANS_PG_LIST
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CREATE_PROCESS_CD CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_CUST_SALES_TRANS_PG_LIST
ADD CONSTRAINT CA_CUST_SALES_TRANS_PG_LIST_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID);



CREATE TABLE KEDWARDS.CA_CUST_SALES_TRANS_PG_LIST_HIST
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	LOAD_TSTMP TIMESTAMP,
	INS_DEL_FLAG CHARACTER VARYING(1),
	PROCESS_CD CHARACTER VARYING(50)
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_CUST_SALES_TRANS_PG_LIST_HIST
ADD CONSTRAINT CA_CUST_SALES_TRANS_PG_LIST_HIST_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID);



CREATE TABLE KEDWARDS.CA_CUST_SALES_TRANS_PG_PRE
(
	DAY_DT DATE NOT NULL,
	SALES_INSTANCE_ID_DIST_KEY BIGINT NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	SALES_INSTANCE_ID BIGINT,
	CA_PRODUCT_GROUP_TYPE_ID BYTEINT,
	LOCATION_ID INTEGER,
	ORDER_NBR BIGINT,
	ORDER_CHANNEL CHARACTER VARYING(4),
	ORDER_ASSIST_LOCATION_ID INTEGER,
	CA_CUSTOMER_ID NUMERIC(19,0) NOT NULL,
	CA_CUSTOMER_ID_TYPE_ID BYTEINT,
	TRANS_TSTMP TIMESTAMP,
	SALES_AMT NUMERIC(10,2),
	RETURN_AMT NUMERIC(10,2),
	NET_DISCOUNT_AMT NUMERIC(10,4),
	POS_COUPON_AMT NUMERIC(8,2),
	NET_SALES_AMT NUMERIC(10,2),
	NET_SALES_COST NUMERIC(10,2),
	NET_SALES_QTY INTEGER,
	NET_MARGIN_AMT NUMERIC(12,3),
	EXCH_RATE_PCT NUMERIC(9,6),
	CHERRY_PICK_SKU_CNT INTEGER
)
DISTRIBUTE ON (CA_CUSTOMER_ID);

ALTER TABLE KEDWARDS.CA_CUST_SALES_TRANS_PG_PRE
ADD CONSTRAINT CA_CUST_SALES_TRANS_PG_PRE_PK
PRIMARY KEY (DAY_DT, SALES_INSTANCE_ID_DIST_KEY, CA_PRODUCT_GROUP_ID, CA_CUSTOMER_ID);



CREATE TABLE KEDWARDS.CA_CUST_SALES_TRANS_PG_PRE2
(
	DAY_DT DATE NOT NULL,
	SALES_INSTANCE_ID_DIST_KEY BIGINT NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	SALES_INSTANCE_ID BIGINT,
	CA_PRODUCT_GROUP_TYPE_ID BYTEINT,
	LOCATION_ID INTEGER,
	ORDER_NBR BIGINT,
	ORDER_CHANNEL CHARACTER VARYING(4),
	ORDER_ASSIST_LOCATION_ID INTEGER,
	CA_CUSTOMER_ID NUMERIC(19,0) NOT NULL,
	CA_CUSTOMER_ID_TYPE_ID BYTEINT,
	DAYS_FROM_LAST_TXN SMALLINT,
	DAYS_TO_NEXT_TXN SMALLINT,
	CUST_TYPE BYTEINT,
	CUST_TYPE_POST BYTEINT,
	TXN_SEQ INTEGER,
	TXN_SEQ_REV INTEGER,
	ONE_TRIP_IND BYTEINT,
	SALES_AMT NUMERIC(10,2),
	RETURN_AMT NUMERIC(10,2),
	NET_DISCOUNT_AMT NUMERIC(10,4),
	POS_COUPON_AMT NUMERIC(8,2),
	NET_SALES_AMT NUMERIC(10,2),
	NET_SALES_COST NUMERIC(10,2),
	NET_SALES_QTY INTEGER,
	NET_MARGIN_AMT NUMERIC(12,3),
	EXCH_RATE_PCT NUMERIC(9,6),
	CHERRY_PICK_SKU_CNT INTEGER,
	CHERRY_PICK_IND BYTEINT,
	PARENT_CA_PRODUCT_GROUP_ID INTEGER
)
DISTRIBUTE ON (CA_CUSTOMER_ID);

ALTER TABLE KEDWARDS.CA_CUST_SALES_TRANS_PG_PRE2
ADD CONSTRAINT CA_CUST_SALES_TRANS_PG_PRE2_PK
PRIMARY KEY (DAY_DT, SALES_INSTANCE_ID_DIST_KEY, CA_PRODUCT_GROUP_ID, CA_CUSTOMER_ID);



CREATE TABLE KEDWARDS.CA_CUST_SALES_TRANS_SKU_PRE
(
	DAY_DT DATE NOT NULL,
	SALES_INSTANCE_ID_DIST_KEY BIGINT NOT NULL,
	PRODUCT_ID INTEGER NOT NULL,
	SALES_INSTANCE_ID BIGINT,
	LOCATION_ID INTEGER,
	ORDER_NBR BIGINT,
	ORDER_CHANNEL CHARACTER VARYING(4),
	ORDER_ASSIST_LOCATION_ID INTEGER,
	CA_CUSTOMER_ID NUMERIC(19,0) NOT NULL,
	CA_CUSTOMER_ID_TYPE_ID BYTEINT,
	TRANS_TSTMP TIMESTAMP,
	SALES_AMT NUMERIC(10,2),
	RETURN_AMT NUMERIC(10,2),
	NET_DISCOUNT_AMT NUMERIC(10,4),
	POS_COUPON_AMT NUMERIC(8,2),
	NET_SALES_AMT NUMERIC(10,2),
	NET_SALES_COST NUMERIC(10,2),
	NET_SALES_QTY INTEGER,
	NET_MARGIN_AMT NUMERIC(12,3),
	EXCH_RATE_PCT NUMERIC(9,6),
	CHERRY_PICK_SKU_IND BIGINT
)
DISTRIBUTE ON (CA_CUSTOMER_ID);

ALTER TABLE KEDWARDS.CA_CUST_SALES_TRANS_SKU_PRE
ADD CONSTRAINT CA_CUST_SALES_TRANS_SKU_PRE_PK
PRIMARY KEY (DAY_DT, SALES_INSTANCE_ID_DIST_KEY, PRODUCT_ID, CA_CUSTOMER_ID);



CREATE TABLE KEDWARDS.CA_CUST_TYPE_GROUP
(
	CA_CUST_TYPE_GROUP_ID BYTEINT NOT NULL,
	CA_CUST_TYPE_GROUP_DESC CHARACTER VARYING(50),
	SORT_ID BYTEINT,
	UPDATE_TSTMP TIMESTAMP,
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_CUST_TYPE_GROUP
ADD CONSTRAINT CA_CUST_TYPE_GROUP_PK
PRIMARY KEY (CA_CUST_TYPE_GROUP_ID);



CREATE TABLE KEDWARDS.CA_CUST_TYPE_GROUP_XREF
(
	CA_CUST_TYPE_GROUP_ID BYTEINT NOT NULL,
	CUST_TYPE_LEVEL BYTEINT,
	CUST_TYPE_COMPANY BYTEINT
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_DAILY_PROCESSING_LOG
(
	START_TSTMP TIMESTAMP NOT NULL,
	REFRESH_CNT INTEGER,
	END_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_DAILY_PROCESSING_LOG
ADD CONSTRAINT CA_DAILY_PROCESSING_LOG_PK
PRIMARY KEY (START_TSTMP);



CREATE TABLE KEDWARDS.CA_DATE_GROUP
(
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_DESC CHARACTER VARYING(50),
	CA_DATE_GROUP_DESC2 CHARACTER VARYING(50),
	CA_DATE_GROUP_DESC3 CHARACTER VARYING(50),
	CA_DATE_GROUP_LONG_DESC CHARACTER VARYING(250),
	CA_DATE_GROUP_TYPE_ID BYTEINT,
	CA_DATE_GROUP_SORT_ID INTEGER,
	WEEK_CNT NUMERIC(8,4),
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP,
	UPDATE_USER_ID CHARACTER VARYING(50),
	UPDATE_TSTMP TIMESTAMP,
	RETIRE_IND BYTEINT,
	RETIRE_USER_ID CHARACTER VARYING(50),
	RETIRE_TSTMP TIMESTAMP
)
DISTRIBUTE ON (CA_DATE_GROUP_ID);

ALTER TABLE KEDWARDS.CA_DATE_GROUP
ADD CONSTRAINT CA_DATE_GROUP_PK
PRIMARY KEY (CA_DATE_GROUP_ID);



CREATE TABLE KEDWARDS.CA_DATE_GROUP_COMPONENT
(
	CA_DATE_GROUP_COMPONENT_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER,
	EXCLUSION_IND BYTEINT,
	START_DT TIMESTAMP,
	END_DT TIMESTAMP,
	DAY_OF_WK_NAME CHARACTER(9),
	FISCAL_WK INTEGER,
	FISCAL_MO INTEGER,
	FISCAL_QTR INTEGER,
	FISCAL_HALF INTEGER,
	FISCAL_YR SMALLINT,
	WEEK_DT TIMESTAMP,
	DAY_DT TIMESTAMP,
	CAL_YR SMALLINT,
	CAL_HALF INTEGER,
	CAL_QTR INTEGER,
	CAL_MO INTEGER,
	CAL_WK INTEGER,
	PE_PROMO_ID INTEGER,
	EM_EVENT_ID INTEGER,
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP,
	UPDATE_USER_ID CHARACTER VARYING(50),
	UPDATE_TSTMP TIMESTAMP,
	RETIRE_IND BYTEINT,
	RETIRE_USER_ID CHARACTER VARYING(50),
	RETIRE_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_DATE_GROUP_COMPONENT
ADD CONSTRAINT CA_DATE_GROUP_COMPONENT_PK
PRIMARY KEY (CA_DATE_GROUP_COMPONENT_ID);



CREATE TABLE KEDWARDS.CA_DATE_GROUP_COMPONENT_PRE
(
	CA_DATE_GROUP_COMPONENT_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER,
	EXCLUSION_IND BYTEINT,
	DAY_OF_WK_NAME CHARACTER(9),
	FISCAL_WK INTEGER,
	FISCAL_MO INTEGER,
	FISCAL_QTR INTEGER,
	FISCAL_HALF INTEGER,
	FISCAL_YR SMALLINT,
	DAY_DT TIMESTAMP,
	CAL_YR SMALLINT,
	CAL_HALF INTEGER,
	CAL_QTR INTEGER,
	CAL_MO INTEGER,
	CAL_WK INTEGER,
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP,
	UPDATE_TSTMP TIMESTAMP,
	RETIRE_IND BYTEINT,
	RETIRE_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_DATE_GROUP_COMPONENT_PRE
ADD CONSTRAINT CA_DATE_GROUP_COMPONENT_PRE_PK
PRIMARY KEY (CA_DATE_GROUP_COMPONENT_ID);



CREATE TABLE KEDWARDS.CA_DATE_GROUP_CUSTOM_PRE
(
	CA_DATE_GROUP_COMPONENT_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER,
	CA_DATE_GROUP_DESC CHARACTER VARYING(50),
	CA_DATE_GROUP_LONG_DESC CHARACTER VARYING(250),
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP,
	UPDATE_TSTMP TIMESTAMP,
	RETIRE_TSTMP TIMESTAMP,
	RETIRE_IND BYTEINT,
	EXCLUSION_IND BYTEINT,
	DAY_OF_WK_NAME CHARACTER(9),
	FISCAL_WK INTEGER,
	FISCAL_MO INTEGER,
	FISCAL_QTR INTEGER,
	FISCAL_HALF INTEGER,
	FISCAL_YR SMALLINT,
	DAY_DT TIMESTAMP,
	CAL_YR SMALLINT,
	CAL_HALF INTEGER,
	CAL_QTR INTEGER,
	CAL_MO INTEGER,
	CAL_WK INTEGER,
	CREATE_TSTMP2 TIMESTAMP,
	UPDATE_TSTMP2 TIMESTAMP,
	RETIRE_TSTMP2 TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_DATE_GROUP_CUSTOM_PRE
ADD CONSTRAINT CA_DATE_GROUP_CUSTOM_PRE_PK
PRIMARY KEY (CA_DATE_GROUP_COMPONENT_ID);



CREATE TABLE KEDWARDS.CA_DATE_GROUP_TYPE
(
	CA_DATE_GROUP_TYPE_ID BYTEINT NOT NULL,
	CA_DATE_GROUP_TYPE_DESC CHARACTER VARYING(50),
	CA_DATE_GROUP_TYPE_LONG_DESC CHARACTER VARYING(250),
	UPDATE_TSTMP TIMESTAMP,
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON (CA_DATE_GROUP_TYPE_ID);

ALTER TABLE KEDWARDS.CA_DATE_GROUP_TYPE
ADD CONSTRAINT CA_DATE_GROUP_TYPE_PK
PRIMARY KEY (CA_DATE_GROUP_TYPE_ID);



CREATE TABLE KEDWARDS.CA_GROUP_AUTO_RETIRE_PRE
(
	GROUP_ID INTEGER NOT NULL,
	GROUP_NAME CHARACTER VARYING(32),
	GROUP_DESC CHARACTER VARYING(128),
	GROUP_TYPE_ID INTEGER,
	LAST_USED_TIMESTAMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_GROUP_AUTO_RETIRE_PRE
ADD CONSTRAINT CA_GROUP_AUTO_RETIRE_PRE_PK
PRIMARY KEY (GROUP_ID);



CREATE TABLE KEDWARDS.CA_LOYALTY_MEMBER
(
	LOYALTY_MEMBER_ID BYTEINT NOT NULL,
	LOYALTY_MEMBER_DESC CHARACTER VARYING(50) NOT NULL
)
DISTRIBUTE ON (LOYALTY_MEMBER_ID);

ALTER TABLE KEDWARDS.CA_LOYALTY_MEMBER
ADD CONSTRAINT CA_LOYALTY_MEMBER_PK
PRIMARY KEY (LOYALTY_MEMBER_ID);



CREATE TABLE KEDWARDS.CA_METRIC_LEVEL
(
	METRIC_LEVEL_ID INTEGER NOT NULL,
	METRIC_LEVEL_DESC CHARACTER VARYING(50),
	METRIC_LEVEL_SORT_ID BYTEINT
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_METRIC_LEVEL
ADD CONSTRAINT CA_METRIC_LEVEL_PK
PRIMARY KEY (METRIC_LEVEL_ID);



CREATE TABLE KEDWARDS.CA_PRODUCT_GROUP
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_DESC CHARACTER VARYING(60),
	CA_PRODUCT_GROUP_DESC2 CHARACTER VARYING(60),
	CA_PRODUCT_GROUP_DESC3 CHARACTER VARYING(60),
	CA_PRODUCT_GROUP_LONG_DESC CHARACTER VARYING(250),
	CA_PRODUCT_GROUP_TYPE_ID BYTEINT,
	ALT_HIERARCHY_IND BYTEINT,
	ALT_XREF_CA_PRODUCT_GROUP_ID INTEGER,
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP,
	UPDATE_USER_ID CHARACTER VARYING(50),
	UPDATE_TSTMP TIMESTAMP,
	RETIRE_IND BYTEINT,
	RETIRE_USER_ID CHARACTER VARYING(50),
	RETIRE_TSTMP TIMESTAMP,
	CA_PRODUCT_GROUP_CATEGORY_ID INTEGER,
	SAP_CATEGORY_ID INTEGER,
	SAP_CATEGORY_DESC CHARACTER VARYING(60),
	CA_PRODUCT_GROUP_CLASS_ID INTEGER,
	SAP_CLASS_ID INTEGER,
	SAP_CLASS_DESC CHARACTER VARYING(60),
	CA_PRODUCT_GROUP_DEPT_ID INTEGER,
	SAP_DEPT_ID INTEGER,
	SAP_DEPT_DESC CHARACTER VARYING(60),
	CA_PRODUCT_GROUP_DIVISION_ID INTEGER,
	SAP_DIVISION_ID INTEGER,
	SAP_DIVISION_DESC CHARACTER VARYING(60),
	CA_PRODUCT_GROUP_VP_ID INTEGER,
	VP_ID INTEGER,
	VP_DESC CHARACTER VARYING(60),
	CUBE_BLN_01 BYTEINT,
	CUBE_BLN_02 BYTEINT,
	CUBE_BLN_03 BYTEINT,
	CUBE_BLN_04 BYTEINT,
	CUBE_BLN_05 BYTEINT,
	CUBE_BLN_06 BYTEINT,
	CUBE_BLN_07 BYTEINT,
	CUBE_BLN_08 BYTEINT,
	CUBE_BLN_09 BYTEINT,
	CUBE_BLN_10 BYTEINT,
	CA_SECURITY_FILTER_ID INTEGER,
	CA_SOURCE_SECURITY_FILTER_ID INTEGER,
	CA_MIGRATION_SECURITY_FILTER_ID INTEGER,
	SIZE_ID SMALLINT
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_PRODUCT_GROUP
ADD CONSTRAINT CA_PRODUCT_GROUP_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID);



CREATE TABLE KEDWARDS.CA_PRODUCT_GROUP_BRAND
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_TYPE_ID INTEGER,
	SAP_ID INTEGER,
	SAP_DESC CHARACTER VARYING(40),
	BRAND_CD_GROUPING CHARACTER VARYING(5),
	BRAND_NAME CHARACTER VARYING(30),
	RETIRE_IND BYTEINT
)
DISTRIBUTE ON (CA_PRODUCT_GROUP_ID);

ALTER TABLE KEDWARDS.CA_PRODUCT_GROUP_BRAND
ADD CONSTRAINT CA_PRODUCT_GROUP_BRAND_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID);



CREATE TABLE KEDWARDS.CA_PRODUCT_GROUP_BRAND_EXCL
(
	CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	VP_ID INTEGER,
	SAP_DIVISION_ID INTEGER,
	SAP_DEPT_ID INTEGER,
	SAP_CLASS_ID INTEGER,
	SAP_CATEGORY_ID INTEGER
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_PRODUCT_GROUP_BRAND_INCL
(
	CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	BRAND_CD CHARACTER VARYING(4) NOT NULL,
	MIN_SAP_LEVEL_SALES_PCT NUMERIC(12,6) NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_PRODUCT_GROUP_BRAND_INCL
ADD CONSTRAINT CA_PRODUCT_GROUP_BRAND_INCL_PK
PRIMARY KEY (CA_PRODUCT_GROUP_TYPE_ID, BRAND_CD);



CREATE TABLE KEDWARDS.CA_PRODUCT_GROUP_BRAND_PRE
(
	CA_PRODUCT_GROUP_TYPE_ID INTEGER,
	SAP_ID INTEGER,
	SAP_DESC CHARACTER VARYING(40),
	BRAND_CD CHARACTER VARYING(4),
	BRAND_NAME CHARACTER VARYING(30),
	SAP_LEVEL_BRAND_SALES NUMERIC(14,2),
	SAP_LEVEL_SALES NUMERIC(14,2),
	SAP_LEVEL_SALES_PCT NUMERIC(12,6),
	SAP_LEVEL_RUNNING_SALES NUMERIC(14,2),
	SAP_LEVEL_RUNNING_SALES_PCT NUMERIC(12,6)
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_PRODUCT_GROUP_BRAND_PRE2
(
	CA_PRODUCT_GROUP_TYPE_ID INTEGER,
	SAP_ID INTEGER,
	SAP_DESC CHARACTER VARYING(40),
	BRAND_CD CHARACTER VARYING(4),
	BRAND_NAME CHARACTER VARYING(30),
	SAP_LEVEL_BRAND_SALES NUMERIC(14,2),
	SAP_LEVEL_SALES NUMERIC(14,2),
	SAP_LEVEL_SALES_PCT NUMERIC(12,6),
	SAP_LEVEL_RUNNING_SALES NUMERIC(14,2),
	SAP_LEVEL_RUNNING_SALES_PCT NUMERIC(12,6),
	BRAND_CD_GROUPING CHARACTER VARYING(5)
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_PRODUCT_GROUP_COMPONENT
(
	CA_PRODUCT_GROUP_COMPONENT_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER,
	EXCLUSION_IND BYTEINT,
	SKU_NBR INTEGER,
	SAP_CATEGORY_ID INTEGER,
	SAP_CLASS_ID INTEGER,
	SAP_DEPT_ID INTEGER,
	SAP_DIVISION_ID INTEGER,
	BUYER_ID INTEGER,
	DIRECTOR_ID INTEGER,
	VP_ID INTEGER,
	BRAND_CD CHARACTER VARYING(4),
	BRAND_CLASSIFICATION_ID BYTEINT,
	PRIMARY_VENDOR_ID BIGINT,
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP,
	UPDATE_USER_ID CHARACTER VARYING(50),
	UPDATE_TSTMP TIMESTAMP,
	RETIRE_IND BYTEINT,
	RETIRE_USER_ID CHARACTER VARYING(50),
	RETIRE_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_PRODUCT_GROUP_COMPONENT
ADD CONSTRAINT CA_PRODUCT_GROUP_COMPONENT_PK
PRIMARY KEY (CA_PRODUCT_GROUP_COMPONENT_ID);



CREATE TABLE KEDWARDS.CA_PRODUCT_GROUP_COMPONENT_PRE
(
	CA_PRODUCT_GROUP_COMPONENT_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER,
	EXCLUSION_IND BYTEINT,
	SKU_NBR INTEGER,
	SAP_CATEGORY_ID INTEGER,
	SAP_CLASS_ID INTEGER,
	SAP_DEPT_ID INTEGER,
	SAP_DIVISION_ID INTEGER,
	BUYER_ID INTEGER,
	DIRECTOR_ID INTEGER,
	VP_ID INTEGER,
	BRAND_CD CHARACTER VARYING(4),
	PRIMARY_VENDOR_ID BIGINT,
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP,
	UPDATE_USER_ID CHARACTER VARYING(50),
	UPDATE_TSTMP TIMESTAMP,
	RETIRE_IND BYTEINT,
	RETIRE_USER_ID CHARACTER VARYING(50),
	RETIRE_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_PRODUCT_GROUP_COMPONENT_PRE
ADD CONSTRAINT CA_PRODUCT_GROUP_COMPONENT_PRE_PK
PRIMARY KEY (CA_PRODUCT_GROUP_COMPONENT_ID);



CREATE TABLE KEDWARDS.CA_PRODUCT_GROUP_CUSTOM_PRE
(
	CA_PRODUCT_GROUP_COMPONENT_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER,
	CA_PRODUCT_GROUP_DESC CHARACTER VARYING(50),
	CA_PRODUCT_GROUP_LONG_DESC CHARACTER VARYING(250),
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP,
	UPDATE_TSTMP TIMESTAMP,
	RETIRE_TSTMP TIMESTAMP,
	RETIRE_IND BYTEINT,
	EXCLUSION_IND BYTEINT,
	SKU_NBR INTEGER,
	SAP_CATEGORY_ID INTEGER,
	SAP_CLASS_ID INTEGER,
	SAP_DEPT_ID INTEGER,
	SAP_DIVISION_ID INTEGER,
	BUYER_ID INTEGER,
	DIRECTOR_ID INTEGER,
	VP_ID INTEGER,
	BRAND_CD CHARACTER VARYING(4),
	PRIMARY_VENDOR_ID BIGINT,
	CREATE_TSTMP2 TIMESTAMP,
	UPDATE_TSTMP2 TIMESTAMP,
	RETIRE_TSTMP2 TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_PRODUCT_GROUP_CUSTOM_PRE
ADD CONSTRAINT CA_PRODUCT_GROUP_CUSTOM_PRE_PK
PRIMARY KEY (CA_PRODUCT_GROUP_COMPONENT_ID);



CREATE TABLE KEDWARDS.CA_PRODUCT_GROUP_PARENT
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	PARENT_CA_PRODUCT_GROUP_TYPE_ID INTEGER NOT NULL,
	PARENT_CA_PRODUCT_GROUP_ID INTEGER,
	PARENT_HIERARCHY_ID INTEGER,
	PARENT_HIERARCHY_DESC CHARACTER VARYING(60)
)
DISTRIBUTE ON (CA_PRODUCT_GROUP_ID);

ALTER TABLE KEDWARDS.CA_PRODUCT_GROUP_PARENT
ADD CONSTRAINT CA_PRODUCT_GROUP_PARENT_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID, PARENT_CA_PRODUCT_GROUP_TYPE_ID);



CREATE TABLE KEDWARDS.CA_PRODUCT_GROUP_SIZE
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_TYPE_ID INTEGER NOT NULL,
	SAP_ID INTEGER NOT NULL,
	SAP_DESC CHARACTER VARYING(40) NOT NULL,
	SIZE_ID SMALLINT NOT NULL,
	SIZE_NAME CHARACTER VARYING(25) NOT NULL,
	RETIRE_IND BYTEINT NOT NULL
)
DISTRIBUTE ON (CA_PRODUCT_GROUP_ID);

ALTER TABLE KEDWARDS.CA_PRODUCT_GROUP_SIZE
ADD CONSTRAINT CA_PRODUCT_GROUP_SIZE_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID);



CREATE TABLE KEDWARDS.CA_PRODUCT_GROUP_SKU
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_DESC CHARACTER VARYING(60),
	CA_PRODUCT_GROUP_TYPE_ID BYTEINT,
	CA_PRODUCT_GROUP_TYPE_DESC CHARACTER VARYING(50),
	PRODUCT_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_CATEGORY_ID INTEGER,
	SAP_CATEGORY_ID INTEGER,
	SAP_CATEGORY_DESC CHARACTER VARYING(60),
	CA_PRODUCT_GROUP_CLASS_ID INTEGER,
	SAP_CLASS_ID INTEGER,
	SAP_CLASS_DESC CHARACTER VARYING(60),
	CA_PRODUCT_GROUP_DEPT_ID INTEGER,
	SAP_DEPT_ID INTEGER,
	SAP_DEPT_DESC CHARACTER VARYING(60),
	CA_PRODUCT_GROUP_DIVISION_ID INTEGER,
	SAP_DIVISION_ID INTEGER,
	SAP_DIVISION_DESC CHARACTER VARYING(60),
	CA_PRODUCT_GROUP_VP_ID INTEGER,
	VP_ID INTEGER,
	VP_DESC CHARACTER VARYING(60),
	RETIRE_IND BYTEINT
)
DISTRIBUTE ON (PRODUCT_ID);

ALTER TABLE KEDWARDS.CA_PRODUCT_GROUP_SKU
ADD CONSTRAINT CA_PRODUCT_GROUP_SKU_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID, PRODUCT_ID);



CREATE TABLE KEDWARDS.CA_PRODUCT_GROUP_TYPE
(
	CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	CA_PRODUCT_GROUP_TYPE_DESC CHARACTER VARYING(50) NOT NULL,
	CA_PRODUCT_GROUP_TYPE_SET_ID BYTEINT NOT NULL,
	SAP_CATEGORY_ROLLUP_IND BYTEINT NOT NULL,
	SAP_CLASS_ROLLUP_IND BYTEINT NOT NULL,
	SAP_DEPT_ROLLUP_IND BYTEINT NOT NULL,
	SAP_DIVISION_ROLLUP_IND BYTEINT NOT NULL,
	VP_ROLLUP_IND BYTEINT NOT NULL,
	UPDATE_TSTMP TIMESTAMP NOT NULL,
	LOAD_TSTMP TIMESTAMP NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_PRODUCT_GROUP_TYPE
ADD CONSTRAINT CA_PRODUCT_GROUP_TYPE_NEW_PK
PRIMARY KEY (CA_PRODUCT_GROUP_TYPE_ID);



CREATE TABLE KEDWARDS.CA_PRODUCT_GROUP_TYPE_MB_CTRL
(
	BASE_CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	ATTACH_CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	HIGHER_LEVEL_IND INTEGER,
	BRAND_CA_PRODUCT_GROUP_TYPE_ID BYTEINT
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_PRODUCT_GROUP_TYPE_MB_CTRL
ADD CONSTRAINT CA_PRODUCT_GROUP_TYPE_MB_CTRL_NEW_PK1
PRIMARY KEY (BASE_CA_PRODUCT_GROUP_TYPE_ID, ATTACH_CA_PRODUCT_GROUP_TYPE_ID);



CREATE TABLE KEDWARDS.CA_PRODUCT_GROUP_TYPE_SET
(
	CA_PRODUCT_GROUP_TYPE_SET_ID BYTEINT NOT NULL,
	CA_PRODUCT_GROUP_TYPE_SET_DESC CHARACTER VARYING(50) NOT NULL,
	UPDATE_TSTMP TIMESTAMP NOT NULL,
	LOAD_TSTMP TIMESTAMP NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_PRODUCT_GROUP_TYPE_SET
ADD CONSTRAINT CA_PRODUCT_GROUP_TYPE_SET_PK
PRIMARY KEY (CA_PRODUCT_GROUP_TYPE_SET_ID);



CREATE TABLE KEDWARDS.CA_RETENTION_BUCKET
(
	RETENTION_BUCKET_ID INTEGER NOT NULL,
	RETENTION_BUCKET_DESC CHARACTER VARYING(50),
	RETENTION_START_DAY SMALLINT,
	RETENTION_END_DAY SMALLINT,
	UPDATE_TSTMP TIMESTAMP,
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_RETENTION_BUCKET
ADD CONSTRAINT CA_RETENTION_BUCKET_PK
PRIMARY KEY (RETENTION_BUCKET_ID);



CREATE TABLE KEDWARDS.CA_SECURITY_FILTER
(
	CA_SECURITY_FILTER_ID INTEGER NOT NULL,
	CA_SECURITY_FILTER_NAME CHARACTER VARYING(50) NOT NULL,
	CA_SECURITY_FILTER_DESC CHARACTER VARYING(250) NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_SECURITY_FILTER
ADD CONSTRAINT CA_SECURITY_FILTER_PK
PRIMARY KEY (CA_SECURITY_FILTER_ID);



CREATE TABLE KEDWARDS.CA_SIZE_LKUP
(
	SIZE_ID SMALLINT NOT NULL,
	SAP_DEPT_ID INTEGER NOT NULL,
	SIZE_NAME CHARACTER VARYING(25) NOT NULL,
	MEASUREMENT_UNITS CHARACTER VARYING(10) NOT NULL,
	LOWER_BOUND NUMERIC(8,2),
	UPPER_BOUND NUMERIC(8,2),
	SORT_ID BYTEINT NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_SIZE_LKUP
ADD CONSTRAINT CA_SIZE_LKUP_PK2
PRIMARY KEY (SIZE_ID);



CREATE TABLE KEDWARDS.CA_SKU_PROFILE_RPT
(
	PRODUCT_ID INTEGER NOT NULL,
	SKU_NBR INTEGER,
	SKU_DESC CHARACTER VARYING(40),
	SVP_ID INTEGER,
	SVP_DESC CHARACTER VARYING(30),
	VP_ID INTEGER,
	VP_DESC CHARACTER VARYING(30),
	DIRECTOR_ID INTEGER,
	DIRECTOR_DESC CHARACTER VARYING(40),
	CATEGORY_BUYER_ID INTEGER,
	CATEGORY_BUYER_NM CHARACTER VARYING(30),
	SAP_DIVISION_ID INTEGER,
	SAP_DIVISION_DESC CHARACTER VARYING(40),
	ALT_DIVISION_IND BYTEINT,
	SAP_DEPT_ID INTEGER,
	SAP_DEPT_DESC CHARACTER VARYING(40),
	ALT_DEPT_IND BYTEINT,
	SAP_CLASS_ID INTEGER,
	SAP_CLASS_DESC CHARACTER VARYING(40),
	ALT_CLASS_IND BYTEINT,
	SAP_CATEGORY_ID INTEGER,
	SAP_CATEGORY_DESC CHARACTER VARYING(40),
	PRIMARY_VENDOR_ID BIGINT,
	PRIMARY_VENDOR_NAME CHARACTER VARYING(35),
	BRAND_CLASSIFICATION_ID BYTEINT,
	BRAND_CD CHARACTER VARYING(4),
	BRAND_NAME CHARACTER VARYING(30),
	SIZE_ID SMALLINT
)
DISTRIBUTE ON (PRODUCT_ID);

ALTER TABLE KEDWARDS.CA_SKU_PROFILE_RPT
ADD CONSTRAINT CA_SKU_PROFILE_RPT_PK
PRIMARY KEY (PRODUCT_ID);



CREATE TABLE KEDWARDS.CA_STORE_GROUP
(
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CA_STORE_GROUP_DESC CHARACTER VARYING(50),
	CA_STORE_GROUP_DESC2 CHARACTER VARYING(50),
	CA_STORE_GROUP_DESC3 CHARACTER VARYING(50),
	CA_STORE_GROUP_LONG_DESC CHARACTER VARYING(250),
	CA_STORE_GROUP_TYPE_ID BYTEINT,
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP,
	UPDATE_USER_ID CHARACTER VARYING(50),
	UPDATE_TSTMP TIMESTAMP,
	RETIRE_IND BYTEINT,
	RETIRE_USER_ID CHARACTER VARYING(50),
	RETIRE_TSTMP TIMESTAMP
)
DISTRIBUTE ON (CA_STORE_GROUP_ID);

ALTER TABLE KEDWARDS.CA_STORE_GROUP
ADD CONSTRAINT CA_STORE_GROUP_PK
PRIMARY KEY (CA_STORE_GROUP_ID);



CREATE TABLE KEDWARDS.CA_STORE_GROUP_COMPONENT
(
	CA_STORE_GROUP_COMPONENT_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER,
	EXCLUSION_IND BYTEINT,
	LOCATION_TYPE_ID BYTEINT,
	COMPANY_ID INTEGER,
	COUNTRY_CD CHARACTER(3),
	SUPER_REGION_ID BIGINT,
	REGION_ID BIGINT,
	DISTRICT_ID BIGINT,
	STORE_NBR INTEGER,
	PRICE_ZONE_ID CHARACTER(18),
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP,
	UPDATE_USER_ID CHARACTER VARYING(50),
	UPDATE_TSTMP TIMESTAMP,
	RETIRE_IND BYTEINT,
	RETIRE_USER_ID CHARACTER VARYING(50),
	RETIRE_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_STORE_GROUP_COMPONENT
ADD CONSTRAINT CA_STORE_GROUP_COMPONENT_PK
PRIMARY KEY (CA_STORE_GROUP_COMPONENT_ID);



CREATE TABLE KEDWARDS.CA_STORE_GROUP_COMPONENT_PRE
(
	CA_STORE_GROUP_COMPONENT_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER,
	EXCLUSION_IND BYTEINT,
	LOCATION_TYPE_ID BYTEINT,
	COMPANY_ID INTEGER,
	COUNTRY_CD CHARACTER(3),
	SUPER_REGION_ID BIGINT,
	REGION_ID BIGINT,
	DISTRICT_ID BIGINT,
	STORE_NBR INTEGER,
	PRICE_ZONE_ID CHARACTER(18),
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP,
	UPDATE_USER_ID CHARACTER VARYING(50),
	UPDATE_TSTMP TIMESTAMP,
	RETIRE_IND BYTEINT,
	RETIRE_USER_ID CHARACTER VARYING(50),
	RETIRE_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_STORE_GROUP_COMPONENT_PRE
ADD CONSTRAINT CA_STORE_GROUP_COMPONENT_PRE_PK
PRIMARY KEY (CA_STORE_GROUP_COMPONENT_ID);



CREATE TABLE KEDWARDS.CA_STORE_GROUP_CUSTOM_PRE
(
	CA_STORE_GROUP_COMPONENT_ID INTEGER NOT NULL,
	CA_STORE_GROUP_ID INTEGER,
	CA_STORE_GROUP_DESC CHARACTER VARYING(50),
	CA_STORE_GROUP_LONG_DESC CHARACTER VARYING(250),
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP,
	UPDATE_TSTMP TIMESTAMP,
	RETIRE_TSTMP TIMESTAMP,
	RETIRE_IND BYTEINT,
	EXCLUSION_IND BYTEINT,
	LOCATION_TYPE_ID BYTEINT,
	COMPANY_ID INTEGER,
	COUNTRY_CD CHARACTER(3),
	SUPER_REGION_ID BIGINT,
	REGION_ID BIGINT,
	DISTRICT_ID BIGINT,
	STORE_NBR INTEGER,
	PRICE_ZONE_ID CHARACTER(18),
	CREATE_TSTMP2 TIMESTAMP,
	UPDATE_TSTMP2 TIMESTAMP,
	RETIRE_TSTMP2 TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_STORE_GROUP_CUSTOM_PRE
ADD CONSTRAINT CA_STORE_GROUP_CUSTOM_PRE_PK
PRIMARY KEY (CA_STORE_GROUP_COMPONENT_ID);



CREATE TABLE KEDWARDS.CA_STORE_GROUP_TYPE
(
	CA_STORE_GROUP_TYPE_ID BYTEINT NOT NULL,
	CA_STORE_GROUP_TYPE_DESC CHARACTER VARYING(50)
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_STORE_GROUP_TYPE
ADD CONSTRAINT CA_STORE_GROUP_TYPE_PK
PRIMARY KEY (CA_STORE_GROUP_TYPE_ID);



CREATE TABLE KEDWARDS.CA_SUBSQNT_PREV_BASKET
(
	CA_SUBSQNT_PREV_BASKET_ID INTEGER NOT NULL,
	CA_SUBSQNT_PREV_BASKET_DESC CHARACTER VARYING(50) NOT NULL,
	UPDATE_TSTMP TIMESTAMP,
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON (CA_SUBSQNT_PREV_BASKET_ID);

ALTER TABLE KEDWARDS.CA_SUBSQNT_PREV_BASKET
ADD CONSTRAINT CA_SUBSQNT_PREV_BASKET_PK
PRIMARY KEY (CA_SUBSQNT_PREV_BASKET_ID);



CREATE TABLE KEDWARDS.CA_SUBSQNT_PREV_BASKET_TYPE
(
	CA_SUBSQNT_PREV_BASKET_TYPE_ID INTEGER NOT NULL,
	CA_SUBSQNT_PREV_BASKET_TYPE_DESC CHARACTER VARYING(50) NOT NULL,
	UPDATE_TSTMP TIMESTAMP,
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON (CA_SUBSQNT_PREV_BASKET_TYPE_ID);

ALTER TABLE KEDWARDS.CA_SUBSQNT_PREV_BASKET_TYPE
ADD CONSTRAINT CA_SUBSQNT_PREV_BASKET_TYPE_PK
PRIMARY KEY (CA_SUBSQNT_PREV_BASKET_TYPE_ID);



CREATE TABLE KEDWARDS.CA_SYS_PROCESSING_LOG
(
	SYS_JOB CHARACTER VARYING(50),
	START_TSTMP TIMESTAMP,
	END_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_TXN_CUST_TYPE
(
	CA_TXN_CUST_TYPE_ID BYTEINT NOT NULL,
	CA_TXN_CUST_TYPE_DESC CHARACTER VARYING(50) NOT NULL,
	SORT_ID BYTEINT NOT NULL,
	UPDATE_TSTMP TIMESTAMP NOT NULL,
	LOAD_TSTMP TIMESTAMP NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_TXN_CUST_TYPE
ADD CONSTRAINT CA_TXN_CUST_TYPE_PK
PRIMARY KEY (CA_TXN_CUST_TYPE_ID);



CREATE TABLE KEDWARDS.CA_TXN_GROUP
(
	CA_TXN_GROUP_ID INTEGER NOT NULL,
	CA_TXN_GROUP_DESC CHARACTER VARYING(50),
	CA_TXN_GROUP_DESC2 CHARACTER VARYING(50),
	CA_TXN_GROUP_DESC3 CHARACTER VARYING(50),
	CA_TXN_GROUP_LONG_DESC CHARACTER VARYING(250),
	CA_TXN_GROUP_TYPE_ID BYTEINT,
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP,
	UPDATE_USER_ID CHARACTER VARYING(50),
	UPDATE_TSTMP TIMESTAMP,
	RETIRE_IND BYTEINT,
	RETIRE_USER_ID CHARACTER VARYING(50),
	RETIRE_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_TXN_GROUP
ADD CONSTRAINT CA_TXN_GROUP_PK
PRIMARY KEY (CA_TXN_GROUP_ID);



CREATE TABLE KEDWARDS.CA_TXN_GROUP_COHORT
(
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_DESC CHARACTER VARYING(50),
	CA_TXN_GROUP_COHORT_DESC2 CHARACTER VARYING(50),
	CA_TXN_GROUP_COHORT_DESC3 CHARACTER VARYING(50),
	CA_TXN_GROUP_COHORT_LONG_DESC CHARACTER VARYING(250),
	CA_TXN_GROUP_ID INTEGER,
	TXN_CNT INTEGER,
	CA_TXN_LIST CHARACTER VARYING(100),
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP,
	UPDATE_USER_ID CHARACTER VARYING(50),
	UPDATE_TSTMP TIMESTAMP,
	RETIRE_IND BYTEINT,
	RETIRE_USER_ID CHARACTER VARYING(50),
	RETIRE_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_TXN_GROUP_COHORT
ADD CONSTRAINT CA_TXN_GROUP_COHORT_NEW_PK
PRIMARY KEY (CA_TXN_GROUP_COHORT_ID);



CREATE TABLE KEDWARDS.CA_TXN_GROUP_COHORT_COMPONENT
(
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	SALES_INSTANCE_ID BIGINT,
	ORDER_CHANNEL CHARACTER VARYING(4)
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.CA_TXN_GROUP_CUSTOM_PRE
(
	CA_TXN_GROUP_ID INTEGER NOT NULL,
	CA_TXN_GROUP_DESC CHARACTER VARYING(50),
	CA_TXN_LIST CHARACTER VARYING(100),
	CREATE_USER_ID CHARACTER VARYING(50),
	CREATE_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_TXN_GROUP_CUSTOM_PRE
ADD CONSTRAINT CA_TXN_GROUP_CUSTOM_PRE_PK
PRIMARY KEY (CA_TXN_GROUP_ID);



CREATE TABLE KEDWARDS.CA_TXN_GROUP_TYPE
(
	CA_TXN_GROUP_TYPE_ID BYTEINT NOT NULL,
	CA_TXN_GROUP_TYPE_DESC CHARACTER VARYING(50)
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CA_TXN_GROUP_TYPE
ADD CONSTRAINT CA_TXN_GROUP_TYPE_PK
PRIMARY KEY (CA_TXN_GROUP_TYPE_ID);



CREATE TABLE KEDWARDS.CA_WFALL_METRIC
(
	CA_WFALL_METRIC_ID INTEGER NOT NULL,
	CA_WFALL_METRIC_DESC NATIONAL CHARACTER VARYING(50),
	CA_WFALL_METRIC_LONG_DESC NATIONAL CHARACTER VARYING(100),
	SORT_ID INTEGER
)
DISTRIBUTE ON (CA_WFALL_METRIC_ID);

ALTER TABLE KEDWARDS.CA_WFALL_METRIC
ADD CONSTRAINT CA_WFALL_METRIC_PK
PRIMARY KEY (CA_WFALL_METRIC_ID);



CREATE TABLE KEDWARDS.CUST_TYPE_COMPANY_LEVEL_LKUP
(
	CUST_TYPE_COMPANY_LEVEL INTEGER NOT NULL,
	CUST_TYPE_COMPANY_LEVEL_DESC CHARACTER VARYING(50),
	CUST_TYPE_COMPANY_LEVEL_PARENT INTEGER NOT NULL,
	CUST_TYPE_COMPANY_LEVEL_PARENT_DESC CHARACTER VARYING(50),
	UPDATE_TSTMP TIMESTAMP,
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CUST_TYPE_COMPANY_LEVEL_LKUP
ADD CONSTRAINT CUST_TYPE_COMPANY_LEVEL_LKUP_PK1
PRIMARY KEY (CUST_TYPE_COMPANY_LEVEL);



CREATE TABLE KEDWARDS.CUST_TYPE_LEVEL
(
	CUST_TYPE_LEVEL_ID INTEGER NOT NULL,
	CUST_TYPE_LEVEL_DESC CHARACTER VARYING(50)
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CUST_TYPE_LEVEL
ADD CONSTRAINT CUST_TYPE_LEVEL_PK
PRIMARY KEY (CUST_TYPE_LEVEL_ID);



CREATE TABLE KEDWARDS.CUST_TYPE_LKUP
(
	CUST_TYPE INTEGER NOT NULL,
	CUST_TYPE_DESC CHARACTER VARYING(50),
	CUST_TYPE_PARENT INTEGER NOT NULL,
	CUST_TYPE_PARENT_DESC CHARACTER VARYING(50),
	UPDATE_TSTMP TIMESTAMP,
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CUST_TYPE_LKUP
ADD CONSTRAINT CUST_TYPE_LKUP_PK1
PRIMARY KEY (CUST_TYPE);



CREATE TABLE KEDWARDS.CUST_WORKFLOW_RUN_DAYS
(
	DAY_OF_WK_NAME CHARACTER(9) NOT NULL,
	WORKFLOW_RUN_IND BYTEINT NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.CUST_WORKFLOW_RUN_DAYS
ADD CONSTRAINT CUST_WORKFLOW_RUN_DAYS_PK
PRIMARY KEY (DAY_OF_WK_NAME);



CREATE TABLE KEDWARDS.DEMO_PRE
(
	CUSTOMER_EID NATIONAL CHARACTER VARYING(100),
	MEDIA_USAGE_PROPENSITIES NATIONAL CHARACTER VARYING(100),
	SOCIALLY_INFLUENCED NATIONAL CHARACTER VARYING(100),
	GENDER NATIONAL CHARACTER VARYING(100),
	AGE_TWO_YEAR_INCREMENTS NATIONAL CHARACTER VARYING(100),
	EDUCATION NATIONAL CHARACTER VARYING(100),
	TECHNOLOGY_ATTITUDES NATIONAL CHARACTER VARYING(100),
	RACE_CODE NATIONAL CHARACTER VARYING(100),
	GENERATIONS_IN_HOUSEHOLD NATIONAL CHARACTER VARYING(100),
	WORKING_WOMAN NATIONAL CHARACTER VARYING(100),
	MALES_18_TO_24 NATIONAL CHARACTER VARYING(100),
	FEMALES_18_TO_24 NATIONAL CHARACTER VARYING(100),
	UNKNOWN_GENDER_18_TO_24 NATIONAL CHARACTER VARYING(100),
	MALES_25_TO_34 NATIONAL CHARACTER VARYING(100),
	FEMALES_25_TO_34 NATIONAL CHARACTER VARYING(100),
	UNKNOWN_GENDER_25_TO_34 NATIONAL CHARACTER VARYING(100),
	MALES_35_TO_44 NATIONAL CHARACTER VARYING(100),
	FEMALES_35_TO_44 NATIONAL CHARACTER VARYING(100),
	UNKNOWN_GENDER_35_TO_44 NATIONAL CHARACTER VARYING(100),
	MALES_45_TO_54 NATIONAL CHARACTER VARYING(100),
	FEMALES_45_TO_54 NATIONAL CHARACTER VARYING(100),
	UNKNOWN_GENDER_45_TO_54 NATIONAL CHARACTER VARYING(100),
	MALES_55_TO_64 NATIONAL CHARACTER VARYING(100),
	FEMALES_55_TO_64 NATIONAL CHARACTER VARYING(100),
	UNKNOWN_GENDER_55_TO_64 NATIONAL CHARACTER VARYING(100),
	MALES_65_TO_74 NATIONAL CHARACTER VARYING(100),
	FEMALES_65_TO_74 NATIONAL CHARACTER VARYING(100),
	UNKNOWN_GENDER_65_TO_74 NATIONAL CHARACTER VARYING(100),
	MALES_75_PLUS NATIONAL CHARACTER VARYING(100),
	FEMALES_75_PLUS NATIONAL CHARACTER VARYING(100),
	UNKNOWN_GENDER_75_PLUS NATIONAL CHARACTER VARYING(100),
	ADULT_AGE_RANGE_MATCH_INDICATOR NATIONAL CHARACTER VARYING(100),
	ADULTS_IN_HOUSEHOLD NATIONAL CHARACTER VARYING(100),
	ADULTS_IN_HOUSEHOLD_MATCH_INDICATOR NATIONAL CHARACTER VARYING(100),
	HOUSEHOLD_SIZE NATIONAL CHARACTER VARYING(100),
	HOUSEHOLD_SIZE_MATCH_INDICATOR NATIONAL CHARACTER VARYING(100),
	MARITAL_HOUSEHOLD_MATCH_INDICATOR NATIONAL CHARACTER VARYING(100),
	MARITAL_HOUSEHOLD NATIONAL CHARACTER VARYING(100),
	MALES_00_TO_02 NATIONAL CHARACTER VARYING(100),
	FEMALES_00_TO_02 NATIONAL CHARACTER VARYING(100),
	UNKNOWN_GENDER_00_TO_02 NATIONAL CHARACTER VARYING(100),
	MALES_03_TO_05 NATIONAL CHARACTER VARYING(100),
	FEMALES_03_TO_05 NATIONAL CHARACTER VARYING(100),
	UNKNOWN_GENDER_03_TO_05 NATIONAL CHARACTER VARYING(100),
	MALES_06_TO_10 NATIONAL CHARACTER VARYING(100),
	FEMALES_06_TO_10 NATIONAL CHARACTER VARYING(100),
	UNKNOWN_GENDER_06_TO_10 NATIONAL CHARACTER VARYING(100),
	MALES_11_TO_15 NATIONAL CHARACTER VARYING(100),
	FEMALES_11_TO_15 NATIONAL CHARACTER VARYING(100),
	UNKNOWN_GENDER_11_TO_15 NATIONAL CHARACTER VARYING(100),
	MALES_16_TO_17 NATIONAL CHARACTER VARYING(100),
	FEMALES_16_TO_17 NATIONAL CHARACTER VARYING(100),
	UNKNOWN_GENDER_16_TO_17 NATIONAL CHARACTER VARYING(100),
	CHILDRENS_AGE_MATCH_INDICATOR NATIONAL CHARACTER VARYING(100),
	NUMBER_OF_CHILDREN_IN_HOUSEHOLD NATIONAL CHARACTER VARYING(100),
	HOUSEHOLD_INCOME_MATCH_INDICATOR NATIONAL CHARACTER VARYING(100),
	ESTIMATED_HOUSEHOLD_INCOME_IN_DOLLARS NATIONAL CHARACTER VARYING(100),
	PURCHASE_0_TO_3_MONTHS NATIONAL CHARACTER VARYING(100),
	PURCHASE_4_TO_6_MONTHS NATIONAL CHARACTER VARYING(100),
	PURCHASE_7_TO_9_MONTHS NATIONAL CHARACTER VARYING(100),
	PURCHASE_10_TO_12_MONTHS NATIONAL CHARACTER VARYING(100),
	PURCHASE_13_TO_18_MONTHS NATIONAL CHARACTER VARYING(100),
	PURCHASE_19_TO_24_MONTHS NATIONAL CHARACTER VARYING(100),
	PURCHASE_24_PLUS_MONTHS NATIONAL CHARACTER VARYING(100),
	COOKING_FOOD_GROUPING NATIONAL CHARACTER VARYING(100),
	EXERCISE_HEALTH_GROUPING NATIONAL CHARACTER VARYING(100),
	HOME_IMPROVEMENT_GROUPING NATIONAL CHARACTER VARYING(100),
	OUTDOORS_GROUPING NATIONAL CHARACTER VARYING(100),
	SPORTS_GROUPING NATIONAL CHARACTER VARYING(100),
	TRAVEL_GROUPING NATIONAL CHARACTER VARYING(100),
	DONATE_TO_CHARITABLE_CAUSES NATIONAL CHARACTER VARYING(100),
	ANIMAL_WELFARE NATIONAL CHARACTER VARYING(100),
	ARTS_OR_CULTURE NATIONAL CHARACTER VARYING(100),
	CHILDRENS NATIONAL CHARACTER VARYING(100),
	ENVIRONMENT_OR_WILDLIFE NATIONAL CHARACTER VARYING(100),
	HEALTH NATIONAL CHARACTER VARYING(100),
	INTERNATIONAL_AID NATIONAL CHARACTER VARYING(100),
	POLITICAL NATIONAL CHARACTER VARYING(100),
	POLITICAL_CONSERVATIVE NATIONAL CHARACTER VARYING(100),
	POLITICAL_LIBERAL NATIONAL CHARACTER VARYING(100),
	RELIGIOUS NATIONAL CHARACTER VARYING(100),
	VETERANS NATIONAL CHARACTER VARYING(100),
	OTHER NATIONAL CHARACTER VARYING(100),
	ONLINE_PURCHASING_INDICATOR NATIONAL CHARACTER VARYING(100),
	FOODS_NATURAL NATIONAL CHARACTER VARYING(100),
	GARDENING NATIONAL CHARACTER VARYING(100),
	ONLINE_DOLLARS_RNG NATIONAL CHARACTER VARYING(100),
	MAIL_ORDER_RESPONDER NATIONAL CHARACTER VARYING(100),
	MEDIAL_CHANNEL NATIONAL CHARACTER VARYING(100),
	AD_VIEWING NATIONAL CHARACTER VARYING(100),
	SHOPPING_CHANNEL_PROPENSITIES NATIONAL CHARACTER VARYING(100),
	LIKELIHOOD_OF_PET_PRODUCTS_PURCHASED_IN_GROCERY_STORE_OR_SUPERMARKET NATIONAL CHARACTER VARYING(100),
	LIKELIHOOD_OF_PET_PRODUCTS_PURCHASED_ONLINE NATIONAL CHARACTER VARYING(100),
	LIKELIHOOD_OF_PET_PRODUCTS_PURCHASED_AT_PETCO NATIONAL CHARACTER VARYING(100),
	LIKELIHOOD_OF_PET_PRODUCTS_PURCHASED_AT_VETERINARIAN NATIONAL CHARACTER VARYING(100),
	HEAVY_TRANSACTORS NATIONAL CHARACTER VARYING(100),
	CONSUME_MEDIA_VIA_CELL_PHONE NATIONAL CHARACTER VARYING(100),
	CONSUME_MEDIA_VIA_DAYTIME_TV NATIONAL CHARACTER VARYING(100),
	CONSUME_MEDIA_VIA_INTERNET NATIONAL CHARACTER VARYING(100),
	CONSUME_MEDIA_VIA_MAGAZINE NATIONAL CHARACTER VARYING(100),
	CONSUME_MEDIA_VIA_OUTDOOR_ADVERTISING NATIONAL CHARACTER VARYING(100),
	CONSUME_MEDIA_VIA_PRIMETIME_TV NATIONAL CHARACTER VARYING(100),
	NET_WORTH_GOLD_IN_DOLLARS NATIONAL CHARACTER VARYING(100),
	DISCRETIONARY_SPENDING_DOLLARS NATIONAL CHARACTER VARYING(100),
	DISCRETIONARY_SPENDING_DOLLARS_PRECISION_LEVEL NATIONAL CHARACTER VARYING(100),
	POPULATION_DENSITY NATIONAL CHARACTER VARYING(100),
	POPULATION_DENSITY_PRECISION_LEVEL NATIONAL CHARACTER VARYING(100),
	HOME_PROPERTY_TYPE NATIONAL CHARACTER VARYING(100),
	ESTIMATED_HOME_MARKET_VALUE_IN_DOLLARS NATIONAL CHARACTER VARYING(100),
	LENGTH_OF_RESIDENCE NATIONAL CHARACTER VARYING(100),
	LENGTH_OF_RESIDENCE_MATCH_INDICATOR NATIONAL CHARACTER VARYING(100),
	HOME_OWNER_OR_RENTER NATIONAL CHARACTER VARYING(100),
	HOME_OWNER_OR_RENTER_MATCH_INDICATOR NATIONAL CHARACTER VARYING(100)
)
DISTRIBUTE ON (CUSTOMER_EID);


CREATE TABLE KEDWARDS.DM_CA_PG_SECURITY_FILTER_PRE
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_SECURITY_FILTER_ID INTEGER,
	CA_SECURITY_FILTER_NAME CHARACTER VARYING(50),
	CA_SECURITY_FILTER_DESC CHARACTER VARYING(250),
	CA_SOURCE_SECURITY_FILTER_ID INTEGER,
	CA_SOURCE_SECURITY_FILTER_NAME CHARACTER VARYING(50),
	CA_SOURCE_SECURITY_FILTER_DESC CHARACTER VARYING(250),
	CA_MIGRATION_SECURITY_FILTER_ID INTEGER,
	CA_MIGRATION_SECURITY_FILTER_NAME CHARACTER VARYING(50),
	CA_MIGRATION_SECURITY_FILTER_DESC CHARACTER VARYING(250)
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.DM_CA_PG_SECURITY_FILTER_PRE
ADD CONSTRAINT DM_CA_PG_SECURITY_FILTER_PRE_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID);



CREATE TABLE KEDWARDS.IMP_QW_DEMO_FINAL_PETM
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER,
	CUSTOMER_SEGMENT_SPECIES_GRP_CD CHARACTER VARYING(5),
	CUSTOMER_SEGMENT_SPECIES_GRP_NAME CHARACTER VARYING(50),
	CUST_TYPE_GROUP_ID INTEGER,
	CUST_TYPE_GROUP_DESC CHARACTER VARYING(16),
	DEMO_TYPE_ID INTEGER,
	DEMO_TYPE_DESC CHARACTER VARYING(50),
	DEMO_ID INTEGER,
	DEMO_DESC CHARACTER VARYING(50),
	DEMO_VALUE_ID INTEGER,
	DEMO_VALUE_DESC CHARACTER VARYING(25),
	CUST_CNT NUMERIC(38,0),
	RETAINED_CUST_CNT NUMERIC(38,0),
	TXNS NUMERIC(38,0),
	SLS NUMERIC(38,8),
	MGN NUMERIC(38,9),
	CUST_CNT_LY NUMERIC(38,0),
	RETAINED_CUST_CNT_LY NUMERIC(38,0),
	TXNS_LY NUMERIC(38,0),
	SLS_LY NUMERIC(38,8),
	MGN_LY NUMERIC(38,9)
)
DISTRIBUTE ON (DEMO_VALUE_ID, CA_PRODUCT_GROUP_ID, DEMO_VALUE_DESC, DEMO_ID);


CREATE TABLE KEDWARDS.MP_BTO_FILE
(
	MRKT NATIONAL CHARACTER VARYING(50) NOT NULL,
	BGRP NATIONAL CHARACTER VARYING(50) NOT NULL,
	OUTL NATIONAL CHARACTER VARYING(50) NOT NULL,
	DEMOS NATIONAL CHARACTER VARYING(50) NOT NULL,
	PROD NATIONAL CHARACTER VARYING(50) NOT NULL,
	PER NATIONAL CHARACTER VARYING(50) NOT NULL,
	DOLLARS NUMERIC(15,6) NOT NULL,
	BUYING_HH NUMERIC(12,6) NOT NULL,
	RAW_BUYERS INTEGER NOT NULL
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.MP_BTO_PRE
(
	MRKT CHARACTER VARYING(50) NOT NULL,
	BGRP CHARACTER VARYING(50) NOT NULL,
	OUTL CHARACTER VARYING(50) NOT NULL,
	DEMOS CHARACTER VARYING(50) NOT NULL,
	PROD CHARACTER VARYING(50) NOT NULL,
	PER CHARACTER VARYING(50) NOT NULL,
	DOLLARS NUMERIC(15,6) NOT NULL,
	BUYING_HH NUMERIC(12,6) NOT NULL,
	RAW_BUYERS INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.MP_BUYER_GROUP
(
	MP_BUYER_GROUP_ID INTEGER NOT NULL,
	MP_BUYER_GROUP_DESC CHARACTER VARYING(50) NOT NULL,
	NIELSEN_BGRP CHARACTER VARYING(50) NOT NULL,
	UPDATE_TSTMP TIMESTAMP NOT NULL,
	LOAD_TSTMP TIMESTAMP NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.MP_BUYER_GROUP
ADD CONSTRAINT MP_BUYER_GROUP_PK
PRIMARY KEY (MP_BUYER_GROUP_ID);



CREATE TABLE KEDWARDS.MP_CHANNEL
(
	MP_CHANNEL_TYPE_ID INTEGER NOT NULL,
	MP_CHANNEL_TYPE_DESC CHARACTER VARYING(50) NOT NULL,
	MP_CHANNEL_AGG_ID INTEGER NOT NULL,
	MP_CHANNEL_AGG_DESC CHARACTER VARYING(50) NOT NULL,
	MP_CHANNEL_ID INTEGER NOT NULL,
	MP_CHANNEL_DESC CHARACTER VARYING(50) NOT NULL,
	MP_CHANNEL_SHORT_DESC CHARACTER VARYING(15) NOT NULL,
	NIELSEN_OUTL CHARACTER VARYING(50),
	UPDATE_TSTMP TIMESTAMP NOT NULL,
	LOAD_TSTMP TIMESTAMP NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.MP_CHANNEL
ADD CONSTRAINT MP_CHANNEL_PK
PRIMARY KEY (MP_CHANNEL_ID);



CREATE TABLE KEDWARDS.MP_LEAKAGE
(
	MP_SOURCE_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	MP_CHANNEL_ID INTEGER NOT NULL,
	MP_LEAKAGE_METRIC_ID INTEGER NOT NULL,
	HH_TY NUMERIC(15,3) NOT NULL,
	HH_LY NUMERIC(15,3) NOT NULL,
	TRIPS_TY NUMERIC(15,3) NOT NULL,
	TRIPS_LY NUMERIC(15,3) NOT NULL,
	DOLLARS_TY NUMERIC(15,3) NOT NULL,
	DOLLARS_LY NUMERIC(15,3) NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.MP_LEAKAGE
ADD CONSTRAINT MP_LEAKAGE_PK
PRIMARY KEY (MP_SOURCE_ID, CA_PRODUCT_GROUP_ID, CA_DATE_GROUP_ID, MP_CHANNEL_ID, MP_LEAKAGE_METRIC_ID);



CREATE TABLE KEDWARDS.MP_LEAKAGE_FILE_HIST
(
	LOAD_TSTMP TIMESTAMP NOT NULL,
	MP_LEAKAGE_METRIC_ID INTEGER NOT NULL,
	OUTL CHARACTER VARYING(50) NOT NULL,
	PROD CHARACTER VARYING(50) NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	HH_TY NUMERIC(15,3),
	HH_LY NUMERIC(15,3),
	TRIPS_TY NUMERIC(15,3),
	TRIPS_LY NUMERIC(15,3),
	DOLLARS_TY NUMERIC(15,3),
	DOLLARS_LY NUMERIC(15,3)
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.MP_LEAKAGE_FILE_HIST
ADD CONSTRAINT MP_LEAKAGE_FILE_HIST_PK
PRIMARY KEY (LOAD_TSTMP, MP_LEAKAGE_METRIC_ID, OUTL, PROD, CA_DATE_GROUP_ID);



CREATE TABLE KEDWARDS.MP_LEAKAGE_PRE
(
	MP_LEAKAGE_METRIC_ID INTEGER NOT NULL,
	OUTL CHARACTER VARYING(50) NOT NULL,
	PROD CHARACTER VARYING(50) NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	HH_TY NUMERIC(15,3),
	HH_LY NUMERIC(15,3),
	TRIPS_TY NUMERIC(15,3),
	TRIPS_LY NUMERIC(15,3),
	DOLLARS_TY NUMERIC(15,3),
	DOLLARS_LY NUMERIC(15,3)
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.MP_LEAKAGE_PRE
ADD CONSTRAINT MP_LEAKAGE_PRE_PK
PRIMARY KEY (MP_LEAKAGE_METRIC_ID, OUTL, PROD, CA_DATE_GROUP_ID);



CREATE TABLE KEDWARDS.MP_MARKETSHARE
(
	MP_SOURCE_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	MP_CHANNEL_ID INTEGER NOT NULL,
	SALES_LY NUMERIC(14,2),
	SALES_TY NUMERIC(14,2),
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.MP_MARKETSHARE
ADD CONSTRAINT MP_MARKETSHARE_PK
PRIMARY KEY (MP_SOURCE_ID, CA_DATE_GROUP_ID, CA_PRODUCT_GROUP_ID, MP_CHANNEL_ID);



CREATE TABLE KEDWARDS.MP_MARKETSHARE_FILE
(
	MP_SOURCE_ID BYTEINT NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	MP_CHANNEL_ID SMALLINT NOT NULL,
	SALES_LY NUMERIC(14,2),
	SALES_TY NUMERIC(14,2)
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.MP_MARKETSHARE_FILE_HIST
(
	LOAD_TSTMP TIMESTAMP NOT NULL,
	MP_SOURCE_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	MP_CHANNEL_ID INTEGER NOT NULL,
	SALES_LY NUMERIC(14,2),
	SALES_TY NUMERIC(14,2)
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.MP_MARKETSHARE_FILE_HIST
ADD CONSTRAINT MP_MARKETSHARE_FILE_HIST_PK
PRIMARY KEY (MP_SOURCE_ID, CA_DATE_GROUP_ID, CA_PRODUCT_GROUP_ID, MP_CHANNEL_ID);



CREATE TABLE KEDWARDS.MP_MARKETSHARE_PRE
(
	MP_SOURCE_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	MP_CHANNEL_ID INTEGER NOT NULL,
	SALES_LY NUMERIC(14,2),
	SALES_TY NUMERIC(14,2)
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.MP_MARKETSHARE_PRE
ADD CONSTRAINT MP_MARKETSHARE_PRE_PK
PRIMARY KEY (MP_SOURCE_ID, CA_DATE_GROUP_ID, CA_PRODUCT_GROUP_ID, MP_CHANNEL_ID);



CREATE TABLE KEDWARDS.MP_NLR
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	CHANNEL_TOTAL_HH_LY NUMERIC(12,6),
	CHANNEL_TOTAL_HH_TY NUMERIC(12,6),
	CHANNEL_LOST_HH NUMERIC(12,6),
	CHANNEL_RETAINED_HH NUMERIC(12,6),
	CHANNEL_NEW_HH NUMERIC(12,6),
	CHANNEL_LOST_HH_PANEL_BASE NUMERIC(12,6),
	CHANNEL_LOST_HH_PANEL_TY NUMERIC(12,6),
	CHANNEL_NEW_HH_PANEL_BASE NUMERIC(12,6),
	CHANNEL_NEW_HH_PANEL_TY NUMERIC(12,6),
	CHANNEL_TOTAL_DOLLARS_LY NUMERIC(15,6),
	CHANNEL_TOTAL_DOLLARS_TY NUMERIC(15,6),
	CHANNEL_LOST_DOLLARS NUMERIC(15,6),
	CHANNEL_RETAINED_DOLLARS NUMERIC(15,6),
	CHANNEL_NEW_DOLLARS NUMERIC(15,6),
	CHANNEL_LOST_DOLLARS_PANEL_BASE NUMERIC(15,6),
	CHANNEL_LOST_DOLLARS_PANEL_TY NUMERIC(15,6),
	CHANNEL_NEW_DOLLARS_PANEL_BASE NUMERIC(15,6),
	CHANNEL_NEW_DOLLARS_PANEL_TY NUMERIC(15,6),
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.MP_NLR
ADD CONSTRAINT MP_NLR_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID, CA_DATE_GROUP_ID);



CREATE TABLE KEDWARDS.MP_NLR_FILE_HIST
(
	LOAD_TSTMP TIMESTAMP NOT NULL,
	MP_SOURCE_ID INTEGER NOT NULL,
	MRKT CHARACTER VARYING(50) NOT NULL,
	BGRP CHARACTER VARYING(50) NOT NULL,
	OUTL CHARACTER VARYING(50) NOT NULL,
	DEMOS CHARACTER VARYING(50) NOT NULL,
	PROD CHARACTER VARYING(50) NOT NULL,
	PER CHARACTER VARYING(50) NOT NULL,
	DOLLARS NUMERIC(15,6) NOT NULL,
	BUYING_HH NUMERIC(12,6) NOT NULL,
	RAW_BUYERS INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.MP_NLR_METRIC
(
	MP_NLR_METRIC_ID INTEGER NOT NULL,
	MP_NLR_METRIC_DESC NATIONAL CHARACTER VARYING(50) NOT NULL,
	MP_NLR_METRIC_LONG_DESC NATIONAL CHARACTER VARYING(100) NOT NULL,
	SORT_ID INTEGER NOT NULL,
	UPDATE_TSTMP TIMESTAMP NOT NULL,
	LOAD_TSTMP TIMESTAMP NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.MP_NLR_METRIC
ADD CONSTRAINT MP_NLR_METRIC_PK
PRIMARY KEY (MP_NLR_METRIC_ID);



CREATE TABLE KEDWARDS.MP_NLR_PRE
(
	MP_SOURCE_ID INTEGER NOT NULL,
	MRKT CHARACTER VARYING(50) NOT NULL,
	BGRP CHARACTER VARYING(50) NOT NULL,
	OUTL CHARACTER VARYING(50) NOT NULL,
	DEMOS CHARACTER VARYING(50) NOT NULL,
	PROD CHARACTER VARYING(50) NOT NULL,
	PER CHARACTER VARYING(50) NOT NULL,
	DOLLARS NUMERIC(15,6) NOT NULL,
	BUYING_HH NUMERIC(12,6) NOT NULL,
	RAW_BUYERS INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.MP_NLR_SOV_MIGRATION
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	MP_CHANNEL_ID INTEGER NOT NULL,
	MIGRATION_HH NUMERIC(12,6),
	SOV_HH NUMERIC(12,6),
	MIGRATION_DOLLARS NUMERIC(15,6),
	SOV_DOLLARS NUMERIC(15,6),
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.MP_NLR_SOV_MIGRATION
ADD CONSTRAINT MP_NLR_SOV_MIGRATION_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID, CA_DATE_GROUP_ID, MP_CHANNEL_ID);



CREATE TABLE KEDWARDS.MP_PANEL
(
	MP_SOURCE_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	MP_CHANNEL_ID INTEGER NOT NULL,
	MP_BUYER_GROUP_ID INTEGER NOT NULL,
	DOLLARS_TY NUMERIC(15,6) NOT NULL,
	BUYING_HH_TY NUMERIC(12,6) NOT NULL,
	OCCASIONS_TY NUMERIC(15,6) NOT NULL,
	UNITS_TY NUMERIC(15,6) NOT NULL,
	DOLLARS_LY NUMERIC(15,6) NOT NULL,
	BUYING_HH_LY NUMERIC(12,6) NOT NULL,
	OCCASIONS_LY NUMERIC(15,6) NOT NULL,
	UNITS_LY NUMERIC(15,6) NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.MP_PANEL
ADD CONSTRAINT MP_PANEL_PK1
PRIMARY KEY (MP_SOURCE_ID, CA_PRODUCT_GROUP_ID, CA_DATE_GROUP_ID, MP_CHANNEL_ID, MP_BUYER_GROUP_ID);



CREATE TABLE KEDWARDS.MP_PANEL_FILE_HIST
(
	LOAD_TSTMP TIMESTAMP NOT NULL,
	MP_SOURCE_ID INTEGER NOT NULL,
	MRKT CHARACTER VARYING(50) NOT NULL,
	DEMOS CHARACTER VARYING(50) NOT NULL,
	PER CHARACTER VARYING(50) NOT NULL,
	BGRP CHARACTER VARYING(50) NOT NULL,
	VP CHARACTER VARYING(50) NOT NULL,
	PROD CHARACTER VARYING(50) NOT NULL,
	OUTL CHARACTER VARYING(50) NOT NULL,
	RAW_BUYERS INTEGER NOT NULL,
	DOLLARS NUMERIC(15,6) NOT NULL,
	BUYING_HH NUMERIC(12,6) NOT NULL,
	OCCASIONS NUMERIC(15,6) NOT NULL,
	UNITS NUMERIC(15,6) NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.MP_PANEL_OLD
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	MP_CHANNEL_ID INTEGER NOT NULL,
	MP_BUYER_GROUP_ID INTEGER NOT NULL,
	DOLLARS_TY NUMERIC(15,6) NOT NULL,
	BUYING_HH_TY NUMERIC(12,6) NOT NULL,
	OCCASIONS_TY NUMERIC(15,6) NOT NULL,
	UNITS_TY NUMERIC(15,6) NOT NULL,
	DOLLARS_LY NUMERIC(15,6) NOT NULL,
	BUYING_HH_LY NUMERIC(12,6) NOT NULL,
	OCCASIONS_LY NUMERIC(15,6) NOT NULL,
	UNITS_LY NUMERIC(15,6) NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.MP_PANEL_OLD
ADD CONSTRAINT MP_PANEL_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID, CA_DATE_GROUP_ID, MP_CHANNEL_ID, MP_BUYER_GROUP_ID);



CREATE TABLE KEDWARDS.MP_PANEL_PRE
(
	MP_SOURCE_ID INTEGER NOT NULL,
	MRKT CHARACTER VARYING(50) NOT NULL,
	DEMOS CHARACTER VARYING(50) NOT NULL,
	PER CHARACTER VARYING(50) NOT NULL,
	BGRP CHARACTER VARYING(50) NOT NULL,
	VP CHARACTER VARYING(50) NOT NULL,
	PROD CHARACTER VARYING(50) NOT NULL,
	OUTL CHARACTER VARYING(50) NOT NULL,
	RAW_BUYERS INTEGER NOT NULL,
	DOLLARS NUMERIC(15,6) NOT NULL,
	BUYING_HH NUMERIC(12,6) NOT NULL,
	OCCASIONS NUMERIC(15,6) NOT NULL,
	UNITS NUMERIC(15,6) NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.MP_PRODUCT_GROUP
(
	MP_PRODUCT_GROUP_LEVEL_ID INTEGER NOT NULL,
	MP_PRODUCT_GROUP_LEVEL_DESC CHARACTER VARYING(50) NOT NULL,
	MP_PRODUCT_GROUP_VP_ID INTEGER NOT NULL,
	MP_PRODUCT_GROUP_VP_DESC CHARACTER VARYING(50) NOT NULL,
	MP_PRODUCT_GROUP_DIVISION_ID INTEGER NOT NULL,
	MP_PRODUCT_GROUP_DIVISION_DESC CHARACTER VARYING(50) NOT NULL,
	MP_PRODUCT_GROUP_ID INTEGER NOT NULL,
	MP_PRODUCT_GROUP_DESC CHARACTER VARYING(50) NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	UPDATE_TSTMP TIMESTAMP NOT NULL,
	LOAD_TSTMP TIMESTAMP NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.MP_PRODUCT_GROUP
ADD CONSTRAINT MP_PRODUCT_GROUP_PK
PRIMARY KEY (MP_PRODUCT_GROUP_ID);



CREATE TABLE KEDWARDS.MP_SOURCE
(
	MP_SOURCE_ID INTEGER NOT NULL,
	MP_SOURCE_DESC CHARACTER VARYING(50) NOT NULL,
	UPDATE_TSTMP TIMESTAMP NOT NULL,
	LOAD_TSTMP TIMESTAMP NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.MP_SOURCE
ADD CONSTRAINT MP_SOURCE_PK
PRIMARY KEY (MP_SOURCE_ID);



CREATE TABLE KEDWARDS.QW_CUST_TYPE_XREF
(
	CUST_TYPE_GROUP_ID INTEGER,
	CUST_TYPE INTEGER NOT NULL,
	CUST_TYPE_GROUP_DESC CHARACTER VARYING(16)
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.QW_DEMO_CTRL
(
	DEMO_TYPE_ID INTEGER,
	DEMO_TYPE_DESC CHARACTER VARYING(50),
	DEMO_ID INTEGER,
	DEMO_DESC CHARACTER VARYING(50),
	DEMO_VALUE_ID INTEGER NOT NULL,
	DEMO_VALUE_DESC CHARACTER VARYING(25),
	DEMO_COLUMN_NAME CHARACTER VARYING(100),
	JOIN_TYPE CHARACTER VARYING(25),
	DEMO_COLUMN_START_VALUE CHARACTER VARYING(10),
	DEMO_COLUMN_END_VALUE CHARACTER VARYING(10),
	DEMO_COLUMN_VALUE CHARACTER VARYING(500)
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.QW_DEMO_CTRL
ADD CONSTRAINT QW_DEMO_CTRL_PK
PRIMARY KEY (DEMO_VALUE_ID);



CREATE TABLE KEDWARDS.QW_DEMO_FINAL_IRI
(
	CA_PRODUCT_GROUP_ID INTEGER,
	DEMO_VALUE_ID INTEGER,
	DEMO_PCT NUMERIC(4,4)
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.QW_DEMO_FINAL_PETM
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER,
	CUSTOMER_SEGMENT_SPECIES_GRP_CD CHARACTER VARYING(5),
	CUSTOMER_SEGMENT_SPECIES_GRP_NAME CHARACTER VARYING(50),
	CUST_TYPE_GROUP_ID INTEGER,
	CUST_TYPE_GROUP_DESC CHARACTER VARYING(16),
	DEMO_TYPE_ID INTEGER,
	DEMO_TYPE_DESC CHARACTER VARYING(50),
	DEMO_ID INTEGER,
	DEMO_DESC CHARACTER VARYING(50),
	DEMO_VALUE_ID INTEGER,
	DEMO_VALUE_DESC CHARACTER VARYING(25),
	CUST_CNT NUMERIC(38,0),
	RETAINED_CUST_CNT NUMERIC(38,0),
	TXNS NUMERIC(38,0),
	SLS NUMERIC(38,8),
	MGN NUMERIC(38,9),
	CUST_CNT_LY NUMERIC(38,0),
	RETAINED_CUST_CNT_LY NUMERIC(38,0),
	TXNS_LY NUMERIC(38,0),
	SLS_LY NUMERIC(38,8),
	MGN_LY NUMERIC(38,9)
)
DISTRIBUTE ON (DEMO_VALUE_ID, CA_PRODUCT_GROUP_ID, DEMO_VALUE_DESC, DEMO_ID);


CREATE TABLE KEDWARDS.QW_METRIC
(
	METRIC_ID INTEGER,
	METRIC_NAME CHARACTER VARYING(17)
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.QW_SPECIES_XREF
(
	CUSTOMER_SEGMENT_SPECIES_GRP_CD CHARACTER VARYING(5),
	CUSTOMER_SEGMENT_SPECIES_GRP_CD_JOIN CHARACTER VARYING(5) NOT NULL,
	CUSTOMER_SEGMENT_SPECIES_GRP_NAME CHARACTER VARYING(50)
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.RETENTION_BUCKET
(
	RETENTION_BUCKET_ID SMALLINT NOT NULL,
	RETENTION_BUCKET_DESC CHARACTER VARYING(50),
	DAY_START SMALLINT,
	DAY_END SMALLINT
)
DISTRIBUTE ON (RETENTION_BUCKET_ID);

ALTER TABLE KEDWARDS.RETENTION_BUCKET
ADD CONSTRAINT RETENTION_BUCKET_PK
PRIMARY KEY (RETENTION_BUCKET_ID);



CREATE TABLE KEDWARDS.SALON_AND_OVERNIGHT_SAME_DAY_PRE
(
	CUSTOMER_EID NUMERIC(19,0) NOT NULL,
	PERIOD_START_DT DATE NOT NULL,
	PERIOD_END_DT DATE NOT NULL,
	SALON_AND_OVERNIGHT_SAME_DAY_CNT INTEGER NOT NULL,
	SALON_AND_OVERNIGHT_SAME_DAY_IND BYTEINT NOT NULL
)
DISTRIBUTE ON (CUSTOMER_EID);

ALTER TABLE KEDWARDS.SALON_AND_OVERNIGHT_SAME_DAY_PRE
ADD CONSTRAINT SALON_AND_OVERNIGHT_SAME_DAY_PRE_PK
PRIMARY KEY (CUSTOMER_EID, PERIOD_START_DT, PERIOD_END_DT);



CREATE TABLE SALON_CUST_SALES
(
	CUSTOMER_EID NUMERIC(19,0) NOT NULL,
	PERIOD_END_FISCAL_MO INTEGER NOT NULL,
	PERIOD_START_DT DATE NOT NULL,
	PERIOD_END_DT DATE NOT NULL,
	PERIOD_START_FISCAL_WK INTEGER NOT NULL,
	PERIOD_END_FISCAL_WK INTEGER NOT NULL,
	CURRENT_PERIOD_IND BYTEINT NOT NULL,
	PETM_HST_FIRST_TXN_DT DATE,
	PETM_HST_LAST_TXN_DT DATE,
	PETM_HST_SALES NUMERIC(15,3) NOT NULL,
	PETM_HST_TXNS INTEGER NOT NULL,
	PETM_HST_VISITS INTEGER NOT NULL,
	PETM_HST_TENURE_DAYS INTEGER,
	PETM_HST_MEDIAN_DAYS_BTWN_VISITS NUMERIC(6,1),
	PETM_LY_TXNS INTEGER NOT NULL,
	PETM_R52_CUST_TYPE INTEGER,
	PETM_HST_REACT_CNT SMALLINT,
	SALON_HST_FIRST_TXN_DT DATE,
	SALON_HST_LAST_TXN_DT DATE,
	SALON_HST_SALES NUMERIC(15,3) NOT NULL,
	SALON_HST_TXNS INTEGER NOT NULL,
	SALON_HST_VISITS INTEGER NOT NULL,
	SALON_HST_TENURE_DAYS INTEGER,
	SALON_HST_MEDIAN_DAYS_BTWN_VISITS NUMERIC(6,1),
	SALON_LY_TXNS INTEGER NOT NULL,
	SALON_R52_PREV_TXN_DT DATE,
	SALON_R52_FIRST_TXN_DT DATE,
	SALON_R52_CUST_TYPE INTEGER,
	SALON_HST_REACT_CNT SMALLINT,
	NON_SALON_HST_FIRST_TXN_DT DATE,
	NON_SALON_HST_LAST_TXN_DT DATE,
	NON_SALON_HST_SALES NUMERIC(15,3) NOT NULL,
	NON_SALON_HST_TXNS INTEGER NOT NULL,
	NON_SALON_HST_VISITS INTEGER NOT NULL,
	NON_SALON_HST_TENURE_DAYS INTEGER,
	NON_SALON_HST_MEDIAN_DAYS_BTWN_VISITS NUMERIC(6,1),
	NON_SALON_R52_CUST_TYPE INTEGER,
	NON_SALON_HST_REACT_CNT SMALLINT,
	FSG_HST_FIRST_TXN_DT DATE,
	FSG_HST_LAST_TXN_DT DATE,
	FSG_HST_SALES NUMERIC(15,3) NOT NULL,
	FSG_HST_TXNS INTEGER NOT NULL,
	FSG_HST_VISITS INTEGER NOT NULL,
	FSG_HST_TENURE_DAYS INTEGER,
	FSG_HST_MEDIAN_DAYS_BTWN_VISITS NUMERIC(6,1),
	FSG_R52_CUST_TYPE INTEGER,
	FSG_HST_REACT_CNT SMALLINT,
	BB_HST_FIRST_TXN_DT DATE,
	BB_HST_LAST_TXN_DT DATE,
	BB_HST_SALES NUMERIC(15,3) NOT NULL,
	BB_HST_TXNS INTEGER NOT NULL,
	BB_HST_VISITS INTEGER NOT NULL,
	BB_HST_TENURE_DAYS INTEGER,
	BB_HST_MEDIAN_DAYS_BTWN_VISITS NUMERIC(6,1),
	BB_R52_CUST_TYPE INTEGER,
	BB_HST_REACT_CNT SMALLINT,
	SA_HST_FIRST_TXN_DT DATE,
	SA_HST_LAST_TXN_DT DATE,
	SA_HST_SALES NUMERIC(15,3) NOT NULL,
	SA_HST_TXNS INTEGER NOT NULL,
	SA_HST_VISITS INTEGER NOT NULL,
	SA_HST_TENURE_DAYS INTEGER,
	SA_HST_MEDIAN_DAYS_BTWN_VISITS NUMERIC(6,1),
	SA_R52_CUST_TYPE INTEGER,
	SA_HST_REACT_CNT SMALLINT,
	CTG_FSG_FURM_HST_FIRST_TXN_DT DATE,
	CTG_FSG_FURM_HST_LAST_TXN_DT DATE,
	CTG_FSG_FURM_HST_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_FURM_HST_TXNS INTEGER NOT NULL,
	CTG_FSG_FURM_HST_VISITS INTEGER NOT NULL,
	CTG_FSG_FURM_HST_TENURE_DAYS INTEGER,
	CTG_FSG_FURM_HST_MEDIAN_DAYS_BTWN_VISITS NUMERIC(6,1),
	CTG_FSG_FURM_R52_CUST_TYPE INTEGER,
	CTG_FSG_FURM_HST_REACT_CNT SMALLINT,
	CTG_BB_FURM_HST_FIRST_TXN_DT DATE,
	CTG_BB_FURM_HST_LAST_TXN_DT DATE,
	CTG_BB_FURM_HST_SALES NUMERIC(15,3) NOT NULL,
	CTG_BB_FURM_HST_TXNS INTEGER NOT NULL,
	CTG_BB_FURM_HST_VISITS INTEGER NOT NULL,
	CTG_BB_FURM_HST_TENURE_DAYS INTEGER,
	CTG_BB_FURM_HST_MEDIAN_DAYS_BTWN_VISITS NUMERIC(6,1),
	CTG_BB_FURM_R52_CUST_TYPE INTEGER,
	CTG_BB_FURM_HST_REACT_CNT SMALLINT,
	PETM_MRNR_FIRST_TXN_DT DATE,
	SALON_MRNR_FIRST_TXN_DT DATE,
	FSG_MRNR_FIRST_TXN_DT DATE,
	BB_MRNR_FIRST_TXN_DT DATE,
	SA_MRNR_FIRST_TXN_DT DATE,
	PETM_R52_SALES INTEGER NOT NULL,
	PETM_R52_UNITS INTEGER NOT NULL,
	PETM_R52_TXNS INTEGER NOT NULL,
	PETM_R52_VISITS INTEGER NOT NULL,
	SALON_R52_SALES NUMERIC(15,3) NOT NULL,
	SALON_R52_UNITS INTEGER NOT NULL,
	SALON_R52_TXNS INTEGER NOT NULL,
	SALON_R52_VISITS INTEGER NOT NULL,
	SALON_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	SALON_R52_MON_VISITS INTEGER NOT NULL,
	SALON_R52_TUE_VISITS INTEGER NOT NULL,
	SALON_R52_WED_VISITS INTEGER NOT NULL,
	SALON_R52_THU_VISITS INTEGER NOT NULL,
	SALON_R52_FRI_VISITS INTEGER NOT NULL,
	SALON_R52_SAT_VISITS INTEGER NOT NULL,
	SALON_R52_SUN_VISITS INTEGER NOT NULL,
	NON_SALON_R52_SALES NUMERIC(15,3) NOT NULL,
	NON_SALON_R52_UNITS INTEGER NOT NULL,
	NON_SALON_R52_TXNS INTEGER NOT NULL,
	NON_SALON_R52_VISITS INTEGER NOT NULL,
	CORE_R52_SALES NUMERIC(15,3) NOT NULL,
	CORE_R52_UNITS INTEGER NOT NULL,
	CORE_R52_TXNS INTEGER NOT NULL,
	CORE_R52_VISITS INTEGER NOT NULL,
	FSG_R52_SALES NUMERIC(15,3) NOT NULL,
	FSG_R52_UNITS INTEGER NOT NULL,
	FSG_R52_TXNS INTEGER NOT NULL,
	FSG_R52_VISITS INTEGER NOT NULL,
	FSG_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	BB_R52_SALES NUMERIC(15,3) NOT NULL,
	BB_R52_UNITS INTEGER NOT NULL,
	BB_R52_TXNS INTEGER NOT NULL,
	BB_R52_VISITS INTEGER NOT NULL,
	BB_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	SA_R52_SALES NUMERIC(15,3) NOT NULL,
	SA_R52_UNITS INTEGER NOT NULL,
	SA_R52_TXNS INTEGER NOT NULL,
	SA_R52_VISITS INTEGER NOT NULL,
	SA_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	AO_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_R52_UNITS INTEGER NOT NULL,
	AO_R52_TXNS INTEGER NOT NULL,
	AO_R52_VISITS INTEGER NOT NULL,
	AO_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	CTG_FSG_FURM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_FURM_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_FURM_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_FURM_R52_VISITS INTEGER NOT NULL,
	CTG_BB_FURM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_BB_FURM_R52_UNITS INTEGER NOT NULL,
	CTG_BB_FURM_R52_TXNS INTEGER NOT NULL,
	CTG_BB_FURM_R52_VISITS INTEGER NOT NULL,
	CTG_TTL_FURM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_TTL_FURM_R52_UNITS INTEGER NOT NULL,
	CTG_TTL_FURM_R52_TXNS INTEGER NOT NULL,
	CTG_TTL_FURM_R52_VISITS INTEGER NOT NULL,
	CTG_AO_NAIL_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_NAIL_R52_UNITS INTEGER NOT NULL,
	CTG_AO_NAIL_R52_TXNS INTEGER NOT NULL,
	CTG_AO_NAIL_R52_VISITS INTEGER NOT NULL,
	CTG_AO_CHI_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_CHI_R52_UNITS INTEGER NOT NULL,
	CTG_AO_CHI_R52_TXNS INTEGER NOT NULL,
	CTG_AO_CHI_R52_VISITS INTEGER NOT NULL,
	CTG_AO_TEETH_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_TEETH_R52_UNITS INTEGER NOT NULL,
	CTG_AO_TEETH_R52_TXNS INTEGER NOT NULL,
	CTG_AO_TEETH_R52_VISITS INTEGER NOT NULL,
	CTG_AO_TOP_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_TOP_R52_UNITS INTEGER NOT NULL,
	CTG_AO_TOP_R52_TXNS INTEGER NOT NULL,
	CTG_AO_TOP_R52_VISITS INTEGER NOT NULL,
	CTG_AO_HEMPZ_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_HEMPZ_R52_UNITS INTEGER NOT NULL,
	CTG_AO_HEMPZ_R52_TXNS INTEGER NOT NULL,
	CTG_AO_HEMPZ_R52_VISITS INTEGER NOT NULL,
	CTG_BB_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_BB_R52_UNITS INTEGER NOT NULL,
	CTG_BB_R52_TXNS INTEGER NOT NULL,
	CTG_BB_R52_VISITS INTEGER NOT NULL,
	CTG_BB_PUPPY_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_BB_PUPPY_R52_UNITS INTEGER NOT NULL,
	CTG_BB_PUPPY_R52_TXNS INTEGER NOT NULL,
	CTG_BB_PUPPY_R52_VISITS INTEGER NOT NULL,
	CTG_BB_CAT_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_BB_CAT_R52_UNITS INTEGER NOT NULL,
	CTG_BB_CAT_R52_TXNS INTEGER NOT NULL,
	CTG_BB_CAT_R52_VISITS INTEGER NOT NULL,
	CTG_FSG_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_R52_VISITS INTEGER NOT NULL,
	CTG_FSG_CAT_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_CAT_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_CAT_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_CAT_R52_VISITS INTEGER NOT NULL,
	CTG_FSG_PUPPY_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_PUPPY_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_PUPPY_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_PUPPY_R52_VISITS INTEGER NOT NULL,
	CTG_FSG_PREM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_PREM_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_PREM_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_PREM_R52_VISITS INTEGER NOT NULL,
	CTG_SA_NAIL_TRIM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_SA_NAIL_TRIM_R52_UNITS INTEGER NOT NULL,
	CTG_SA_NAIL_TRIM_R52_TXNS INTEGER NOT NULL,
	CTG_SA_NAIL_TRIM_R52_VISITS INTEGER NOT NULL,
	CTG_SA_PAWDICURE_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_SA_PAWDICURE_R52_UNITS INTEGER NOT NULL,
	CTG_SA_PAWDICURE_R52_TXNS INTEGER NOT NULL,
	CTG_SA_PAWDICURE_R52_VISITS INTEGER NOT NULL,
	AO_NON_PCKG_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_NON_PCKG_R52_UNITS INTEGER NOT NULL,
	AO_NON_PCKG_R52_TXNS INTEGER NOT NULL,
	AO_NON_PCKG_R52_VISITS INTEGER NOT NULL,
	AO_PCKG_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_PCKG_R52_UNITS INTEGER NOT NULL,
	AO_PCKG_R52_TXNS INTEGER NOT NULL,
	AO_PCKG_R52_VISITS INTEGER NOT NULL,
	AO_POP_PCKG_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_POP_PCKG_R52_UNITS INTEGER NOT NULL,
	AO_POP_PCKG_R52_TXNS INTEGER NOT NULL,
	AO_POP_PCKG_R52_VISITS INTEGER NOT NULL,
	AO_PREM_PCKG_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_PREM_PCKG_R52_UNITS INTEGER NOT NULL,
	AO_PREM_PCKG_R52_TXNS INTEGER NOT NULL,
	AO_PREM_PCKG_R52_VISITS INTEGER NOT NULL,
	DDC_R52_SALES NUMERIC(15,3) NOT NULL,
	DDC_R52_UNITS INTEGER NOT NULL,
	DDC_R52_TXNS INTEGER NOT NULL,
	DDC_R52_VISITS INTEGER NOT NULL,
	OVERNIGHT_R52_SALES NUMERIC(15,3) NOT NULL,
	OVERNIGHT_R52_UNITS INTEGER NOT NULL,
	OVERNIGHT_R52_TXNS INTEGER NOT NULL,
	OVERNIGHT_R52_VISITS INTEGER NOT NULL,
	HOTEL_BATH_R52_SALES NUMERIC(15,3) NOT NULL,
	HOTEL_BATH_R52_UNITS INTEGER NOT NULL,
	HOTEL_BATH_R52_TXNS INTEGER NOT NULL,
	HOTEL_BATH_R52_VISITS INTEGER NOT NULL,
	TRAINING_R52_SALES NUMERIC(15,3) NOT NULL,
	TRAINING_R52_UNITS INTEGER NOT NULL,
	TRAINING_R52_TXNS INTEGER NOT NULL,
	TRAINING_R52_VISITS INTEGER NOT NULL,
	BREED_NAME_CNT INTEGER NOT NULL,
	BREED_NAME CHARACTER VARYING(50),
	NEED_LEVEL_CNT INTEGER NOT NULL,
	NEED_LEVEL CHARACTER VARYING(8),
	SHED_LEVEL_CNT INTEGER NOT NULL,
	SHED_LEVEL CHARACTER VARYING(8),
	COAT_TYPE_CNT INTEGER NOT NULL,
	COAT_TYPE CHARACTER VARYING(25),
	SIZE_CNT INTEGER NOT NULL,
	SIZE CHARACTER VARYING(8),
	PRIMARY_SALON_LOCATION_ID INTEGER,
	PRIMARY_SALON_R52_SALES NUMERIC(15,3),
	PRIMARY_SALON_R52_SALES_PCT NUMERIC(15,6),
	SECONDARY_SALON_LOCATION_ID INTEGER,
	SECONDARY_SALON_R52_SALES NUMERIC(15,3),
	SECONDARY_SALON_R52_SALES_PCT NUMERIC(15,3),
	PRIMARY_NON_SALON_LOCATION_ID INTEGER,
	PRIMARY_NON_SALON_R52_SALES NUMERIC(15,3),
	PRIMARY_NON_SALON_R52_SALES_PCT NUMERIC(15,6),
	SALON_AND_OVERNIGHT_SAME_DAY_CNT INTEGER,
	SALON_AND_OVERNIGHT_SAME_DAY_IND INTEGER,
	CUSTOMER_SEGMENT_CD CHARACTER VARYING(5),
	CUSTOMER_SEGMENT_NAME CHARACTER VARYING(50),
	CUSTOMER_SUB_SEGMENT_CD CHARACTER VARYING(5),
	CUSTOMER_SUB_SEGMENT_NAME CHARACTER VARYING(50),
	CUSTOMER_SEGMENT_SPECIES_GRP_CD CHARACTER VARYING(5),
	CUSTOMER_SEGMENT_SPECIES_GRP_NAME CHARACTER VARYING(50),
	EMAIL_CONTACTABLE_IND BYTEINT NOT NULL,
	DM_CONTACTABLE_IND BYTEINT NOT NULL,
	TREATS_IND BYTEINT NOT NULL,
	TREATS_PROFILE_COMPLETE_IND BYTEINT NOT NULL
)
DISTRIBUTE ON (CUSTOMER_EID);

ALTER TABLE SALON_CUST_SALES
ADD CONSTRAINT SALON_CUST_SALES_PK1
PRIMARY KEY (CUSTOMER_EID, PERIOD_START_DT, PERIOD_END_DT);



CREATE TABLE KEDWARDS.SALON_CUST_SALES_HST_PG_PRE
(
	DAY_DT DATE NOT NULL,
	CUSTOMER_EID NUMERIC(19,0) NOT NULL,
	PETM_DAY_DT DATE,
	PETM_SALES NUMERIC(15,3),
	PETM_TXNS INTEGER,
	PETM_VISITS INTEGER,
	PETM_DAYS_FROM_LAST_VISIT SMALLINT,
	PETM_CUST_TYPE INTEGER,
	SALON_DAY_DT DATE,
	SALON_SALES NUMERIC(15,3),
	SALON_TXNS INTEGER,
	SALON_VISITS INTEGER,
	SALON_DAYS_FROM_LAST_VISIT SMALLINT,
	SALON_CUST_TYPE INTEGER,
	NON_SALON_DAY_DT DATE,
	NON_SALON_SALES NUMERIC(15,3),
	NON_SALON_TXNS INTEGER,
	NON_SALON_VISITS INTEGER,
	NON_SALON_DAYS_FROM_LAST_VISIT SMALLINT,
	NON_SALON_CUST_TYPE INTEGER,
	FSG_DAY_DT DATE,
	FSG_SALES NUMERIC(15,3),
	FSG_TXNS INTEGER,
	FSG_VISITS INTEGER,
	FSG_DAYS_FROM_LAST_VISIT SMALLINT,
	FSG_CUST_TYPE INTEGER,
	BB_DAY_DT DATE,
	BB_SALES NUMERIC(15,3),
	BB_TXNS INTEGER,
	BB_VISITS INTEGER,
	BB_DAYS_FROM_LAST_VISIT SMALLINT,
	BB_CUST_TYPE INTEGER,
	SA_DAY_DT DATE,
	SA_SALES NUMERIC(15,3),
	SA_TXNS INTEGER,
	SA_VISITS INTEGER,
	SA_DAYS_FROM_LAST_VISIT SMALLINT,
	SA_CUST_TYPE INTEGER,
	CTG_FSG_FURM_DAY_DT DATE,
	CTG_FSG_FURM_SALES NUMERIC(15,3),
	CTG_FSG_FURM_TXNS INTEGER,
	CTG_FSG_FURM_VISITS INTEGER,
	CTG_FSG_FURM_DAYS_FROM_LAST_VISIT SMALLINT,
	CTG_FSG_FURM_CUST_TYPE INTEGER,
	CTG_BB_FURM_DAY_DT DATE,
	CTG_BB_FURM_SALES NUMERIC(15,3),
	CTG_BB_FURM_TXNS INTEGER,
	CTG_BB_FURM_VISITS INTEGER,
	CTG_BB_FURM_DAYS_FROM_LAST_VISIT SMALLINT,
	CTG_BB_FURM_CUST_TYPE INTEGER
)
DISTRIBUTE ON (CUSTOMER_EID);


CREATE TABLE KEDWARDS.SALON_CUST_SALES_HST_PG_PRE_PRE
(
	DAY_DT DATE NOT NULL,
	PRODUCT_GROUP CHARACTER VARYING(12) NOT NULL,
	CUSTOMER_EID NUMERIC(19,0) NOT NULL,
	SALES NUMERIC(15,3),
	TXNS INTEGER,
	VISITS INTEGER,
	DAYS_FROM_LAST_VISIT SMALLINT,
	CUST_TYPE INTEGER
)
DISTRIBUTE ON (CUSTOMER_EID);


CREATE TABLE KEDWARDS.SALON_CUST_SALES_HST_PRE
(
	CUSTOMER_EID NUMERIC(19,0) NOT NULL,
	PERIOD_START_DT DATE NOT NULL,
	PERIOD_END_DT DATE NOT NULL,
	CURRENT_PERIOD_IND BYTEINT NOT NULL,
	PETM_HST_FIRST_TXN_DT DATE,
	PETM_HST_LAST_TXN_DT DATE,
	PETM_HST_SALES NUMERIC(15,3) NOT NULL,
	PETM_HST_TXNS INTEGER NOT NULL,
	PETM_HST_VISITS INTEGER NOT NULL,
	PETM_HST_TENURE_DAYS INTEGER,
	PETM_HST_MEDIAN_DAYS_BTWN_VISITS NUMERIC(6,1),
	PETM_LY_TXNS INTEGER NOT NULL,
	PETM_R52_CUST_TYPE INTEGER,
	PETM_HST_REACT_CNT SMALLINT,
	SALON_HST_FIRST_TXN_DT DATE,
	SALON_HST_LAST_TXN_DT DATE,
	SALON_HST_SALES NUMERIC(15,3) NOT NULL,
	SALON_HST_TXNS INTEGER NOT NULL,
	SALON_HST_VISITS INTEGER NOT NULL,
	SALON_HST_TENURE_DAYS INTEGER,
	SALON_HST_MEDIAN_DAYS_BTWN_VISITS NUMERIC(6,1),
	SALON_LY_TXNS INTEGER NOT NULL,
	SALON_R52_PREV_TXN_DT DATE,
	SALON_R52_FIRST_TXN_DT DATE,
	SALON_R52_CUST_TYPE INTEGER,
	SALON_HST_REACT_CNT SMALLINT,
	NON_SALON_HST_FIRST_TXN_DT DATE,
	NON_SALON_HST_LAST_TXN_DT DATE,
	NON_SALON_HST_SALES NUMERIC(15,3) NOT NULL,
	NON_SALON_HST_TXNS INTEGER NOT NULL,
	NON_SALON_HST_VISITS INTEGER NOT NULL,
	NON_SALON_HST_TENURE_DAYS INTEGER,
	NON_SALON_HST_MEDIAN_DAYS_BTWN_VISITS NUMERIC(6,1),
	NON_SALON_R52_CUST_TYPE INTEGER,
	NON_SALON_HST_REACT_CNT SMALLINT,
	FSG_HST_FIRST_TXN_DT DATE,
	FSG_HST_LAST_TXN_DT DATE,
	FSG_HST_SALES NUMERIC(15,3) NOT NULL,
	FSG_HST_TXNS INTEGER NOT NULL,
	FSG_HST_VISITS INTEGER NOT NULL,
	FSG_HST_TENURE_DAYS INTEGER,
	FSG_HST_MEDIAN_DAYS_BTWN_VISITS NUMERIC(6,1),
	FSG_R52_CUST_TYPE INTEGER,
	FSG_HST_REACT_CNT SMALLINT,
	BB_HST_FIRST_TXN_DT DATE,
	BB_HST_LAST_TXN_DT DATE,
	BB_HST_SALES NUMERIC(15,3) NOT NULL,
	BB_HST_TXNS INTEGER NOT NULL,
	BB_HST_VISITS INTEGER NOT NULL,
	BB_HST_TENURE_DAYS INTEGER,
	BB_HST_MEDIAN_DAYS_BTWN_VISITS NUMERIC(6,1),
	BB_R52_CUST_TYPE INTEGER,
	BB_HST_REACT_CNT SMALLINT,
	SA_HST_FIRST_TXN_DT DATE,
	SA_HST_LAST_TXN_DT DATE,
	SA_HST_SALES NUMERIC(15,3) NOT NULL,
	SA_HST_TXNS INTEGER NOT NULL,
	SA_HST_VISITS INTEGER NOT NULL,
	SA_HST_TENURE_DAYS INTEGER,
	SA_HST_MEDIAN_DAYS_BTWN_VISITS NUMERIC(6,1),
	SA_R52_CUST_TYPE INTEGER,
	SA_HST_REACT_CNT SMALLINT,
	CTG_FSG_FURM_HST_FIRST_TXN_DT DATE,
	CTG_FSG_FURM_HST_LAST_TXN_DT DATE,
	CTG_FSG_FURM_HST_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_FURM_HST_TXNS INTEGER NOT NULL,
	CTG_FSG_FURM_HST_VISITS INTEGER NOT NULL,
	CTG_FSG_FURM_HST_TENURE_DAYS INTEGER,
	CTG_FSG_FURM_HST_MEDIAN_DAYS_BTWN_VISITS NUMERIC(6,1),
	CTG_FSG_FURM_R52_CUST_TYPE INTEGER,
	CTG_FSG_FURM_HST_REACT_CNT SMALLINT,
	CTG_BB_FURM_HST_FIRST_TXN_DT DATE,
	CTG_BB_FURM_HST_LAST_TXN_DT DATE,
	CTG_BB_FURM_HST_SALES NUMERIC(15,3) NOT NULL,
	CTG_BB_FURM_HST_TXNS INTEGER NOT NULL,
	CTG_BB_FURM_HST_VISITS INTEGER NOT NULL,
	CTG_BB_FURM_HST_TENURE_DAYS INTEGER,
	CTG_BB_FURM_HST_MEDIAN_DAYS_BTWN_VISITS NUMERIC(6,1),
	CTG_BB_FURM_R52_CUST_TYPE INTEGER,
	CTG_BB_FURM_HST_REACT_CNT SMALLINT
)
DISTRIBUTE ON (CUSTOMER_EID);

ALTER TABLE KEDWARDS.SALON_CUST_SALES_HST_PRE
ADD CONSTRAINT SALON_CUST_SALES_HST_PRE_PK
PRIMARY KEY (CUSTOMER_EID, PERIOD_START_DT, PERIOD_END_DT);



CREATE TABLE KEDWARDS.SALON_CUST_SALES_MISC_PRE
(
	CUSTOMER_EID NUMERIC(19,0) NOT NULL,
	PERIOD_START_DT DATE NOT NULL,
	PERIOD_END_DT DATE NOT NULL,
	BREED_NAME_CNT INTEGER NOT NULL,
	BREED_NAME CHARACTER VARYING(50) NOT NULL,
	NEED_LEVEL_CNT BIGINT NOT NULL,
	NEED_LEVEL CHARACTER VARYING(8) NOT NULL,
	SHED_LEVEL_CNT BIGINT NOT NULL,
	SHED_LEVEL CHARACTER VARYING(8) NOT NULL,
	COAT_TYPE_CNT BIGINT NOT NULL,
	COAT_TYPE CHARACTER VARYING(25) NOT NULL,
	SIZE_CNT BIGINT NOT NULL,
	SIZE CHARACTER VARYING(8) NOT NULL
)
DISTRIBUTE ON (CUSTOMER_EID);

ALTER TABLE KEDWARDS.SALON_CUST_SALES_MISC_PRE
ADD CONSTRAINT SALON_CUST_SALES_MISC_PRE_PK
PRIMARY KEY (CUSTOMER_EID, PERIOD_START_DT);



CREATE TABLE KEDWARDS.SALON_CUST_SALES_MRNR_CUST_PRE
(
	CUSTOMER_EID NUMERIC(19,0) NOT NULL,
	PETM_MRNR_TXN_DT DATE NOT NULL,
	PERIOD_START_DT DATE,
	PERIOD_END_DT DATE,
	CURRENT_PERIOD_IND BYTEINT
)
DISTRIBUTE ON (CUSTOMER_EID);

ALTER TABLE KEDWARDS.SALON_CUST_SALES_MRNR_CUST_PRE
ADD CONSTRAINT SALON_CUST_SALES_MRNR_CUST_PRE_PK1
PRIMARY KEY (CUSTOMER_EID, PETM_MRNR_TXN_DT);



CREATE TABLE KEDWARDS.SALON_CUST_SALES_MRNR_PRE
(
	CUSTOMER_EID NUMERIC(19,0) NOT NULL,
	PERIOD_START_DT DATE NOT NULL,
	PERIOD_END_DT DATE NOT NULL,
	CURRENT_PERIOD_IND BYTEINT NOT NULL,
	PETM_MRNR_FIRST_TXN_DT DATE,
	SALON_MRNR_FIRST_TXN_DT DATE,
	FSG_MRNR_FIRST_TXN_DT DATE,
	BB_MRNR_FIRST_TXN_DT DATE,
	SA_MRNR_FIRST_TXN_DT DATE
)
DISTRIBUTE ON (CUSTOMER_EID);

ALTER TABLE KEDWARDS.SALON_CUST_SALES_MRNR_PRE
ADD CONSTRAINT SALON_CUST_SALES_MRNR_PRE_PK1
PRIMARY KEY (CUSTOMER_EID, PERIOD_START_DT, PERIOD_END_DT);



CREATE TABLE KEDWARDS.SALON_CUST_SALES_R52_PRE
(
	CUSTOMER_EID NUMERIC(19,0) NOT NULL,
	PERIOD_START_DT DATE NOT NULL,
	PERIOD_END_DT DATE NOT NULL,
	PETM_R52_SALES INTEGER NOT NULL,
	PETM_R52_UNITS INTEGER NOT NULL,
	PETM_R52_TXNS INTEGER NOT NULL,
	PETM_R52_VISITS INTEGER NOT NULL,
	SALON_R52_SALES NUMERIC(15,3) NOT NULL,
	SALON_R52_UNITS INTEGER NOT NULL,
	SALON_R52_TXNS INTEGER NOT NULL,
	SALON_R52_VISITS INTEGER NOT NULL,
	SALON_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	SALON_R52_MON_VISITS INTEGER NOT NULL,
	SALON_R52_TUE_VISITS INTEGER NOT NULL,
	SALON_R52_WED_VISITS INTEGER NOT NULL,
	SALON_R52_THU_VISITS INTEGER NOT NULL,
	SALON_R52_FRI_VISITS INTEGER NOT NULL,
	SALON_R52_SAT_VISITS INTEGER NOT NULL,
	SALON_R52_SUN_VISITS INTEGER NOT NULL,
	NON_SALON_R52_SALES NUMERIC(15,3) NOT NULL,
	NON_SALON_R52_UNITS INTEGER NOT NULL,
	NON_SALON_R52_TXNS INTEGER NOT NULL,
	NON_SALON_R52_VISITS INTEGER NOT NULL,
	CORE_R52_SALES NUMERIC(15,3) NOT NULL,
	CORE_R52_UNITS INTEGER NOT NULL,
	CORE_R52_TXNS INTEGER NOT NULL,
	CORE_R52_VISITS INTEGER NOT NULL,
	FSG_R52_SALES NUMERIC(15,3) NOT NULL,
	FSG_R52_UNITS INTEGER NOT NULL,
	FSG_R52_TXNS INTEGER NOT NULL,
	FSG_R52_VISITS INTEGER NOT NULL,
	FSG_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	BB_R52_SALES NUMERIC(15,3) NOT NULL,
	BB_R52_UNITS INTEGER NOT NULL,
	BB_R52_TXNS INTEGER NOT NULL,
	BB_R52_VISITS INTEGER NOT NULL,
	BB_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	SA_R52_SALES NUMERIC(15,3) NOT NULL,
	SA_R52_UNITS INTEGER NOT NULL,
	SA_R52_TXNS INTEGER NOT NULL,
	SA_R52_VISITS INTEGER NOT NULL,
	SA_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	AO_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_R52_UNITS INTEGER NOT NULL,
	AO_R52_TXNS INTEGER NOT NULL,
	AO_R52_VISITS INTEGER NOT NULL,
	AO_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	CTG_FSG_FURM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_FURM_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_FURM_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_FURM_R52_VISITS INTEGER NOT NULL,
	CTG_BB_FURM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_BB_FURM_R52_UNITS INTEGER NOT NULL,
	CTG_BB_FURM_R52_TXNS INTEGER NOT NULL,
	CTG_BB_FURM_R52_VISITS INTEGER NOT NULL,
	CTG_TTL_FURM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_TTL_FURM_R52_UNITS INTEGER NOT NULL,
	CTG_TTL_FURM_R52_TXNS INTEGER NOT NULL,
	CTG_TTL_FURM_R52_VISITS INTEGER NOT NULL,
	CTG_AO_NAIL_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_NAIL_R52_UNITS INTEGER NOT NULL,
	CTG_AO_NAIL_R52_TXNS INTEGER NOT NULL,
	CTG_AO_NAIL_R52_VISITS INTEGER NOT NULL,
	CTG_AO_CHI_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_CHI_R52_UNITS INTEGER NOT NULL,
	CTG_AO_CHI_R52_TXNS INTEGER NOT NULL,
	CTG_AO_CHI_R52_VISITS INTEGER NOT NULL,
	CTG_AO_TEETH_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_TEETH_R52_UNITS INTEGER NOT NULL,
	CTG_AO_TEETH_R52_TXNS INTEGER NOT NULL,
	CTG_AO_TEETH_R52_VISITS INTEGER NOT NULL,
	CTG_AO_TOP_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_TOP_R52_UNITS INTEGER NOT NULL,
	CTG_AO_TOP_R52_TXNS INTEGER NOT NULL,
	CTG_AO_TOP_R52_VISITS INTEGER NOT NULL,
	CTG_AO_HEMPZ_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_HEMPZ_R52_UNITS INTEGER NOT NULL,
	CTG_AO_HEMPZ_R52_TXNS INTEGER NOT NULL,
	CTG_AO_HEMPZ_R52_VISITS INTEGER NOT NULL,
	CTG_BB_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_BB_R52_UNITS INTEGER NOT NULL,
	CTG_BB_R52_TXNS INTEGER NOT NULL,
	CTG_BB_R52_VISITS INTEGER NOT NULL,
	CTG_BB_PUPPY_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_BB_PUPPY_R52_UNITS INTEGER NOT NULL,
	CTG_BB_PUPPY_R52_TXNS INTEGER NOT NULL,
	CTG_BB_PUPPY_R52_VISITS INTEGER NOT NULL,
	CTG_BB_CAT_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_BB_CAT_R52_UNITS INTEGER NOT NULL,
	CTG_BB_CAT_R52_TXNS INTEGER NOT NULL,
	CTG_BB_CAT_R52_VISITS INTEGER NOT NULL,
	CTG_FSG_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_R52_VISITS INTEGER NOT NULL,
	CTG_FSG_CAT_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_CAT_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_CAT_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_CAT_R52_VISITS INTEGER NOT NULL,
	CTG_FSG_PUPPY_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_PUPPY_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_PUPPY_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_PUPPY_R52_VISITS INTEGER NOT NULL,
	CTG_FSG_PREM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_PREM_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_PREM_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_PREM_R52_VISITS INTEGER NOT NULL,
	CTG_SA_NAIL_TRIM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_SA_NAIL_TRIM_R52_UNITS INTEGER NOT NULL,
	CTG_SA_NAIL_TRIM_R52_TXNS INTEGER NOT NULL,
	CTG_SA_NAIL_TRIM_R52_VISITS INTEGER NOT NULL,
	CTG_SA_PAWDICURE_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_SA_PAWDICURE_R52_UNITS INTEGER NOT NULL,
	CTG_SA_PAWDICURE_R52_TXNS INTEGER NOT NULL,
	CTG_SA_PAWDICURE_R52_VISITS INTEGER NOT NULL,
	AO_NON_PCKG_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_NON_PCKG_R52_UNITS INTEGER NOT NULL,
	AO_NON_PCKG_R52_TXNS INTEGER NOT NULL,
	AO_NON_PCKG_R52_VISITS INTEGER NOT NULL,
	AO_PCKG_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_PCKG_R52_UNITS INTEGER NOT NULL,
	AO_PCKG_R52_TXNS INTEGER NOT NULL,
	AO_PCKG_R52_VISITS INTEGER NOT NULL,
	AO_POP_PCKG_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_POP_PCKG_R52_UNITS INTEGER NOT NULL,
	AO_POP_PCKG_R52_TXNS INTEGER NOT NULL,
	AO_POP_PCKG_R52_VISITS INTEGER NOT NULL,
	AO_PREM_PCKG_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_PREM_PCKG_R52_UNITS INTEGER NOT NULL,
	AO_PREM_PCKG_R52_TXNS INTEGER NOT NULL,
	AO_PREM_PCKG_R52_VISITS INTEGER NOT NULL,
	DDC_R52_SALES NUMERIC(15,3) NOT NULL,
	DDC_R52_UNITS INTEGER NOT NULL,
	DDC_R52_TXNS INTEGER NOT NULL,
	DDC_R52_VISITS INTEGER NOT NULL,
	OVERNIGHT_R52_SALES NUMERIC(15,3) NOT NULL,
	OVERNIGHT_R52_UNITS INTEGER NOT NULL,
	OVERNIGHT_R52_TXNS INTEGER NOT NULL,
	OVERNIGHT_R52_VISITS INTEGER NOT NULL,
	HOTEL_BATH_R52_SALES NUMERIC(15,3) NOT NULL,
	HOTEL_BATH_R52_UNITS INTEGER NOT NULL,
	HOTEL_BATH_R52_TXNS INTEGER NOT NULL,
	HOTEL_BATH_R52_VISITS INTEGER NOT NULL,
	TRAINING_R52_SALES NUMERIC(15,3) NOT NULL,
	TRAINING_R52_UNITS INTEGER NOT NULL,
	TRAINING_R52_TXNS INTEGER NOT NULL,
	TRAINING_R52_VISITS INTEGER NOT NULL
)
DISTRIBUTE ON (CUSTOMER_EID);

ALTER TABLE KEDWARDS.SALON_CUST_SALES_R52_PRE
ADD CONSTRAINT SALON_CUST_SALES_R52_PRE_PK
PRIMARY KEY (CUSTOMER_EID, PERIOD_START_DT, PERIOD_END_DT);



CREATE TABLE KEDWARDS.SALON_CUST_SALES_R52_PRE_PRE
(
	CUSTOMER_EID NUMERIC(19,0) NOT NULL,
	DAY_DT DATE NOT NULL,
	PETM_R52_SALES NUMERIC(15,3) NOT NULL,
	PETM_R52_UNITS INTEGER NOT NULL,
	PETM_R52_TXNS INTEGER NOT NULL,
	PETM_R52_VISITS INTEGER NOT NULL,
	SALON_R52_SALES NUMERIC(15,3) NOT NULL,
	SALON_R52_UNITS INTEGER NOT NULL,
	SALON_R52_TXNS INTEGER NOT NULL,
	SALON_R52_VISITS INTEGER NOT NULL,
	SALON_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	SALON_R52_MON_VISITS INTEGER NOT NULL,
	SALON_R52_TUE_VISITS INTEGER NOT NULL,
	SALON_R52_WED_VISITS INTEGER NOT NULL,
	SALON_R52_THU_VISITS INTEGER NOT NULL,
	SALON_R52_FRI_VISITS INTEGER NOT NULL,
	SALON_R52_SAT_VISITS INTEGER NOT NULL,
	SALON_R52_SUN_VISITS INTEGER NOT NULL,
	NON_SALON_R52_SALES NUMERIC(15,3) NOT NULL,
	NON_SALON_R52_UNITS INTEGER NOT NULL,
	NON_SALON_R52_TXNS INTEGER NOT NULL,
	NON_SALON_R52_VISITS INTEGER NOT NULL,
	CORE_R52_SALES NUMERIC(15,3) NOT NULL,
	CORE_R52_UNITS INTEGER NOT NULL,
	CORE_R52_TXNS INTEGER NOT NULL,
	CORE_R52_VISITS INTEGER NOT NULL,
	FSG_R52_SALES NUMERIC(15,3) NOT NULL,
	FSG_R52_UNITS INTEGER NOT NULL,
	FSG_R52_TXNS INTEGER NOT NULL,
	FSG_R52_VISITS INTEGER NOT NULL,
	FSG_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	BB_R52_SALES NUMERIC(15,3) NOT NULL,
	BB_R52_UNITS INTEGER NOT NULL,
	BB_R52_TXNS INTEGER NOT NULL,
	BB_R52_VISITS INTEGER NOT NULL,
	BB_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	SA_R52_SALES NUMERIC(15,3) NOT NULL,
	SA_R52_UNITS INTEGER NOT NULL,
	SA_R52_TXNS INTEGER NOT NULL,
	SA_R52_VISITS INTEGER NOT NULL,
	SA_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	AO_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_R52_UNITS INTEGER NOT NULL,
	AO_R52_TXNS INTEGER NOT NULL,
	AO_R52_VISITS INTEGER NOT NULL,
	AO_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	CTG_FSG_FURM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_FURM_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_FURM_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_FURM_R52_VISITS INTEGER NOT NULL,
	CTG_BB_FURM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_BB_FURM_R52_UNITS INTEGER NOT NULL,
	CTG_BB_FURM_R52_TXNS INTEGER NOT NULL,
	CTG_BB_FURM_R52_VISITS INTEGER NOT NULL,
	CTG_TTL_FURM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_TTL_FURM_R52_UNITS INTEGER NOT NULL,
	CTG_TTL_FURM_R52_TXNS INTEGER NOT NULL,
	CTG_TTL_FURM_R52_VISITS INTEGER NOT NULL,
	CTG_AO_NAIL_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_NAIL_R52_UNITS INTEGER NOT NULL,
	CTG_AO_NAIL_R52_TXNS INTEGER NOT NULL,
	CTG_AO_NAIL_R52_VISITS INTEGER NOT NULL,
	CTG_AO_CHI_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_CHI_R52_UNITS INTEGER NOT NULL,
	CTG_AO_CHI_R52_TXNS INTEGER NOT NULL,
	CTG_AO_CHI_R52_VISITS INTEGER NOT NULL,
	CTG_AO_TEETH_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_TEETH_R52_UNITS INTEGER NOT NULL,
	CTG_AO_TEETH_R52_TXNS INTEGER NOT NULL,
	CTG_AO_TEETH_R52_VISITS INTEGER NOT NULL,
	CTG_AO_TOP_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_TOP_R52_UNITS INTEGER NOT NULL,
	CTG_AO_TOP_R52_TXNS INTEGER NOT NULL,
	CTG_AO_TOP_R52_VISITS INTEGER NOT NULL,
	CTG_AO_HEMPZ_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_HEMPZ_R52_UNITS INTEGER NOT NULL,
	CTG_AO_HEMPZ_R52_TXNS INTEGER NOT NULL,
	CTG_AO_HEMPZ_R52_VISITS INTEGER NOT NULL,
	CTG_BB_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_BB_R52_UNITS INTEGER NOT NULL,
	CTG_BB_R52_TXNS INTEGER NOT NULL,
	CTG_BB_R52_VISITS INTEGER NOT NULL,
	CTG_BB_PUPPY_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_BB_PUPPY_R52_UNITS INTEGER NOT NULL,
	CTG_BB_PUPPY_R52_TXNS INTEGER NOT NULL,
	CTG_BB_PUPPY_R52_VISITS INTEGER NOT NULL,
	CTG_BB_CAT_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_BB_CAT_R52_UNITS INTEGER NOT NULL,
	CTG_BB_CAT_R52_TXNS INTEGER NOT NULL,
	CTG_BB_CAT_R52_VISITS INTEGER NOT NULL,
	CTG_FSG_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_R52_VISITS INTEGER NOT NULL,
	CTG_FSG_CAT_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_CAT_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_CAT_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_CAT_R52_VISITS INTEGER NOT NULL,
	CTG_FSG_PUPPY_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_PUPPY_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_PUPPY_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_PUPPY_R52_VISITS INTEGER NOT NULL,
	CTG_FSG_PREM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_PREM_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_PREM_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_PREM_R52_VISITS INTEGER NOT NULL,
	CTG_SA_NAIL_TRIM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_SA_NAIL_TRIM_R52_UNITS INTEGER NOT NULL,
	CTG_SA_NAIL_TRIM_R52_TXNS INTEGER NOT NULL,
	CTG_SA_NAIL_TRIM_R52_VISITS INTEGER NOT NULL,
	CTG_SA_PAWDICURE_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_SA_PAWDICURE_R52_UNITS INTEGER NOT NULL,
	CTG_SA_PAWDICURE_R52_TXNS INTEGER NOT NULL,
	CTG_SA_PAWDICURE_R52_VISITS INTEGER NOT NULL,
	AO_NON_PCKG_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_NON_PCKG_R52_UNITS INTEGER NOT NULL,
	AO_NON_PCKG_R52_TXNS INTEGER NOT NULL,
	AO_NON_PCKG_R52_VISITS INTEGER NOT NULL,
	AO_PCKG_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_PCKG_R52_UNITS INTEGER NOT NULL,
	AO_PCKG_R52_TXNS INTEGER NOT NULL,
	AO_PCKG_R52_VISITS INTEGER NOT NULL,
	AO_POP_PCKG_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_POP_PCKG_R52_UNITS INTEGER NOT NULL,
	AO_POP_PCKG_R52_TXNS INTEGER NOT NULL,
	AO_POP_PCKG_R52_VISITS INTEGER NOT NULL,
	AO_PREM_PCKG_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_PREM_PCKG_R52_UNITS INTEGER NOT NULL,
	AO_PREM_PCKG_R52_TXNS INTEGER NOT NULL,
	AO_PREM_PCKG_R52_VISITS INTEGER NOT NULL,
	DDC_R52_SALES NUMERIC(15,3) NOT NULL,
	DDC_R52_UNITS INTEGER NOT NULL,
	DDC_R52_TXNS INTEGER NOT NULL,
	DDC_R52_VISITS INTEGER NOT NULL,
	OVERNIGHT_R52_SALES NUMERIC(15,3) NOT NULL,
	OVERNIGHT_R52_UNITS INTEGER NOT NULL,
	OVERNIGHT_R52_TXNS INTEGER NOT NULL,
	OVERNIGHT_R52_VISITS INTEGER NOT NULL,
	HOTEL_BATH_R52_SALES NUMERIC(15,3) NOT NULL,
	HOTEL_BATH_R52_UNITS INTEGER NOT NULL,
	HOTEL_BATH_R52_TXNS INTEGER NOT NULL,
	HOTEL_BATH_R52_VISITS INTEGER NOT NULL,
	TRAINING_R52_SALES NUMERIC(15,3) NOT NULL,
	TRAINING_R52_UNITS INTEGER NOT NULL,
	TRAINING_R52_TXNS INTEGER NOT NULL,
	TRAINING_R52_VISITS INTEGER NOT NULL
)
DISTRIBUTE ON (CUSTOMER_EID);


CREATE TABLE KEDWARDS.SALON_CUST_SALES_R52_PRE_PRE1
(
	CUSTOMER_EID NUMERIC(19,0) NOT NULL,
	DAY_DT DATE NOT NULL,
	PETM_R52_SALES NUMERIC(15,3) NOT NULL,
	PETM_R52_UNITS INTEGER NOT NULL,
	PETM_R52_TXNS INTEGER NOT NULL,
	PETM_R52_VISITS INTEGER NOT NULL,
	NON_SALON_R52_SALES NUMERIC(15,3) NOT NULL,
	NON_SALON_R52_UNITS INTEGER NOT NULL,
	NON_SALON_R52_TXNS INTEGER NOT NULL,
	NON_SALON_R52_VISITS INTEGER NOT NULL,
	CORE_R52_SALES NUMERIC(15,3) NOT NULL,
	CORE_R52_UNITS INTEGER NOT NULL,
	CORE_R52_TXNS INTEGER NOT NULL,
	CORE_R52_VISITS INTEGER NOT NULL
)
DISTRIBUTE ON (CUSTOMER_EID);

ALTER TABLE KEDWARDS.SALON_CUST_SALES_R52_PRE_PRE1
ADD CONSTRAINT SALON_CUST_SALES_R52_PRE_PRE1_PK
PRIMARY KEY (CUSTOMER_EID, DAY_DT);



CREATE TABLE KEDWARDS.SALON_CUST_SALES_R52_PRE_PRE2
(
	CUSTOMER_EID NUMERIC(19,0) NOT NULL,
	DAY_DT DATE NOT NULL,
	SALON_R52_SALES NUMERIC(15,3) NOT NULL,
	SALON_R52_UNITS INTEGER NOT NULL,
	SALON_R52_TXNS INTEGER NOT NULL,
	SALON_R52_VISITS INTEGER NOT NULL,
	SALON_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	SALON_R52_MON_VISITS INTEGER NOT NULL,
	SALON_R52_TUE_VISITS INTEGER NOT NULL,
	SALON_R52_WED_VISITS INTEGER NOT NULL,
	SALON_R52_THU_VISITS INTEGER NOT NULL,
	SALON_R52_FRI_VISITS INTEGER NOT NULL,
	SALON_R52_SAT_VISITS INTEGER NOT NULL,
	SALON_R52_SUN_VISITS INTEGER NOT NULL,
	FSG_R52_SALES NUMERIC(15,3) NOT NULL,
	FSG_R52_UNITS INTEGER NOT NULL,
	FSG_R52_TXNS INTEGER NOT NULL,
	FSG_R52_VISITS INTEGER NOT NULL,
	FSG_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	BB_R52_SALES NUMERIC(15,3) NOT NULL,
	BB_R52_UNITS INTEGER NOT NULL,
	BB_R52_TXNS INTEGER NOT NULL,
	BB_R52_VISITS INTEGER NOT NULL,
	BB_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	SA_R52_SALES NUMERIC(15,3) NOT NULL,
	SA_R52_UNITS INTEGER NOT NULL,
	SA_R52_TXNS INTEGER NOT NULL,
	SA_R52_VISITS INTEGER NOT NULL,
	SA_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	AO_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_R52_UNITS INTEGER NOT NULL,
	AO_R52_TXNS INTEGER NOT NULL,
	AO_R52_VISITS INTEGER NOT NULL,
	AO_R52_DISCOUNT_VISITS INTEGER NOT NULL,
	CTG_FSG_FURM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_FURM_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_FURM_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_FURM_R52_VISITS INTEGER NOT NULL,
	CTG_BB_FURM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_BB_FURM_R52_UNITS INTEGER NOT NULL,
	CTG_BB_FURM_R52_TXNS INTEGER NOT NULL,
	CTG_BB_FURM_R52_VISITS INTEGER NOT NULL,
	CTG_TTL_FURM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_TTL_FURM_R52_UNITS INTEGER NOT NULL,
	CTG_TTL_FURM_R52_TXNS INTEGER NOT NULL,
	CTG_TTL_FURM_R52_VISITS INTEGER NOT NULL,
	CTG_AO_NAIL_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_NAIL_R52_UNITS INTEGER NOT NULL,
	CTG_AO_NAIL_R52_TXNS INTEGER NOT NULL,
	CTG_AO_NAIL_R52_VISITS INTEGER NOT NULL,
	CTG_AO_CHI_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_CHI_R52_UNITS INTEGER NOT NULL,
	CTG_AO_CHI_R52_TXNS INTEGER NOT NULL,
	CTG_AO_CHI_R52_VISITS INTEGER NOT NULL,
	CTG_AO_TEETH_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_TEETH_R52_UNITS INTEGER NOT NULL,
	CTG_AO_TEETH_R52_TXNS INTEGER NOT NULL,
	CTG_AO_TEETH_R52_VISITS INTEGER NOT NULL,
	CTG_AO_TOP_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_TOP_R52_UNITS INTEGER NOT NULL,
	CTG_AO_TOP_R52_TXNS INTEGER NOT NULL,
	CTG_AO_TOP_R52_VISITS INTEGER NOT NULL,
	CTG_AO_HEMPZ_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_AO_HEMPZ_R52_UNITS INTEGER NOT NULL,
	CTG_AO_HEMPZ_R52_TXNS INTEGER NOT NULL,
	CTG_AO_HEMPZ_R52_VISITS INTEGER NOT NULL,
	CTG_BB_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_BB_R52_UNITS INTEGER NOT NULL,
	CTG_BB_R52_TXNS INTEGER NOT NULL,
	CTG_BB_R52_VISITS INTEGER NOT NULL,
	CTG_BB_PUPPY_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_BB_PUPPY_R52_UNITS INTEGER NOT NULL,
	CTG_BB_PUPPY_R52_TXNS INTEGER NOT NULL,
	CTG_BB_PUPPY_R52_VISITS INTEGER NOT NULL,
	CTG_BB_CAT_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_BB_CAT_R52_UNITS INTEGER NOT NULL,
	CTG_BB_CAT_R52_TXNS INTEGER NOT NULL,
	CTG_BB_CAT_R52_VISITS INTEGER NOT NULL,
	CTG_FSG_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_R52_VISITS INTEGER NOT NULL,
	CTG_FSG_CAT_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_CAT_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_CAT_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_CAT_R52_VISITS INTEGER NOT NULL,
	CTG_FSG_PUPPY_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_PUPPY_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_PUPPY_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_PUPPY_R52_VISITS INTEGER NOT NULL,
	CTG_FSG_PREM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_FSG_PREM_R52_UNITS INTEGER NOT NULL,
	CTG_FSG_PREM_R52_TXNS INTEGER NOT NULL,
	CTG_FSG_PREM_R52_VISITS INTEGER NOT NULL,
	CTG_SA_NAIL_TRIM_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_SA_NAIL_TRIM_R52_UNITS INTEGER NOT NULL,
	CTG_SA_NAIL_TRIM_R52_TXNS INTEGER NOT NULL,
	CTG_SA_NAIL_TRIM_R52_VISITS INTEGER NOT NULL,
	CTG_SA_PAWDICURE_R52_SALES NUMERIC(15,3) NOT NULL,
	CTG_SA_PAWDICURE_R52_UNITS INTEGER NOT NULL,
	CTG_SA_PAWDICURE_R52_TXNS INTEGER NOT NULL,
	CTG_SA_PAWDICURE_R52_VISITS INTEGER NOT NULL,
	AO_NON_PCKG_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_NON_PCKG_R52_UNITS INTEGER NOT NULL,
	AO_NON_PCKG_R52_TXNS INTEGER NOT NULL,
	AO_NON_PCKG_R52_VISITS INTEGER NOT NULL,
	AO_PCKG_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_PCKG_R52_UNITS INTEGER NOT NULL,
	AO_PCKG_R52_TXNS INTEGER NOT NULL,
	AO_PCKG_R52_VISITS INTEGER NOT NULL,
	AO_POP_PCKG_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_POP_PCKG_R52_UNITS INTEGER NOT NULL,
	AO_POP_PCKG_R52_TXNS INTEGER NOT NULL,
	AO_POP_PCKG_R52_VISITS INTEGER NOT NULL,
	AO_PREM_PCKG_R52_SALES NUMERIC(15,3) NOT NULL,
	AO_PREM_PCKG_R52_UNITS INTEGER NOT NULL,
	AO_PREM_PCKG_R52_TXNS INTEGER NOT NULL,
	AO_PREM_PCKG_R52_VISITS INTEGER NOT NULL,
	DDC_R52_SALES NUMERIC(15,3) NOT NULL,
	DDC_R52_UNITS INTEGER NOT NULL,
	DDC_R52_TXNS INTEGER NOT NULL,
	DDC_R52_VISITS INTEGER NOT NULL,
	OVERNIGHT_R52_SALES NUMERIC(15,3) NOT NULL,
	OVERNIGHT_R52_UNITS INTEGER NOT NULL,
	OVERNIGHT_R52_TXNS INTEGER NOT NULL,
	OVERNIGHT_R52_VISITS INTEGER NOT NULL,
	HOTEL_BATH_R52_SALES NUMERIC(15,3) NOT NULL,
	HOTEL_BATH_R52_UNITS INTEGER NOT NULL,
	HOTEL_BATH_R52_TXNS INTEGER NOT NULL,
	HOTEL_BATH_R52_VISITS INTEGER NOT NULL,
	TRAINING_R52_SALES NUMERIC(15,3) NOT NULL,
	TRAINING_R52_UNITS INTEGER NOT NULL,
	TRAINING_R52_TXNS INTEGER NOT NULL,
	TRAINING_R52_VISITS INTEGER NOT NULL
)
DISTRIBUTE ON (CUSTOMER_EID);

ALTER TABLE KEDWARDS.SALON_CUST_SALES_R52_PRE_PRE2
ADD CONSTRAINT SALON_CUST_SALES_R52_PRE_PRE2_PK
PRIMARY KEY (CUSTOMER_EID, DAY_DT);



CREATE TABLE KEDWARDS.SALON_CUST_SALES_TRANS_SKU_PRE
(
	CUSTOMER_EID NUMERIC(19,0) NOT NULL,
	DAY_DT DATE NOT NULL,
	SALES_INSTANCE_ID_DIST_KEY BIGINT NOT NULL,
	PRODUCT_ID INTEGER NOT NULL,
	SALES_INSTANCE_ID BIGINT,
	LOCATION_ID INTEGER,
	NET_SALES_AMT NUMERIC(10,2),
	NET_SALES_QTY INTEGER,
	EXCH_RATE_PCT NUMERIC(9,6),
	DISCOUNT_IND BYTEINT NOT NULL,
	SALON_IND BYTEINT NOT NULL,
	NON_SALON_IND BYTEINT NOT NULL,
	CORE_IND BYTEINT NOT NULL,
	FSG_IND BYTEINT NOT NULL,
	BB_IND BYTEINT NOT NULL,
	SA_IND BYTEINT NOT NULL,
	AO_IND BYTEINT NOT NULL,
	CTG_FSG_FURM_IND BYTEINT NOT NULL,
	CTG_BB_FURM_IND BYTEINT NOT NULL,
	CTG_TTL_FURM_IND BYTEINT NOT NULL,
	CTG_AO_NAIL_IND BYTEINT NOT NULL,
	CTG_AO_CHI_IND BYTEINT NOT NULL,
	CTG_AO_TEETH_IND BYTEINT NOT NULL,
	CTG_AO_TOP_IND BYTEINT NOT NULL,
	CTG_AO_HEMPZ_IND BYTEINT NOT NULL,
	CTG_BB_IND BYTEINT NOT NULL,
	CTG_BB_PUPPY_IND BYTEINT NOT NULL,
	CTG_BB_CAT_IND BYTEINT NOT NULL,
	CTG_FSG_IND BYTEINT NOT NULL,
	CTG_FSG_CAT_IND BYTEINT NOT NULL,
	CTG_FSG_PUPPY_IND BYTEINT NOT NULL,
	CTG_FSG_PREM_IND BYTEINT NOT NULL,
	CTG_SA_NAIL_TRIM_IND BYTEINT NOT NULL,
	CTG_SA_PAWDICURE_IND BYTEINT NOT NULL,
	AO_NON_PCKG_IND BYTEINT NOT NULL,
	AO_PCKG_IND BYTEINT NOT NULL,
	AO_POP_PCKG_IND BYTEINT NOT NULL,
	AO_PREM_PCKG_IND BYTEINT NOT NULL,
	DDC_IND BYTEINT NOT NULL,
	OVERNIGHT_IND BYTEINT NOT NULL,
	HOTEL_BATH_IND BYTEINT NOT NULL,
	TRAINING_IND BYTEINT NOT NULL,
	BREED_NAME CHARACTER VARYING(50),
	NEED_LEVEL CHARACTER VARYING(1),
	SHED_LEVEL CHARACTER VARYING(1),
	COAT_TYPE CHARACTER VARYING(25),
	SIZE CHARACTER VARYING(2)
)
DISTRIBUTE ON (CUSTOMER_EID);

ALTER TABLE KEDWARDS.SALON_CUST_SALES_TRANS_SKU_PRE
ADD CONSTRAINT SALON_CUST_SALES_TRANS_SKU_PRE_PK
PRIMARY KEY (DAY_DT, SALES_INSTANCE_ID_DIST_KEY, PRODUCT_ID);



CREATE TABLE KEDWARDS.SALON_CUST_STORE_PREF_PRE
(
	CUSTOMER_EID NUMERIC(19,0) NOT NULL,
	PERIOD_START_DT DATE NOT NULL,
	PERIOD_END_DT DATE NOT NULL,
	TTL_SALON_R52_SALES NUMERIC(15,3),
	TTL_NON_SALON_R52_SALES NUMERIC(15,6),
	PRIMARY_SALON_LOCATION_ID INTEGER,
	PRIMARY_SALON_R52_SALES NUMERIC(15,3),
	PRIMARY_SALON_R52_SALES_PCT NUMERIC(15,6),
	SECONDARY_SALON_LOCATION_ID INTEGER,
	SECONDARY_SALON_R52_SALES NUMERIC(15,3),
	SECONDARY_SALON_R52_SALES_PCT NUMERIC(15,3),
	PRIMARY_NON_SALON_LOCATION_ID INTEGER,
	PRIMARY_NON_SALON_R52_SALES NUMERIC(15,3),
	PRIMARY_NON_SALON_R52_SALES_PCT NUMERIC(15,6)
)
DISTRIBUTE ON (CUSTOMER_EID);

ALTER TABLE KEDWARDS.SALON_CUST_STORE_PREF_PRE
ADD CONSTRAINT SALON_CUST_STORE_PREF_PRE_PK1
PRIMARY KEY (CUSTOMER_EID, PERIOD_START_DT, PERIOD_END_DT);



CREATE TABLE KEDWARDS.SALON_FISCAL_MO
(
	PERIOD_END_FISCAL_MO INTEGER NOT NULL,
	PERIOD_START_DT DATE NOT NULL,
	PERIOD_END_DT DATE NOT NULL,
	PERIOD_START_FISCAL_WK INTEGER NOT NULL,
	PERIOD_END_FISCAL_WK INTEGER NOT NULL,
	LY_PERIOD_START_DT DATE NOT NULL,
	LY_PERIOD_END_DT DATE NOT NULL,
	EXEC_SEQ INTEGER NOT NULL,
	CURRENT_PERIOD_IND BYTEINT NOT NULL
)
DISTRIBUTE ON (PERIOD_END_FISCAL_MO);

ALTER TABLE KEDWARDS.SALON_FISCAL_MO
ADD CONSTRAINT SALON_FISCAL_MO_PK
PRIMARY KEY (PERIOD_END_FISCAL_MO);



CREATE TABLE KEDWARDS.SALON_PRODUCT_GROUP
(
	PRODUCT_GROUP CHARACTER VARYING(25),
	PRODUCT_ID INTEGER NOT NULL
)
DISTRIBUTE ON (PRODUCT_ID);


CREATE TABLE KEDWARDS.SALON_SKU_PROFILE_RPT
(
	PRODUCT_ID INTEGER NOT NULL,
	SALON_IND BYTEINT NOT NULL,
	NON_SALON_IND BYTEINT NOT NULL,
	CORE_IND BYTEINT NOT NULL,
	FSG_IND BYTEINT NOT NULL,
	BB_IND BYTEINT NOT NULL,
	SA_IND BYTEINT NOT NULL,
	AO_IND BYTEINT NOT NULL,
	CTG_FSG_FURM_IND BYTEINT NOT NULL,
	CTG_BB_FURM_IND BYTEINT NOT NULL,
	CTG_TTL_FURM_IND BYTEINT NOT NULL,
	CTG_AO_NAIL_IND BYTEINT NOT NULL,
	CTG_AO_CHI_IND BYTEINT NOT NULL,
	CTG_AO_TEETH_IND BYTEINT NOT NULL,
	CTG_AO_TOP_IND BYTEINT NOT NULL,
	CTG_AO_HEMPZ_IND BYTEINT NOT NULL,
	CTG_BB_IND BYTEINT NOT NULL,
	CTG_BB_PUPPY_IND BYTEINT NOT NULL,
	CTG_BB_CAT_IND BYTEINT NOT NULL,
	CTG_FSG_IND BYTEINT NOT NULL,
	CTG_FSG_CAT_IND BYTEINT NOT NULL,
	CTG_FSG_PUPPY_IND BYTEINT NOT NULL,
	CTG_FSG_PREM_IND BYTEINT NOT NULL,
	CTG_SA_NAIL_TRIM_IND BYTEINT NOT NULL,
	CTG_SA_PAWDICURE_IND BYTEINT NOT NULL,
	AO_NON_PCKG_IND BYTEINT NOT NULL,
	AO_PCKG_IND BYTEINT NOT NULL,
	AO_POP_PCKG_IND BYTEINT NOT NULL,
	AO_PREM_PCKG_IND BYTEINT NOT NULL,
	DDC_IND BYTEINT NOT NULL,
	OVERNIGHT_IND BYTEINT NOT NULL,
	HOTEL_BATH_IND BYTEINT NOT NULL,
	TRAINING_IND BYTEINT NOT NULL,
	BREED_NAME CHARACTER VARYING(50),
	NEED_LEVEL CHARACTER VARYING(1),
	SHED_LEVEL CHARACTER VARYING(1),
	COAT_TYPE CHARACTER VARYING(25),
	SIZE CHARACTER VARYING(2)
)
DISTRIBUTE ON (PRODUCT_ID);

ALTER TABLE KEDWARDS.SALON_SKU_PROFILE_RPT
ADD CONSTRAINT SALON_SKU_PROFILE_RPT_PK
PRIMARY KEY (PRODUCT_ID);



CREATE TABLE KEDWARDS.UPT_BUCKET
(
	UPT_BUCKET_ID INTEGER NOT NULL,
	UPT_BUCKET_DESC CHARACTER VARYING(20) NOT NULL,
	UPDATE_TSTMP TIMESTAMP NOT NULL,
	LOAD_TSTMP TIMESTAMP NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.UPT_BUCKET
ADD CONSTRAINT UPT_BUCKET_PK
PRIMARY KEY (UPT_BUCKET_ID);



CREATE TABLE KEDWARDS.UPT_BUCKET_ELEMENT
(
	UPT_BUCKET_ID INTEGER NOT NULL,
	UPT_BUCKET_ELEMENT_DESC CHARACTER VARYING(20) NOT NULL,
	UPT_START INTEGER NOT NULL,
	UPT_END INTEGER NOT NULL,
	UPT_BUCKET_ELEMENT_SORT_ID INTEGER NOT NULL,
	UPDATE_TSTMP TIMESTAMP NOT NULL,
	LOAD_TSTMP TIMESTAMP NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.UPT_BUCKET_ELEMENT
ADD CONSTRAINT UPT_BUCKET_ELEMENT_PK
PRIMARY KEY (UPT_BUCKET_ID);



CREATE TABLE KEDWARDS.UPT_DATA
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	SIZE_ID SMALLINT NOT NULL,
	CA_STORE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_WEEK_CNT INTEGER NOT NULL,
	TY_LY_FLAG CHARACTER VARYING(2) NOT NULL,
	CA_CUST_GROUP_COHORT_ID INTEGER NOT NULL,
	CA_TXN_GROUP_COHORT_ID INTEGER NOT NULL,
	CURRENCY_TYPE_ID BYTEINT NOT NULL,
	UPT_BUCKET_ID INTEGER NOT NULL,
	UPT_BUCKET_ELEMENT_DESC CHARACTER VARYING(20) NOT NULL,
	UPT_BUCKET_ELEMENT_SORT_ID INTEGER NOT NULL,
	TXNS NUMERIC(12,2),
	NET_SALES_AMT NUMERIC(15,3),
	NET_SALES_QTY NUMERIC(12,2),
	NET_MARGIN_AMT NUMERIC(15,3)
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.UPT_DATA
ADD CONSTRAINT UPT_DATA_PK
PRIMARY KEY (CA_PRODUCT_GROUP_ID, CA_STORE_GROUP_ID, CA_DATE_GROUP_ID, TY_LY_FLAG, CA_CUST_GROUP_COHORT_ID, CA_TXN_GROUP_COHORT_ID, CURRENCY_TYPE_ID);



CREATE TABLE KEDWARDS.UPT_DATA_PREP_DG
(
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	START_DAY_DT DATE NOT NULL,
	END_DAY_DT DATE NOT NULL,
	WEEK_CNT NUMERIC(8,4) NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.UPT_DATA_PREP_DG
ADD CONSTRAINT UPT_DATA_PREP_DG_PK
PRIMARY KEY (CA_DATE_GROUP_ID);



CREATE TABLE KEDWARDS.UPT_DATA_PREP_PG_SKU
(
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	SIZE CHARACTER VARYING(10) NOT NULL,
	PRODUCT_ID INTEGER NOT NULL
)
DISTRIBUTE ON (PRODUCT_ID);


CREATE TABLE KEDWARDS.USR_ALT_CONSUMABLE_HIERARCHY
(
	SAP_DIVISION_ID INTEGER,
	SAP_DIVISION_DESC CHARACTER VARYING(40),
	SAP_DEPT_ID INTEGER,
	SAP_DEPT_DESC CHARACTER VARYING(40),
	SAP_CLASS_ID INTEGER,
	SAP_CLASS_DESC CHARACTER VARYING(40),
	SAP_CATEGORY_ID INTEGER NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.USR_ALT_CONSUMABLE_HIERARCHY
ADD CONSTRAINT USR_ALT_CONSUMABLE_HIERARCHY_PK
PRIMARY KEY (SAP_CATEGORY_ID);



CREATE TABLE KEDWARDS.USR_EXCLUSION_EXCEPTIONS
(
	SAP_CATEGORY_ID INTEGER NOT NULL,
	EXCEPTION_REASON CHARACTER VARYING(100),
	UPDATE_TSTMP TIMESTAMP,
	LOAD_TSTMP TIMESTAMP
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.USR_EXCLUSION_EXCEPTIONS
ADD CONSTRAINT USR_EXCLUSION_EXCEPTIONS_PK
PRIMARY KEY (SAP_CATEGORY_ID);



CREATE TABLE KEDWARDS.USR_GLOSSARY
(
	GLOSSARY_CD CHARACTER VARYING(25) NOT NULL,
	GLOSSARY_ITEM_ID INTEGER NOT NULL,
	GLOSSARY_ITEM_NAME CHARACTER VARYING(50) NOT NULL,
	GLOSSARY_ITEM_DESC CHARACTER VARYING(250) NOT NULL,
	GLOSSARY_ITEM_LONG_DESC CHARACTER VARYING(500) NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.USR_GLOSSARY
ADD CONSTRAINT USR_GLOSSARY_PK
PRIMARY KEY (GLOSSARY_ITEM_ID);



CREATE TABLE KEDWARDS.USR_MB_CHERRY_PICK_SKU_CTRL
(
	VP_ID INTEGER,
	SAP_DIVISION_ID INTEGER,
	SAP_DEPT_ID INTEGER,
	SAP_CLASS_ID INTEGER,
	SAP_CATEGORY_ID INTEGER,
	PRODUCT_ID INTEGER,
	CHERRY_PICK_SKU_IND BYTEINT
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.USR_MP_LEAKAGE_GRID
(
	COLUMN_ID CHARACTER VARYING(2) NOT NULL,
	ROW_ID SMALLINT NOT NULL,
	FORMATTING CHARACTER VARYING(25) NOT NULL,
	METRIC_VALUE CHARACTER VARYING(50) NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.USR_MP_LEAKAGE_GRID
ADD CONSTRAINT USR_MP_LEAKAGE_GRID_PK
PRIMARY KEY (COLUMN_ID, ROW_ID);



CREATE TABLE KEDWARDS.USR_MP_MARKETSHARE_CHANNEL_CTRL
(
	FINAL_MP_CHANNEL_ID INTEGER NOT NULL,
	MP_CHANNEL_ID INTEGER NOT NULL,
	MULTIPLY_FACTOR SMALLINT NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.USR_MP_MARKETSHARE_CHANNEL_CTRL
ADD CONSTRAINT USR_MP_MARKETSHARE_CHANNEL_CTRL_PK
PRIMARY KEY (FINAL_MP_CHANNEL_ID);



CREATE TABLE KEDWARDS.USR_MP_PROD_CTRL
(
	PROD_PANEL CHARACTER VARYING(50) NOT NULL,
	PROD_NLR CHARACTER VARYING(50),
	PROD_NLR_PETM CHARACTER VARYING(50),
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	UPDATE_TSTMP TIMESTAMP NOT NULL,
	LOAD_TSTMP TIMESTAMP NOT NULL
)
DISTRIBUTE ON RANDOM;

ALTER TABLE KEDWARDS.USR_MP_PROD_CTRL
ADD CONSTRAINT USR_MP_PROD_CTRL_PK
PRIMARY KEY (PROD_PANEL);



CREATE TABLE KEDWARDS.USR_PLANNER_AVG_WEEKLY
(
	CA_DATE_GROUP_ID INTEGER NOT NULL,
	CA_DATE_GROUP_DESC CHARACTER VARYING(50),
	CA_DATE_GROUP_DESC2 CHARACTER VARYING(50),
	CA_DATE_GROUP_LONG_DESC CHARACTER VARYING(250),
	CA_DATE_GROUP_SORT_ID INTEGER,
	START_FISCAL_WK INTEGER,
	END_FISCAL_WK INTEGER,
	MTH_NBR INTEGER
)
DISTRIBUTE ON (CA_DATE_GROUP_ID);

ALTER TABLE KEDWARDS.USR_PLANNER_AVG_WEEKLY
ADD CONSTRAINT USR_PLANNER_AVG_WEEKLY_PK
PRIMARY KEY (CA_DATE_GROUP_ID);



CREATE TABLE KEDWARDS.USR_SALON_SKU_ATTRIBUTE
(
	SKU_NBR INTEGER NOT NULL,
	BREED_NAME CHARACTER VARYING(50),
	NEED_LEVEL CHARACTER VARYING(1),
	SHED_LEVEL CHARACTER VARYING(1),
	COAT_TYPE CHARACTER VARYING(25),
	SIZE CHARACTER VARYING(2),
	AO_PCKG_IND BYTEINT,
	AO_PREM_PCKG_IND BYTEINT
)
DISTRIBUTE ON (SKU_NBR);

ALTER TABLE KEDWARDS.USR_SALON_SKU_ATTRIBUTE
ADD CONSTRAINT USR_SALON_SKU_ATTRIBUTE_PK1
PRIMARY KEY (SKU_NBR);



CREATE TABLE KEDWARDS.Z_MASKED_PG
(
	CA_PRODUCT_GROUP_TYPE_ID BYTEINT NOT NULL,
	CA_PRODUCT_GROUP_TYPE_DESC NATIONAL CHARACTER VARYING(8) NOT NULL,
	CA_PRODUCT_GROUP_ID INTEGER NOT NULL,
	CA_PRODUCT_GROUP_DESC NATIONAL CHARACTER VARYING(43) NOT NULL,
	CA_PRODUCT_GROUP_DESC2 NATIONAL CHARACTER VARYING(4) NOT NULL,
	CA_PRODUCT_GROUP_DESC3 NATIONAL CHARACTER VARYING(34) NOT NULL,
	CA_PRODUCT_GROUP_LONG_DESC NATIONAL CHARACTER VARYING(43) NOT NULL
)
DISTRIBUTE ON RANDOM;


CREATE TABLE KEDWARDS.Z_PODS_PHONE
(
	CUSTOMER_EID BIGINT NOT NULL,
	PODS_PHONE_IND INTEGER
)
DISTRIBUTE ON (CUSTOMER_EID);


CREATE TABLE KEDWARDS.Z_PODS_PHONE_PRE
(
	CUSTOMER_EID BIGINT NOT NULL,
	PHONE_NBR_1 CHARACTER VARYING(20),
	PHONE_NBR_2 CHARACTER VARYING(20),
	PHONE_NBR_3 CHARACTER VARYING(20),
	PHONE_NBR_4 CHARACTER VARYING(20),
	PHONE_NBR_5 CHARACTER VARYING(20),
	PODS_PHONE_IND INTEGER
)
DISTRIBUTE ON (CUSTOMER_EID);


CREATE TABLE KEDWARDS.Z_PODS_PHONE_PRE2
(
	CUSTOMER_EID BIGINT NOT NULL,
	PHONE_NBR CHARACTER VARYING(20) NOT NULL
)
DISTRIBUTE ON (CUSTOMER_EID);


CREATE TABLE KEDWARDS.Z_PODS_PHONE_PRE3
(
	CUSTOMER_EID BIGINT NOT NULL,
	PHONE_NBR CHARACTER VARYING(20),
	PODS_PHONE_IND INTEGER
)
DISTRIBUTE ON (CUSTOMER_EID);


CREATE TABLE KEDWARDS.Z_VIEW_SEARCH
(
	VIEW_NAME CHARACTER VARYING(100),
	VIEW_NAME_SEARCH CHARACTER VARYING(100)
)
DISTRIBUTE ON RANDOM;


CREATE TABLE MSTRLOADER.DM_CA_TXN_LIST_245
(
	SALES_INSTANCE_ID BIGINT,
	WJXBFS1 CHARACTER VARYING(128)
)
DISTRIBUTE ON RANDOM;


