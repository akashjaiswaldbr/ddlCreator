




--*****  Creating table:  "DAYS" , ***** Creating table: "DAYS"


use legacy;
 CREATE TABLE DAYS 
(
 DAY_DT                                    TIMESTAMP                            not null

, BUSINESS_DAY_FLAG                         STRING 

, HOLIDAY_FLAG                              STRING 

, DAY_OF_WK_NAME                            STRING 

, DAY_OF_WK_NAME_ABBR                       STRING 

, DAY_OF_WK_NBR TINYINT

, CAL_DAY_OF_MO_NBR TINYINT

, CAL_DAY_OF_YR_NBR SMALLINT

, CAL_WK INT

, CAL_WK_NBR TINYINT

, CAL_MO INT

, CAL_MO_NBR TINYINT

, CAL_MO_NAME                               STRING 

, CAL_MO_NAME_ABBR                          STRING 

, CAL_QTR INT

, CAL_QTR_NBR TINYINT

, CAL_HALF INT

, CAL_YR SMALLINT

, FISCAL_DAY_OF_MO_NBR TINYINT

, FISCAL_DAY_OF_YR_NBR SMALLINT

, FISCAL_WK INT

, FISCAL_WK_NBR TINYINT

, FISCAL_MO INT

, FISCAL_MO_NBR TINYINT

, FISCAL_MO_NAME                            STRING 

, FISCAL_MO_NAME_ABBR                       STRING 

, FISCAL_QTR INT

, FISCAL_QTR_NBR TINYINT

, FISCAL_HALF INT

, FISCAL_YR SMALLINT

, LYR_WEEK_DT                               TIMESTAMP                            not null

, LWK_WEEK_DT                               TIMESTAMP                            not null

, WEEK_DT                                   TIMESTAMP                            not null

, EST_TIME_CONV_AMT                         DECIMAL(6,6)                         not null  

, EST_TIME_CONV_HRS TINYINT not null 

, ES0_TIME_CONV_AMT                         DECIMAL(6,6)                         not null  

, ES0_TIME_CONV_HRS TINYINT not null 

, CST_TIME_CONV_AMT                         DECIMAL(6,6)                         not null  

, CST_TIME_CONV_HRS TINYINT not null 

, CS0_TIME_CONV_AMT                         DECIMAL(6,6)                         not null  

, CS0_TIME_CONV_HRS TINYINT not null 

, MST_TIME_CONV_AMT                         DECIMAL(6,6)                         not null  

, MST_TIME_CONV_HRS TINYINT not null 

, MS0_TIME_CONV_AMT                         DECIMAL(6,6)                         not null  

, MS0_TIME_CONV_HRS TINYINT not null 

, PST_TIME_CONV_AMT                         DECIMAL(6,6)                         not null  

, PST_TIME_CONV_HRS TINYINT not null 

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/days';

--DISTRIBUTE ON (DAY_DT)







--*****  Creating table:  "DM_DEPT_SEGMENTS" , ***** Creating table: "DM_DEPT_SEGMENTS"


use legacy;
 CREATE TABLE DM_DEPT_SEGMENTS 
(
 SAP_DEPT_ID INT not null

, CONSUM_ID BIGINT

, CONSUM_DESC                                 STRING 

, SEGMENT_ID BIGINT

, SEGMENT_DESC                                STRING 

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/dm_dept_segments';

--DISTRIBUTE ON (SAP_DEPT_ID)







--*****  Creating table:  "INV_INSTOCK_PRICE_DAY" , ***** Creating table: "INV_INSTOCK_PRICE_DAY"


use legacy;
 CREATE TABLE INV_INSTOCK_PRICE_DAY 
(
 DAY_DT        TIMESTAMP                            not null

, PRODUCT_ID INT not null

, LOCATION_ID INT not null

, FROM_LOCATION_ID INT

, SOURCE_VENDOR_ID BIGINT

, SKU_STATUS_ID                                     STRING 

, STORE_OPEN_IND TINYINT

, OUT_OF_STOCK_CNT TINYINT

, POG_LISTED_IND TINYINT

, SAP_LISTED_IND TINYINT

, INLINE_CNT TINYINT

, PLANNER_IND TINYINT

, SUBS_IND TINYINT

, MAP_AMT       DECIMAL(9,3) 

, EXCH_RATE_PCT                                     DECIMAL(9,6) 

, ON_HAND_QTY                                       INT 

, COMMITTED_QTY                                     INT 

, XFER_IN_TRANS_QTY                                 INT 

, ON_ORDER_QTY                                      INT 

, SUM_COST_AMT                                      DECIMAL(9,3) 

, BUM_COST_AMT                                      DECIMAL(9,3) 

, ON_ORDER_CD                                       STRING 

, RETAIL_PRICE_AMT                                  DECIMAL(8,2) 

, SKU_FACINGS_QTY                                   INT 

, SKU_CAPACITY_QTY                                  INT 

, PETPERKS_AMT                                      DECIMAL(8,2) 

, PETPERKS_IND TINYINT

, LOCAL_PRICE_AMT                                   DECIMAL(8,2) 

, LOC_PETPERKS_PRICE_AMT                            DECIMAL(8,2) 

, LOAD_DT       TIMESTAMP 

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/inv_instock_price_day';

--DISTRIBUTE ON (PRODUCT_ID, LOCATION_ID)







--*****  Creating table:  "LMS_CATEGORY_REF" , ***** Creating table: "LMS_CATEGORY_REF"


use legacy;
 CREATE TABLE LMS_CATEGORY_REF 
(
 SAP_CATEGORY_ID INT not null

, DRIVER        STRING                not null

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/lms_category_ref';

--DISTRIBUTE ON RANDOM







--*****  Creating table:  "LMS_FOLIO_STATUS_REF" , ***** Creating table: "LMS_FOLIO_STATUS_REF"


use legacy;
 CREATE TABLE LMS_FOLIO_STATUS_REF 
(
 FOLIO_STATUS_FLAG                                 STRING                 not null

, DRIVER        STRING                not null

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/lms_folio_status_ref';

--DISTRIBUTE ON RANDOM







--*****  Creating table:  "LMS_ITEMS_SOLD" , ***** Creating table: "LMS_ITEMS_SOLD"


use legacy;
 CREATE TABLE LMS_ITEMS_SOLD 
(
 POS_LABEL_ID BIGINT not null

, PRODUCT_ID INT not null

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/lms_items_sold';

--DISTRIBUTE ON RANDOM







--*****  Creating table:  "LMS_ITEMS_SOLD_LU" , ***** Creating table: "LMS_ITEMS_SOLD_LU"


use legacy;
 CREATE TABLE LMS_ITEMS_SOLD_LU 
(
 POS_LABEL_ID BIGINT not null

, POS_LABEL_DESC                                    STRING 

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/lms_items_sold_lu';

--DISTRIBUTE ON RANDOM







--*****  Creating table:  "LMS_LIVE_ITEM_LU" , ***** Creating table: "LMS_LIVE_ITEM_LU"


use legacy;
 CREATE TABLE LMS_LIVE_ITEM_LU 
(
 LIVE_ITEM_ID BIGINT not null

, LIVE_ITEM_DESC                                    STRING 

, LOCATION_ID INT not null

, STORE_NBR INT not null

, SUN BIGINT

, MON BIGINT

, TUE BIGINT

, WED BIGINT

, THU BIGINT

, FRI BIGINT

, SAT BIGINT

, SYS_LOAD_DT                                       TIMESTAMP 

, USER_CHANGE_DT                                    TIMESTAMP 

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/lms_live_item_lu';

--DISTRIBUTE ON RANDOM







--*****  Creating table:  "LMS_LIVEITEM_POSSALES" , ***** Creating table: "LMS_LIVEITEM_POSSALES"


use legacy;
 CREATE TABLE LMS_LIVEITEM_POSSALES 
(
 LIVE_ITEM_ID BIGINT not null

, LIVE_ITEM_DESC                                    STRING 

, POS_LABEL_ID BIGINT not null

, POS_LABEL_DESC                                    STRING 

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/lms_liveitem_possales';

--DISTRIBUTE ON RANDOM







--*****  Creating table:  "LMS_PILOT_STRS" , ***** Creating table: "LMS_PILOT_STRS"


use legacy;
 CREATE TABLE LMS_PILOT_STRS 
(
 LOCATION_ID INT not null

, STORE_NBR INT

, STORE_NAME                                        STRING 

, FLAG BIGINT

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/lms_pilot_strs';

--DISTRIBUTE ON RANDOM







--*****  Creating table:  "LMS_PRODUCT_REF" , ***** Creating table: "LMS_PRODUCT_REF"


use legacy;
 CREATE TABLE LMS_PRODUCT_REF 
(
 PRODUCT_ID INT not null

, DRIVER        STRING                not null

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/lms_product_ref';

--DISTRIBUTE ON RANDOM







--*****  Creating table:  "LMS_RESTOCK_PRE" , ***** Creating table: "LMS_RESTOCK_PRE"


use raw;
 CREATE TABLE LMS_RESTOCK_PRE 
(
 DAY_DT        TIMESTAMP                            not null

, LOCATION_ID INT not null

, ACT_BCKSTOCK_DAY INT

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-raw-p1-gcs-gbl/INT_Labor_Mgmt/lms_restock_pre';

--DISTRIBUTE ON RANDOM







--*****  Creating table:  "LMS_RESTOCKING_DRIVERS" , ***** Creating table: "LMS_RESTOCKING_DRIVERS"


use legacy;
 CREATE TABLE LMS_RESTOCKING_DRIVERS 
(
 SAP_CLASS_ID BIGINT not null

, GENERIC_DEPT_ID BIGINT

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/lms_restocking_drivers';

--DISTRIBUTE ON RANDOM







--*****  Creating table:  "LMS_RESTOCKING_DRIVERS_LU" , ***** Creating table: "LMS_RESTOCKING_DRIVERS_LU"


use legacy;
 CREATE TABLE LMS_RESTOCKING_DRIVERS_LU 
(
 GENERIC_DEPT_ID BIGINT not null

, GENERIC_DEPT                                      STRING 

, DENOM         STRING 

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/lms_restocking_drivers_lu';

--DISTRIBUTE ON RANDOM







--*****  Creating table:  "LMS_ROOMTYPE_REF" , ***** Creating table: "LMS_ROOMTYPE_REF"


use legacy;
 CREATE TABLE LMS_ROOMTYPE_REF 
(
 ROOM_TYPE_ID INT not null

, DRIVER        STRING                not null

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/lms_roomtype_ref';

--DISTRIBUTE ON RANDOM







--*****  Creating table:  "LMS_SALES_XREF" , ***** Creating table: "LMS_SALES_XREF"


use legacy;
 CREATE TABLE LMS_SALES_XREF 
(
 POS_LABEL_ID BIGINT not null

, SAP_CATEGORY_ID INT not null

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/lms_sales_xref';

--DISTRIBUTE ON RANDOM







--*****  Creating table:  "LMS_SALES_XREF_LU" , ***** Creating table: "LMS_SALES_XREF_LU"


use legacy;
 CREATE TABLE LMS_SALES_XREF_LU 
(
 POS_LABEL_ID BIGINT not null

, POS_LABEL_DESC                                    STRING 

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/lms_sales_xref_lu';

--DISTRIBUTE ON RANDOM







--*****  Creating table:  "LMS_SKU_REF" , ***** Creating table: "LMS_SKU_REF"


use legacy;
 CREATE TABLE LMS_SKU_REF 
(
 SKU_NBR INT not null

, DRIVER        STRING                not null

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/lms_sku_ref';

--DISTRIBUTE ON RANDOM







--*****  Creating table:  "LMS_TP_ITEMS_SOLD" , ***** Creating table: "LMS_TP_ITEMS_SOLD"


use legacy;
 CREATE TABLE LMS_TP_ITEMS_SOLD 
(
 POS_LABEL_ID BIGINT not null

, PRODUCT_ID                                        DECIMAL(38,0)                        not null

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/lms_tp_items_sold';

--DISTRIBUTE ON RANDOM







--*****  Creating table:  "LMS_TP_ITEMS_SOLD_LU" , ***** Creating table: "LMS_TP_ITEMS_SOLD_LU"


use legacy;
 CREATE TABLE LMS_TP_ITEMS_SOLD_LU 
(
 POS_LABEL_ID BIGINT not null

, POS_LABEL_DESC                                    STRING 

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/lms_tp_items_sold_lu';

--DISTRIBUTE ON RANDOM







--*****  Creating table:  "MOVEMENT_DAY" , ***** Creating table: "MOVEMENT_DAY"


use legacy;
 CREATE TABLE MOVEMENT_DAY 
(
 DAY_DT        TIMESTAMP                             not null

, PRODUCT_ID INT not null

, LOCATION_ID INT not null

, MOVEMENT_ID INT not null

, PO_NBR BIGINT not null

, PO_LINE_NBR INT not null

, STO_TYPE_ID INT not null

, SKU_STATUS_ID                                     STRING 

, MOVE_CLASS_ID SMALLINT

, SOURCE_VENDOR_ID BIGINT

, FROM_LOCATION_ID INT

, TRANS_AMT     DECIMAL(12,3) 

, TRANS_COST                                        DECIMAL(12,3) 

, TRANS_QTY     INT 

, FREIGHT_COST                                      DECIMAL(9,3) 

, EXCH_RATE_PCT                                     DECIMAL(9,6) 

, PLAN_DELIV_DAYS SMALLINT

, ROUND_VALUE_QTY                                   INT 

, ROUND_PROFILE_CD                                  STRING 

, UPDATE_DT     TIMESTAMP 

, LOAD_DT       TIMESTAMP 

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/movement_day';

--DISTRIBUTE ON (PRODUCT_ID, LOCATION_ID)

--ORGANIZE   ON (DAY_DT)







--*****  Creating table:  "MOVEMENT_INFO" , ***** Creating table: "MOVEMENT_INFO"


use legacy;
 CREATE TABLE MOVEMENT_INFO 
(
 MOVEMENT_ID INT not null

, MOVE_CLASS_DESC                                   STRING 

, MOVE_CLASS_ID SMALLINT

, MOVE_REASON_DESC                                  STRING 

, MOVE_REASON_ID SMALLINT

, MOVE_TYPE_DESC                                    STRING 

, MOVE_TYPE_ID SMALLINT

, MOVE_TYPE_CD                                      STRING 

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/movement_info';

--DISTRIBUTE ON (MOVEMENT_ID)







--*****  Creating table:  "SALES_DAY_SKU_STORE_RPT" , ***** Creating table: "SALES_DAY_SKU_STORE_RPT"


use legacy;
 CREATE TABLE SALES_DAY_SKU_STORE_RPT 
(
 DAY_DT        TIMESTAMP                             not null

, PRODUCT_ID INT not null

, LOCATION_ID INT not null

, SALES_CUST_CAPTURE_CD                             STRING                          not null

, WEEK_DT       TIMESTAMP 

, FISCAL_YR SMALLINT

, SKU_NBR INT

, STORE_NBR INT

, OPT_SALES_TYPE_ID TINYINT

, VENDOR_ID BIGINT

, PROMO_FLAG TINYINT

, STATUS_ID     STRING 

, BRAND_NAME                                        STRING 

, OWNBRAND_FLAG                                     STRING 

, SKU_VEND_TXN_CNT INT

, NET_SALES_AMT                                     DECIMAL(11,2) 

, NET_SALES_QTY                                     INT 

, NET_MARGIN_AMT                                    DECIMAL(12,3) 

, SALES_AMT     DECIMAL(8,2) 

, SALES_COST                                        DECIMAL(8,2) 

, SALES_QTY     INT 

, RETURN_AMT                                        DECIMAL(8,2) 

, RETURN_COST                                       DECIMAL(8,2) 

, RETURN_QTY                                        INT 

, CLEARANCE_AMT                                     DECIMAL(10,2) 

, CLEARANCE_QTY                                     INT 

, CLEARANCE_RETURN_AMT                              DECIMAL(10,2) 

, CLEARANCE_RETURN_QTY                              INT 

, DISCOUNT_AMT                                      DECIMAL(9,2) 

, DISCOUNT_QTY                                      INT 

, DISCOUNT_RETURN_AMT                               DECIMAL(9,2) 

, DISCOUNT_RETURN_QTY                               INT 

, POS_COUPON_AMT                                    DECIMAL(8,2) 

, POS_COUPON_QTY                                    INT 

, POS_COUPON_ALLOC_AMT                              DECIMAL(8,2) 

, POS_COUPON_ALLOC_QTY                              INT 

, SPECIAL_SALES_AMT                                 DECIMAL(8,2) 

, SPECIAL_SALES_QTY                                 INT 

, SPECIAL_RETURN_AMT                                DECIMAL(8,2) 

, SPECIAL_RETURN_QTY                                INT 

, SPECIAL_SRVC_AMT                                  DECIMAL(11,2) 

, SPECIAL_SRVC_QTY                                  INT 

, MA_SALES_AMT                                      DECIMAL(9,3) 

, MA_SALES_QTY BIGINT

, MA_TRANS_AMT                                      DECIMAL(12,3) 

, MA_TRANS_COST                                     DECIMAL(12,3) 

, MA_TRANS_QTY BIGINT

, EXCH_RATE_PCT                                     DECIMAL(9,6) 

, UPDATE_DT     TIMESTAMP 

, LOAD_DT       TIMESTAMP 

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/sales_day_sku_store_rpt';

--DISTRIBUTE ON (PRODUCT_ID, LOCATION_ID)

--ORGANIZE   ON (DAY_DT)







--*****  Creating table:  "SALES_TRANS_COUPON" , ***** Creating table: "SALES_TRANS_COUPON"


use legacy;
 CREATE TABLE SALES_TRANS_COUPON 
(
 DAY_DT        TIMESTAMP                             not null

, LOCATION_ID INT not null

, SALES_INSTANCE_ID BIGINT not null

, COUPON_TYPE_ID TINYINT not null

, UPC_ID BIGINT not null

, COUPON_ACCESS_CD                                  STRING                  not null

, POS_TXN_SEQ_NBR SMALLINT not null

, OFFER_ID BIGINT not null

, VOID_TYPE_CD                                      STRING 

, SALES_TYPE_ID TINYINT

, TRANS_TSTMP                                       TIMESTAMP 

, PRODUCT_ID INT not null

, CUST_TRANS_ID BIGINT not null

, CASHIER_NBR INT not null

, KEYED_FLAG                                        STRING                          not null  

, OFFER_CHARGEBACK_ID SMALLINT

, POS_COUPON_AMT                                    DECIMAL(8,2) 

, POS_COUPON_QTY TINYINT

, EXCH_RATE_PCT                                     DECIMAL(9,6) 

, DATE_LOADED                                      DATE                                 not null

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/sales_trans_coupon';

--DISTRIBUTE ON (SALES_INSTANCE_ID)

--ORGANIZE   ON (DAY_DT)







--*****  Creating table:  "SALES_TRANS_DISCOUNT" , ***** Creating table: "SALES_TRANS_DISCOUNT"


use legacy;
 CREATE TABLE SALES_TRANS_DISCOUNT 
(
 DAY_DT        TIMESTAMP                             not null

, LOCATION_ID INT not null

, SALES_INSTANCE_ID BIGINT not null

, UPC_ID BIGINT not null

, DISCOUNT_TYPE_ID TINYINT not null

, TP_INVOICE_NBR BIGINT not null

, PARENT_UPC_ID BIGINT not null 

, COMBO_TYPE_CD                                     STRING                          not null  

, POS_TXN_SEQ_NBR SMALLINT not null

, OFFER_ID BIGINT not null

, VOID_TYPE_CD                                      STRING 

, SALES_TYPE_ID TINYINT

, TRANS_TSTMP                                       TIMESTAMP 

, PRODUCT_ID INT not null

, DISC_CPN_UPC_ID BIGINT

, EMPLOYEE_ID INT

, CUST_TRANS_ID BIGINT not null

, CASHIER_NBR INT not null

, UPC_SEQ_NBR INT

, OFFER_CHARGEBACK_ID SMALLINT

, DISCOUNT_AMT                                      DECIMAL(10,4)                         not null

, DISCOUNT_QTY                                      INT 

, DISCOUNT_RETURN_AMT                               DECIMAL(10,4)                         not null

, DISCOUNT_RETURN_QTY                               INT 

, EXCH_RATE_PCT                                     DECIMAL(9,6) 

, DATE_LOADED                                      DATE                                 not null

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/sales_trans_discount';

--DISTRIBUTE ON (SALES_INSTANCE_ID)

--ORGANIZE   ON (DAY_DT)







--*****  Creating table:  "SALES_TRANS_SKU" , ***** Creating table: "SALES_TRANS_SKU"


use legacy;
 CREATE TABLE SALES_TRANS_SKU 
(
 DAY_DT       DATE                                 not null

, SALES_INSTANCE_ID_DIST_KEY BIGINT not null

, PRODUCT_ID INT not null

, SALES_INSTANCE_ID BIGINT

, LOCATION_ID INT

, SALES_TYPE_ID TINYINT

, VOID_TYPE_CD                                      STRING 

, TXN_WAS_POST_VOIDED_FLAG TINYINT

, ORDER_NBR BIGINT

, ORDER_SEQ_NBR BIGINT

, ORDER_CHANNEL                                     STRING 

, ORDER_ASSIST_LOCATION_ID INT

, ORDER_FULFILLMENT_CHANNEL                         STRING 

, ORDER_CREATION_CHANNEL                            STRING 

, ORDER_CREATION_DEVICE_TYPE                        STRING 

, ORDER_CREATION_DEVICE_WIDTH                       INT 

, TXN_SEGMENT                                       STRING 

, PAYMENT_DEVICE_TYPE                               STRING 

, TRANS_TSTMP                                       TIMESTAMP 

, LOYALTY_NBR BIGINT

, LOYALTY_REDEMPTION_ID                             STRING 

, LUID          STRING 

, CUST_TRANS_ID BIGINT

, CUSTOMER_EID                                      DECIMAL(19,0) 

, CUSTOMER_GID                                      DECIMAL(19,0)                         

, SALES_CUSTOMER_LINK_EXCL_TYPE_ID TINYINT 

, SPECIAL_SALES_FLAG TINYINT

, RECEIPTLESS_RETURN_FLAG TINYINT

, TRAINING_START_DT DATE

, TRAINER_NAME                                      STRING 

, SALES_AMT     DECIMAL(10,2) 

, SALES_COST                                        DECIMAL(10,2) 

, SALES_QTY INT

, SPECIAL_SALES_AMT                                 DECIMAL(10,2) 

, SPECIAL_SALES_QTY INT

, RETURN_AMT                                        DECIMAL(10,2) 

, RETURN_COST                                       DECIMAL(10,2) 

, RETURN_QTY INT

, CLEARANCE_AMT                                     DECIMAL(10,2) 

, CLEARANCE_QTY                                     INT 

, CLEARANCE_RETURN_AMT                              DECIMAL(10,2) 

, CLEARANCE_RETURN_QTY                              INT 

, SPECIAL_RETURN_AMT                                DECIMAL(10,2) 

, SPECIAL_RETURN_QTY INT

, SPECIAL_SRVC_AMT                                  DECIMAL(10,2) 

, DISCOUNT_AMT                                      DECIMAL(10,4) 

, DISCOUNT_QTY INT

, DISCOUNT_RETURN_AMT                               DECIMAL(10,4) 

, DISCOUNT_RETURN_QTY INT

, POS_COUPON_AMT                                    DECIMAL(8,2) 

, POS_COUPON_QTY SMALLINT

, POS_COUPON_ALLOC_AMT                              DECIMAL(8,2) 

, POS_COUPON_ALLOC_QTY                              INT 

, NET_SALES_AMT                                     DECIMAL(10,2) 

, NET_SALES_COST                                    DECIMAL(10,2) 

, NET_SALES_QTY INT

, MA_SALES_AMT                                      DECIMAL(9,3) 

, MA_SALES_QTY BIGINT

, MA_TRANS_AMT                                      DECIMAL(12,3) 

, MA_TRANS_COST                                     DECIMAL(12,3) 

, MA_TRANS_QTY BIGINT

, NET_MARGIN_AMT                                    DECIMAL(12,3) 

, EXCH_RATE_PCT                                     DECIMAL(9,6) 

, UPDATE_TSTMP                                      TIMESTAMP                             

, LOAD_TSTMP                                        TIMESTAMP                             

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/sales_trans_sku';

--DISTRIBUTE ON (SALES_INSTANCE_ID_DIST_KEY)

--ORGANIZE   ON (DAY_DT)







--*****  Creating table:  "SALES_TRANS_SPECIAL" , ***** Creating table: "SALES_TRANS_SPECIAL"


use legacy;
 CREATE TABLE SALES_TRANS_SPECIAL 
(
 DAY_DT        TIMESTAMP                             not null

, LOCATION_ID INT not null

, SALES_INSTANCE_ID BIGINT not null

, UPC_ID BIGINT not null

, POS_TXN_SEQ_NBR SMALLINT not null

, VOID_TYPE_CD                                      STRING 

, SALES_TYPE_ID TINYINT

, CUST_TRANS_ID BIGINT

, PRODUCT_ID INT not null

, SPECIAL_SALES_AMT                                 DECIMAL(12,2)                         not null

, SPECIAL_SALES_QTY                                 INT                          not null

, SPECIAL_RETURN_AMT                                DECIMAL(12,2)                         not null

, SPECIAL_RETURN_QTY                                INT                          not null

, EXCH_RATE_PCT                                     DECIMAL(9,6) 

, DATE_LOADED                                       TIMESTAMP                             not null

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/sales_trans_special';

--DISTRIBUTE ON (SALES_INSTANCE_ID)







--*****  Creating table:  "SALES_TRANS_TXN" , ***** Creating table: "SALES_TRANS_TXN"


use legacy;
 CREATE TABLE SALES_TRANS_TXN 
(
 DAY_DT        TIMESTAMP                             not null

, LOCATION_ID INT not null

, SALES_INSTANCE_ID BIGINT not null

, SALES_TYPE_ID TINYINT

, VOID_TYPE_CD                                      STRING 

, TXN_WAS_POST_VOIDED_FLAG TINYINT not null

, SALES_MID_VOID_REASON_CD                          STRING 

, CUST_TRANS_ID BIGINT not null

, TRANS_TSTMP                                       TIMESTAMP                             not null

, TXN_END_TSTMP                                     TIMESTAMP 

, REGISTER_NBR SMALLINT not null

, TRANSACTION_NBR BIGINT not null

, TXN_CONTROL_ID                                    STRING 

, ORDER_NBR BIGINT not null

, ORDER_SEQ_NBR BIGINT not null

, ORDER_CHANNEL                                     STRING 

, ORDER_ASSIST_LOCATION_ID INT

, ORDER_FULFILLMENT_CHANNEL                         STRING 

, ORDER_CREATION_CHANNEL                            STRING 

, ORDER_CREATION_DEVICE_TYPE                        STRING 

, ORDER_CREATION_DEVICE_WIDTH                       INT 

, TXN_SEGMENT                                       STRING 

, PAYMENT_DEVICE_TYPE                               STRING 

, BP_SOURCE_CD INT

, TRANS_FLAG TINYINT

, SALES_CUST_CAPTURE_CD                             STRING 

, ZIP_CODE      STRING                         not null

, EMPLOYEE_ID INT

, CASHIER_NBR INT not null

, MANAGER_NBR INT

, TAX_EXEMPT_ID                                     STRING 

, COMM_TILL_FLG TINYINT

, SPECIAL_ORD_NBR BIGINT

, PETPERK_OVERRIDE_NBR                              DECIMAL(20,0) 

, PETPERK_EMAIL_IND TINYINT

, PETPERK_FIRST_NAME_IND TINYINT

, PETPERK_LAST_NAME_IND TINYINT

, PETPERK_PHONE_NBR_IND TINYINT

, LOYALTY_NBR BIGINT

, LOYALTY_REDEMPTION_ID                             STRING 

, LUID          STRING 

, POINTS_REDEEMED                                   BIGINT 

, BASE_POINTS_EARNED                                BIGINT 

, BONUS_POINTS_EARNED                               BIGINT 

, POINT_BALANCE                                     BIGINT 

, POINTS_DEDUCTED                                   BIGINT 

, CDC_DCOL_RAW_TXT                                  STRING 

, CDC_EMAIL_ID TINYINT

, CDC_FIRST_NAME_ID TINYINT

, CDC_LAST_NAME_ID TINYINT

, CDC_PHONE_NBR_ID TINYINT

, PHONE_TYPE                                        STRING 

, OPT_OUT_EMAIL_FLAG                                STRING 

, OPT_OUT_TEXT_FLAG                                 STRING 

, DIGITAL_RECEIPT_ANSWER_CD                         STRING 

, OFFLINE_CUST_LKP_IND TINYINT

, POS_OFFLINE_REASON_ID INT

, SALES_AMT     DECIMAL(8,2) 

, SALES_COST                                        DECIMAL(8,2) 

, SALES_QTY     INT 

, RETURN_AMT                                        DECIMAL(8,2) 

, RETURN_COST                                       DECIMAL(8,2) 

, RETURN_QTY SMALLINT

, SPECIAL_SRVC_AMT                                  DECIMAL(8,2) 

, SPECIAL_SRVC_QTY                                  INT 

, NET_COUPON_AMT                                    DECIMAL(8,2) 

, NET_COUPON_QTY SMALLINT

, NET_SALES_AMT                                     DECIMAL(8,2) 

, NET_SALES_COST                                    DECIMAL(8,2) 

, NET_SALES_QTY                                     INT 

, NET_DISC_AMT                                      DECIMAL(8,2) 

, NET_DISC_QTY                                      INT 

, NET_MERCH_DISC_AMT                                DECIMAL(8,2) 

, NET_MERCH_DISC_QTY                                INT 

, NET_SPECIAL_SALES_AMT                             DECIMAL(8,2) 

, NET_SPECIAL_SALES_QTY                             INT 

, NET_SALES_TAX_AMT                                 DECIMAL(8,2) 

, NET_PAYMENT_AMT                                   DECIMAL(8,2) 

, EXCH_RATE_PCT                                     DECIMAL(9,6) 

, UPDATE_TSTMP                                      TIMESTAMP 

, DATE_LOADED                                       TIMESTAMP 

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/sales_trans_txn';

--DISTRIBUTE ON (SALES_INSTANCE_ID)

--ORGANIZE   ON (DAY_DT)







--*****  Creating table:  "SALES_TRANS_UPC" , ***** Creating table: "SALES_TRANS_UPC"


use legacy;
 CREATE TABLE SALES_TRANS_UPC 
(
 DAY_DT        TIMESTAMP                             not null

, LOCATION_ID INT not null

, SALES_INSTANCE_ID BIGINT not null

, UPC_ID BIGINT not null

, TP_INVOICE_NBR BIGINT not null

, PARENT_UPC_ID BIGINT not null 

, COMBO_TYPE_CD                                     STRING                          not null  

, POS_TXN_SEQ_NBR SMALLINT not null

, VOID_TYPE_CD                                      STRING 

, TRANS_TSTMP                                       TIMESTAMP 

, SALES_TYPE_ID TINYINT

, PRODUCT_ID INT not null

, SERVICE_BULK_SKU_NBR                              INT 

, PET_ID        DECIMAL(19,0) 

, CUST_TRANS_ID BIGINT not null

, KEYED_FLAG                                        STRING                          not null  

, UPC_ADD_FLAG                                      STRING 

, NON_TAX_FLAG TINYINT

, SPECIAL_SALES_FLAG TINYINT

, DROP_SHIP_FLAG TINYINT

, REASON_ID SMALLINT

, CASHIER_NBR INT

, UPC_SEQ_NBR SMALLINT

, UNIT_PRICE_AMT                                    DECIMAL(10,2) 

, SALES_AMT     DECIMAL(10,2) 

, SALES_COST                                        DECIMAL(10,2) 

, SALES_QTY     INT 

, RETURN_AMT                                        DECIMAL(8,2) 

, RETURN_COST                                       DECIMAL(8,2) 

, RETURN_QTY SMALLINT

, CLEARANCE_AMT                                     DECIMAL(10,2) 

, CLEARANCE_QTY                                     INT 

, CLEARANCE_RETURN_AMT                              DECIMAL(10,2) 

, CLEARANCE_RETURN_QTY                              INT 

, SPECIAL_SRVC_AMT                                  DECIMAL(8,2) 

, EXCH_RATE_PCT                                     DECIMAL(9,6) 

, DATE_LOADED DATE

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/sales_trans_upc';

--DISTRIBUTE ON (SALES_INSTANCE_ID)

--ORGANIZE   ON (DAY_DT)







--*****  Creating table:  "SAP_CATEGORY" , ***** Creating table: "SAP_CATEGORY"


use legacy;
 CREATE TABLE SAP_CATEGORY 
(
 SAP_CATEGORY_ID INT not null

, SAP_CATEGORY_DESC                                 STRING 

, SAP_CLASS_ID INT

, GL_CATEGORY_CD                                    STRING 

, SAP_PRICING_CATEGORY_ID INT

, UPD_TSTMP     TIMESTAMP 

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/sap_category';

--DISTRIBUTE ON (SAP_CATEGORY_ID)







--*****  Creating table:  "SITE_PROFILE" , ***** Creating table: "SITE_PROFILE"


use legacy;
 CREATE TABLE SITE_PROFILE 
(
 LOCATION_ID INT not null

, LOCATION_TYPE_ID TINYINT

, STORE_NBR INT

, STORE_NAME                                        STRING 

, STORE_TYPE_ID                                     STRING 

, STORE_OPEN_CLOSE_FLAG                             STRING 

, COMPANY_ID INT

, REGION_ID BIGINT

, DISTRICT_ID BIGINT

, PRICE_ZONE_ID                                     STRING 

, PRICE_AD_ZONE_ID                                  STRING 

, REPL_DC_NBR INT

, REPL_FISH_DC_NBR INT

, REPL_FWD_DC_NBR INT

, SQ_FEET_RETAIL                                    DOUBLE 

, SQ_FEET_TOTAL                                     DOUBLE 

, SITE_ADDRESS                                      STRING 

, SITE_CITY     STRING 

, STATE_CD      STRING 

, COUNTRY_CD                                        STRING 

, POSTAL_CD     STRING 

, SITE_MAIN_TELE_NO                                 STRING 

, SITE_GROOM_TELE_NO                                STRING 

, SITE_EMAIL_ADDRESS                                STRING 

, SITE_SALES_FLAG                                   STRING 

, EQUINE_MERCH_ID TINYINT

, EQUINE_SITE_ID TINYINT

, EQUINE_SITE_OPEN_DT                               TIMESTAMP 

, GEO_LATITUDE_NBR                                  DECIMAL(12,6) 

, GEO_LONGITUDE_NBR                                 DECIMAL(12,6) 

, PETSMART_DMA_CD                                   STRING 

, LOYALTY_PGM_TYPE_ID TINYINT

, LOYALTY_PGM_STATUS_ID TINYINT

, LOYALTY_PGM_START_DT                              TIMESTAMP 

, LOYALTY_PGM_CHANGE_DT                             TIMESTAMP 

, BP_COMPANY_NBR SMALLINT

, BP_GL_ACCT SMALLINT

, TP_LOC_FLAG                                       STRING 

, TP_ACTIVE_CNT TINYINT

, PROMO_LABEL_CD                                    STRING 

, PARENT_LOCATION_ID INT

, LOCATION_NBR                                      STRING 

, TIME_ZONE_ID                                      STRING 

, DELV_SERVICE_CLASS_ID                             STRING 

, PICK_SERVICE_CLASS_ID                             STRING 

, SITE_LOGIN_ID                                     STRING 

, SITE_MANAGER_ID INT

, SITE_OPEN_YRS_AMT                                 DECIMAL(5,2) 

, HOTEL_FLAG TINYINT

, DAYCAMP_FLAG TINYINT

, VET_FLAG TINYINT

, DIST_MGR_NAME                                     STRING 

, DIST_SVC_MGR_NAME                                 STRING 

, REGION_VP_NAME                                    STRING 

, REGION_TRAINER_NAME                               STRING 

, ASSET_PROTECT_NAME                                STRING 

, SITE_COUNTY                                       STRING 

, SITE_FAX_NO                                       STRING 

, SFT_OPEN_DT                                       TIMESTAMP 

, DM_EMAIL_ADDRESS                                  STRING 

, DSM_EMAIL_ADDRESS                                 STRING 

, RVP_EMAIL_ADDRESS                                 STRING 

, TRADE_AREA                                        STRING 

, FDLPS_NAME                                        STRING 

, FDLPS_EMAIL                                       STRING 

, OVERSITE_MGR_NAME                                 STRING 

, OVERSITE_MGR_EMAIL                                STRING 

, SAFETY_DIRECTOR_NAME                              STRING 

, SAFETY_DIRECTOR_EMAIL                             STRING 

, RETAIL_MANAGER_SAFETY_NAME                        STRING 

, RETAIL_MANAGER_SAFETY_EMAIL                       STRING 

, AREA_DIRECTOR_NAME                                STRING 

, AREA_DIRECTOR_EMAIL                               STRING 

, DC_GENERAL_MANAGER_NAME                           STRING 

, DC_GENERAL_MANAGER_EMAIL                          STRING 

, ASST_DC_GENERAL_MANAGER_NAME1                     STRING 

, ASST_DC_GENERAL_MANAGER_EMAIL1                    STRING 

, ASST_DC_GENERAL_MANAGER_NAME2                     STRING 

, ASST_DC_GENERAL_MANAGER_EMAIL2                    STRING 

, REGIONAL_DC_SAFETY_MGR_NAME                       STRING 

, REGIONAL_DC_SAFETY_MGR_EMAIL                      STRING 

, DC_PEOPLE_SUPERVISOR_NAME                         STRING 

, DC_PEOPLE_SUPERVISOR_EMAIL                        STRING 

, PEOPLE_MANAGER_NAME                               STRING 

, PEOPLE_MANAGER_EMAIL                              STRING 

, ASSET_PROT_DIR_NAME                               STRING 

, ASSET_PROT_DIR_EMAIL                              STRING 

, SR_REG_ASSET_PROT_MGR_NAME                        STRING 

, SR_REG_ASSET_PROT_MGR_EMAIL                       STRING 

, REG_ASSET_PROT_MGR_NAME                           STRING 

, REG_ASSET_PROT_MGR_EMAIL                          STRING 

, ASSET_PROTECT_EMAIL                               STRING 

, TP_START_DT                                       TIMESTAMP 

, OPEN_DT       TIMESTAMP 

, GR_OPEN_DT                                        TIMESTAMP 

, CLOSE_DT      TIMESTAMP 

, HOTEL_OPEN_DT                                     TIMESTAMP 

, ADD_DT        TIMESTAMP 

, DELETE_DT     TIMESTAMP 

, UPDATE_DT     TIMESTAMP 

, LOAD_DT       TIMESTAMP 

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/site_profile';

--DISTRIBUTE ON (LOCATION_ID)







--*****  Creating table:  "SKU_PROFILE" , ***** Creating table: "SKU_PROFILE"


use legacy;
 CREATE TABLE SKU_PROFILE 
(
 PRODUCT_ID INT not null

, SKU_NBR INT

, SKU_TYPE      STRING 

, PRIMARY_UPC_ID BIGINT

, STATUS_ID     STRING 

, SUBS_HIST_FLAG                                    STRING 

, SUBS_CURR_FLAG                                    STRING 

, SKU_DESC      STRING 

, ALT_DESC      STRING 

, SAP_CATEGORY_ID INT

, SAP_CLASS_ID INT

, SAP_DEPT_ID INT

, SAP_DIVISION_ID INT

, PRIMARY_VENDOR_ID BIGINT

, PARENT_VENDOR_ID BIGINT

, COUNTRY_CD                                        STRING 

, IMPORT_FLAG                                       STRING 

, HTS_CODE_ID BIGINT

, CONTENTS      DECIMAL(13,3) 

, CONTENTS_UNITS                                    STRING 

, WEIGHT_NET_AMT                                    DECIMAL(9,3) 

, WEIGHT_UOM_CD                                     STRING 

, SIZE_DESC     STRING 

, BUM_QTY       DOUBLE 

, UOM_CD        STRING 

, UNIT_NUMERATOR                                    DOUBLE 

, UNIT_DENOMINATOR                                  DOUBLE 

, BUYER_ID      STRING 

, PURCH_GROUP_ID INT

, PURCH_COST_AMT                                    DECIMAL(8,2) 

, NAT_PRICE_US_AMT                                  DECIMAL(8,2) 

, TAX_CLASS_ID                                      STRING 

, VALUATION_CLASS_CD                                STRING 

, BRAND_CD      STRING 

, BRAND_CLASSIFICATION_ID SMALLINT

, OWNBRAND_FLAG                                     STRING 

, STATELINE_FLAG                                    STRING 

, SIGN_TYPE_CD                                      STRING 

, OLD_ARTICLE_NBR                                   STRING 

, VENDOR_ARTICLE_NBR                                STRING 

, INIT_MKDN_DT                                      TIMESTAMP 

, DISC_START_DT                                     TIMESTAMP 

, ADD_DT        TIMESTAMP 

, DELETE_DT     TIMESTAMP 

, UPDATE_DT     TIMESTAMP 

, FIRST_SALE_DT                                     TIMESTAMP 

, LAST_SALE_DT                                      TIMESTAMP 

, FIRST_INV_DT                                      TIMESTAMP 

, LAST_INV_DT                                       TIMESTAMP 

, LOAD_DT       TIMESTAMP 

, BASE_NBR      STRING 

, BP_COLOR_ID                                       STRING 

, BP_SIZE_ID                                        STRING 

, BP_BREED_ID                                       STRING 

, BP_ITEM_CONCATENATED                              STRING 

, BP_AEROSOL_FLAG TINYINT

, BP_HAZMAT_FLAG TINYINT

, CANADIAN_HTS_CD                                   STRING 

, NAT_PRICE_CA_AMT                                  DECIMAL(8,2) 

, NAT_PRICE_PR_AMT                                  DECIMAL(8,2) 

, RTV_DEPT_CD                                       STRING 

, GL_ACCT_NBR INT

, ARTICLE_CATEGORY_ID SMALLINT

, COMPONENT_FLAG                                    STRING 

, ZDISCO_SCHED_TYPE_ID                              STRING                 not null  

, ZDISCO_MKDN_SCHED_ID                              STRING                  not null  

, ZDISCO_PID_DT                                     TIMESTAMP 

, ZDISCO_START_DT                                   TIMESTAMP 

, ZDISCO_INIT_MKDN_DT                               TIMESTAMP 

, ZDISCO_DC_DT                                      TIMESTAMP 

, ZDISCO_STR_DT                                     TIMESTAMP 

, ZDISCO_STR_OWNRSHP_DT                             TIMESTAMP 

, ZDISCO_STR_WRT_OFF_DT                             TIMESTAMP 

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/sku_profile';

--DISTRIBUTE ON (PRODUCT_ID)







--*****  Creating table:  "TP_EVENT" , ***** Creating table: "TP_EVENT"


use cust_sensitive;
 CREATE TABLE legacy_TP_EVENT 
(
 TP_INVOICE_NBR BIGINT not null

, CHANGE_DT     TIMESTAMP                             not null

, PARTITION_DT                                      TIMESTAMP                             not null

, TP_PET_NBR BIGINT

, CUST_TRANS_ID BIGINT not null

, TP_CUSTOMER_NBR BIGINT

, TP_EMPLOYEE_ID BIGINT

, LOCATION_ID INT

, TP_EVENT_STATUS_ID INT

, RESERV_CREATE_DT                                  TIMESTAMP 

, RESERV_GROOM_TIME_ID                              TIMESTAMP 

, RESERV_GROOM_DT                                   TIMESTAMP 

, RESERV_TP_EMPLOYEE_ID BIGINT

, CANCEL_DUE_IN_DT                                  TIMESTAMP 

, CANCEL_DUE_OUT_DT                                 TIMESTAMP 

, CANCEL_DT     TIMESTAMP 

, CANCEL_REASON_TX                                  STRING 

, CANCEL_FOLIO_FLAG TINYINT

, ACTUAL_GROOM_DT                                   TIMESTAMP 

, ACTUAL_IN_DT                                      TIMESTAMP 

, ACTUAL_OUT_DT                                     TIMESTAMP 

, ACTUAL_GROOM_TIME_ID                              TIMESTAMP 

, PROMISE_TIME_ID                                   TIMESTAMP 

, ORIGINAL_NBR INT

, REVERSAL_NBR INT

, VOID_TXN_FLAG TINYINT

, REVERSAL_LOGIN_NAME                               STRING 

, TP_MASTER_INVOICE_NBR BIGINT

, TP_BASE_INVOICE_NBR INT

, CHECK_IN_DT                                       TIMESTAMP 

, CHECK_OUT_DT                                      TIMESTAMP 

, GROOM_DT      TIMESTAMP 

, GROOM_COMPLETE_FLAG TINYINT

, ROOM_NUMBER                                       STRING 

, ROOM_ID INT

, ROOM_TYPE_ID INT

, QUICK_SERVICE_NM                                  STRING 

, QUICK_SERVICE_PHONE                               STRING 

, ARRIVE_TIME                                       TIMESTAMP 

, DEPART_TIME                                       TIMESTAMP 

, INVOICE_STATE_ID INT

, REVERSALREASON_ID SMALLINT

, REVERSALREASON_TXT                                STRING 

, LOAD_DT       TIMESTAMP                             not null

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-cust-sensitive-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/tp_event';

--DISTRIBUTE ON RANDOM







--*****  Creating table:  "TP_EVENT_SERVICE" , ***** Creating table: "TP_EVENT_SERVICE"


use legacy;
 CREATE TABLE TP_EVENT_SERVICE 
(
 TP_INVOICE_NBR BIGINT not null

, ITEM_ID INT not null

, CHANGE_DT     TIMESTAMP                             not null

, PARTITION_DT                                      TIMESTAMP                             not null

, TP_EMPLOYEE_ID BIGINT

, LOCATION_ID INT

, UPC_ID BIGINT

, ITEM_PRICE                                        DECIMAL(8,2) 

, ITEM_QTY SMALLINT

, RATE_TYPE_ID INT

, COMM_RT       DECIMAL(4,3) 

, PRICEDELTA_ID SMALLINT

, DELTA_AMT     DECIMAL(6,2) 

, EXCH_RATE_PCT                                     DECIMAL(9,6) 

, LOAD_DT       TIMESTAMP                             not null

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/tp_event_service';

--DISTRIBUTE ON (TP_INVOICE_NBR)







--*****  Creating table:  "TP_INVOICE_SERVICE" , ***** Creating table: "TP_INVOICE_SERVICE"


use legacy;
 CREATE TABLE TP_INVOICE_SERVICE 
(
 TP_DAY_DT     TIMESTAMP                             not null

, LOCATION_ID INT not null

, TP_INVOICE_NBR BIGINT not null

, UPC_ID BIGINT not null

, EMPLOYEE_ID BIGINT

, PRODUCT_ID INT

, TP_ITEM_PRICE                                     DECIMAL(8,2) 

, TP_ITEM_QTY SMALLINT

, ROOM_NUMBER                                       STRING 

, ROOM_TYPE_ID INT

, TP_COMMISSION_AMT                                 DECIMAL(8,2) 

, INVOICE_STATE_ID SMALLINT

, PRICEDELTA_ID SMALLINT

, DELTA_AMT     DECIMAL(6,2) 

, EXCH_RATE_PCT                                     DECIMAL(9,6) 

, LOAD_DT       TIMESTAMP 

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/tp_invoice_service';

--DISTRIBUTE ON (TP_INVOICE_NBR)







--*****  Creating table:  "TP_SERVICE_SCHEDULE" , ***** Creating table: "TP_SERVICE_SCHEDULE"


use legacy;
 CREATE TABLE TP_SERVICE_SCHEDULE 
(
 DAY_DT        TIMESTAMP                             not null

, LOCATION_ID INT not null

, TP_INVOICE_NBR BIGINT not null

, UPC_ID BIGINT not null

, SERVICE_ITEM_ID BIGINT not null

, FOLIO_STATUS_FLAG                                 STRING 

, PRODUCT_ID INT

, ROOM_NUMBER                                       STRING 

, ROOM_TYPE_ID INT

, SERVICE_SCHEDULE_QTY SMALLINT

, SERVICE_FREQ_ID SMALLINT

, LOAD_DT       TIMESTAMP 

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/tp_service_schedule';

--DISTRIBUTE ON (TP_INVOICE_NBR)







--*****  Creating table:  "UPC" , ***** Creating table: "UPC"


use legacy;
 CREATE TABLE UPC 
(
 UPC_ID BIGINT not null

, UPC_CD        STRING 

, UPC_ADD_DT                                        TIMESTAMP 

, UPC_DELETE_DT                                     TIMESTAMP 

, UPC_REFRESH_DT                                    TIMESTAMP 

, PRODUCT_ID INT

, SKU_NBR INT

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/INT_Labor_Mgmt/upc';

--DISTRIBUTE ON (UPC_ID)







--*****  Creating table:  "LMS_VOLUME_HOTEL_PRE" , ***** Creating table: "LMS_VOLUME_HOTEL_PRE"


use raw;
 CREATE TABLE LMS_VOLUME_HOTEL_PRE 
(
 DAY_DT        TIMESTAMP 

, LOCATION_ID INT

, WEEK_DT       TIMESTAMP 

, POS_LABEL     STRING 

, DRIVER        STRING 

, ACTIVITY_0615 INT

)
USING delta 
LOCATION 'gs://petm-bdpl-prod-raw-p1-gcs-gbl/INT_Labor_Mgmt/lms_volume_hotel_pre';

--DISTRIBUTE ON RANDOM


